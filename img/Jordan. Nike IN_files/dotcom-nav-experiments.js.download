!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=281)}([function(e,t,r){var n=r(2);t.LOG_LEVEL={NOTSET:0,DEBUG:1,INFO:2,WARNING:3,ERROR:4},t.ERROR_MESSAGES={CONDITION_EVALUATOR_ERROR:"%s: Error evaluating audience condition of type %s: %s",DATAFILE_AND_SDK_KEY_MISSING:"%s: You must provide at least one of sdkKey or datafile. Cannot start Optimizely",EXPERIMENT_KEY_NOT_IN_DATAFILE:"%s: Experiment key %s is not in datafile.",FEATURE_NOT_IN_DATAFILE:"%s: Feature key %s is not in datafile.",IMPROPERLY_FORMATTED_EXPERIMENT:"%s: Experiment key %s is improperly formatted.",INVALID_ATTRIBUTES:"%s: Provided attributes are in an invalid format.",INVALID_BUCKETING_ID:"%s: Unable to generate hash for bucketing ID %s: %s",INVALID_DATAFILE:"%s: Datafile is invalid - property %s: %s",INVALID_DATAFILE_MALFORMED:"%s: Datafile is invalid because it is malformed.",INVALID_JSON:"%s: JSON object is not valid.",INVALID_ERROR_HANDLER:'%s: Provided "errorHandler" is in an invalid format.',INVALID_EVENT_DISPATCHER:'%s: Provided "eventDispatcher" is in an invalid format.',INVALID_EVENT_KEY:"%s: Event key %s is not in datafile.",INVALID_EVENT_TAGS:"%s: Provided event tags are in an invalid format.",INVALID_EXPERIMENT_KEY:"%s: Experiment key %s is not in datafile. It is either invalid, paused, or archived.",INVALID_EXPERIMENT_ID:"%s: Experiment ID %s is not in datafile.",INVALID_GROUP_ID:"%s: Group ID %s is not in datafile.",INVALID_LOGGER:'%s: Provided "logger" is in an invalid format.',INVALID_ROLLOUT_ID:"%s: Invalid rollout ID %s attached to feature %s",INVALID_USER_ID:"%s: Provided user ID is in an invalid format.",INVALID_USER_PROFILE_SERVICE:"%s: Provided user profile service instance is in an invalid format: %s.",JSON_SCHEMA_EXPECTED:"%s: JSON schema expected.",NO_DATAFILE_SPECIFIED:"%s: No datafile specified. Cannot start optimizely.",NO_JSON_PROVIDED:"%s: No JSON object to validate against schema.",NO_VARIATION_FOR_EXPERIMENT_KEY:"%s: No variation key %s defined in datafile for experiment %s.",UNDEFINED_ATTRIBUTE:"%s: Provided attribute: %s has an undefined value.",UNRECOGNIZED_ATTRIBUTE:"%s: Unrecognized attribute %s provided. Pruning before sending event to Optimizely.",UNABLE_TO_CAST_VALUE:"%s: Unable to cast value %s to type %s, returning null.",USER_NOT_IN_FORCED_VARIATION:"%s: User %s is not in the forced variation map. Cannot remove their forced variation.",USER_PROFILE_LOOKUP_ERROR:'%s: Error while looking up user profile for user ID "%s": %s.',USER_PROFILE_SAVE_ERROR:'%s: Error while saving user profile for user ID "%s": %s.',VARIABLE_KEY_NOT_IN_DATAFILE:'%s: Variable with key "%s" associated with feature with key "%s" is not in datafile.',VARIATION_ID_NOT_IN_DATAFILE:"%s: No variation ID %s defined in datafile for experiment %s.",VARIATION_ID_NOT_IN_DATAFILE_NO_EXPERIMENT:"%s: Variation ID %s is not in the datafile.",INVALID_INPUT_FORMAT:"%s: Provided %s is in an invalid format.",INVALID_DATAFILE_VERSION:"%s: This version of the JavaScript SDK does not support the given datafile version: %s",INVALID_VARIATION_KEY:"%s: Provided variation key is in an invalid format."},t.LOG_MESSAGES={ACTIVATE_USER:"%s: Activating user %s in experiment %s.",DISPATCH_CONVERSION_EVENT:"%s: Dispatching conversion event to URL %s with params %s.",DISPATCH_IMPRESSION_EVENT:"%s: Dispatching impression event to URL %s with params %s.",DEPRECATED_EVENT_VALUE:"%s: Event value is deprecated in %s call.",EXPERIMENT_NOT_RUNNING:"%s: Experiment %s is not running.",FEATURE_ENABLED_FOR_USER:"%s: Feature %s is enabled for user %s.",FEATURE_NOT_ENABLED_FOR_USER:"%s: Feature %s is not enabled for user %s.",FEATURE_HAS_NO_EXPERIMENTS:"%s: Feature %s is not attached to any experiments.",FAILED_TO_PARSE_VALUE:'%s: Failed to parse event value "%s" from event tags.',FAILED_TO_PARSE_REVENUE:'%s: Failed to parse revenue value "%s" from event tags.',FORCED_BUCKETING_FAILED:"%s: Variation key %s is not in datafile. Not activating user %s.",INVALID_OBJECT:"%s: Optimizely object is not valid. Failing %s.",INVALID_CLIENT_ENGINE:"%s: Invalid client engine passed: %s. Defaulting to node-sdk.",INVALID_VARIATION_ID:"%s: Bucketed into an invalid variation ID. Returning null.",NOTIFICATION_LISTENER_EXCEPTION:"%s: Notification listener for (%s) threw exception: %s",NO_ROLLOUT_EXISTS:"%s: There is no rollout of feature %s.",NOT_ACTIVATING_USER:"%s: Not activating user %s for experiment %s.",NOT_TRACKING_USER:"%s: Not tracking user %s.",PARSED_REVENUE_VALUE:'%s: Parsed revenue value "%s" from event tags.',PARSED_NUMERIC_VALUE:'%s: Parsed event value "%s" from event tags.',RETURNING_STORED_VARIATION:'%s: Returning previously activated variation "%s" of experiment "%s" for user "%s" from user profile.',ROLLOUT_HAS_NO_EXPERIMENTS:"%s: Rollout of feature %s has no experiments",SAVED_VARIATION:'%s: Saved variation "%s" of experiment "%s" for user "%s".',SAVED_VARIATION_NOT_FOUND:"%s: User %s was previously bucketed into variation with ID %s for experiment %s, but no matching variation was found.",SHOULD_NOT_DISPATCH_ACTIVATE:'%s: Experiment %s is not in "Running" state. Not activating user.',SKIPPING_JSON_VALIDATION:"%s: Skipping JSON schema validation.",TRACK_EVENT:"%s: Tracking event %s for user %s.",USER_ASSIGNED_TO_VARIATION_BUCKET:"%s: Assigned variation bucket %s to user %s.",USER_ASSIGNED_TO_EXPERIMENT_BUCKET:"%s: Assigned experiment bucket %s to user %s.",USER_BUCKETED_INTO_EXPERIMENT_IN_GROUP:"%s: User %s is in experiment %s of group %s.",USER_BUCKETED_INTO_TARGETING_RULE:"%s: User %s bucketed into targeting rule %s.",USER_IN_FEATURE_EXPERIMENT:"%s: User %s is in variation %s of experiment %s on the feature %s.",USER_IN_ROLLOUT:"%s: User %s is in rollout of feature %s.",USER_BUCKETED_INTO_EVERYONE_TARGETING_RULE:"%s: User %s bucketed into everyone targeting rule.",USER_NOT_BUCKETED_INTO_EVERYONE_TARGETING_RULE:"%s: User %s not bucketed into everyone targeting rule due to traffic allocation.",USER_NOT_BUCKETED_INTO_EXPERIMENT_IN_GROUP:"%s: User %s is not in experiment %s of group %s.",USER_NOT_BUCKETED_INTO_ANY_EXPERIMENT_IN_GROUP:"%s: User %s is not in any experiment of group %s.",USER_NOT_BUCKETED_INTO_TARGETING_RULE:"%s User %s not bucketed into targeting rule %s due to traffic allocation. Trying everyone rule.",USER_NOT_IN_FEATURE_EXPERIMENT:"%s: User %s is not in any experiment on the feature %s.",USER_NOT_IN_ROLLOUT:"%s: User %s is not in rollout of feature %s.",USER_FORCED_IN_VARIATION:"%s: User %s is forced in variation %s.",USER_MAPPED_TO_FORCED_VARIATION:"%s: Set variation %s for experiment %s and user %s in the forced variation map.",USER_DOESNT_MEET_CONDITIONS_FOR_TARGETING_RULE:"%s: User %s does not meet conditions for targeting rule %s.",USER_MEETS_CONDITIONS_FOR_TARGETING_RULE:"%s: User %s meets conditions for targeting rule %s.",USER_HAS_VARIATION:"%s: User %s is in variation %s of experiment %s.",USER_HAS_FORCED_VARIATION:"%s: Variation %s is mapped to experiment %s and user %s in the forced variation map.",USER_HAS_NO_VARIATION:"%s: User %s is in no variation of experiment %s.",USER_HAS_NO_FORCED_VARIATION:"%s: User %s is not in the forced variation map.",USER_HAS_NO_FORCED_VARIATION_FOR_EXPERIMENT:"%s: No experiment %s mapped to user %s in the forced variation map.",USER_NOT_IN_ANY_EXPERIMENT:"%s: User %s is not in any experiment of group %s.",USER_NOT_IN_EXPERIMENT:"%s: User %s does not meet conditions to be in experiment %s.",USER_RECEIVED_DEFAULT_VARIABLE_VALUE:'%s: User "%s" is not in any variation or rollout rule. Returning default value for variable "%s" of feature flag "%s".',FEATURE_NOT_ENABLED_RETURN_DEFAULT_VARIABLE_VALUE:'%s: Feature "%s" is not enabled for user %s. Returning default value for variable "%s".',VARIABLE_NOT_USED_RETURN_DEFAULT_VARIABLE_VALUE:'%s: Variable "%s" is not used in variation "%s". Returning default value.',USER_RECEIVED_VARIABLE_VALUE:'%s: Value for variable "%s" of feature flag "%s" is %s for user "%s"',VALID_DATAFILE:"%s: Datafile is valid.",VALID_USER_PROFILE_SERVICE:"%s: Valid user profile service provided.",VARIATION_REMOVED_FOR_USER:"%s: Variation mapped to experiment %s has been removed for user %s.",VARIABLE_REQUESTED_WITH_WRONG_TYPE:'%s: Requested variable type "%s", but variable is of type "%s". Use correct API to retrieve value. Returning None.',VALID_BUCKETING_ID:'%s: BucketingId is valid: "%s"',BUCKETING_ID_NOT_STRING:"%s: BucketingID attribute is not a string. Defaulted to userId",EVALUATING_AUDIENCE:'%s: Starting to evaluate audience "%s" with conditions: %s.',EVALUATING_AUDIENCES_COMBINED:'%s: Evaluating audiences for experiment "%s": %s.',AUDIENCE_EVALUATION_RESULT:'%s: Audience "%s" evaluated to %s.',AUDIENCE_EVALUATION_RESULT_COMBINED:"%s: Audiences for experiment %s collectively evaluated to %s.",MISSING_ATTRIBUTE_VALUE:'%s: Audience condition %s evaluated to UNKNOWN because no value was passed for user attribute "%s".',UNEXPECTED_CONDITION_VALUE:"%s: Audience condition %s evaluated to UNKNOWN because the condition value is not supported.",UNEXPECTED_TYPE:'%s: Audience condition %s evaluated to UNKNOWN because a value of type "%s" was passed for user attribute "%s".',UNEXPECTED_TYPE_NULL:'%s: Audience condition %s evaluated to UNKNOWN because a null value was passed for user attribute "%s".',UNKNOWN_CONDITION_TYPE:"%s: Audience condition %s has an unknown condition type. You may need to upgrade to a newer release of the Optimizely SDK.",UNKNOWN_MATCH_TYPE:"%s: Audience condition %s uses an unknown match type. You may need to upgrade to a newer release of the Optimizely SDK.",UPDATED_OPTIMIZELY_CONFIG:"%s: Updated Optimizely config to revision %s (project id %s)",OUT_OF_BOUNDS:'%s: Audience condition %s evaluated to UNKNOWN because the number value for user attribute "%s" is not in the range [-2^53, +2^53].',UNABLE_TO_ATTACH_UNLOAD:'%s: unable to bind optimizely.close() to page unload event: "%s"'},t.RESERVED_EVENT_KEYWORDS={REVENUE:"revenue",VALUE:"value"},t.CONTROL_ATTRIBUTES={BOT_FILTERING:"$opt_bot_filtering",BUCKETING_ID:"$opt_bucketing_id",STICKY_BUCKETING_KEY:"$opt_experiment_bucket_map",USER_AGENT:"$opt_user_agent"},t.JAVASCRIPT_CLIENT_ENGINE="javascript-sdk",t.NODE_CLIENT_ENGINE="node-sdk",t.REACT_CLIENT_ENGINE="react-sdk",t.NODE_CLIENT_VERSION="3.5.0",t.VALID_CLIENT_ENGINES=[t.NODE_CLIENT_ENGINE,t.REACT_CLIENT_ENGINE,t.JAVASCRIPT_CLIENT_ENGINE],t.NOTIFICATION_TYPES=n.NOTIFICATION_TYPES,t.DECISION_NOTIFICATION_TYPES={AB_TEST:"ab-test",FEATURE:"feature",FEATURE_TEST:"feature-test",FEATURE_VARIABLE:"feature-variable"},t.DECISION_SOURCES={FEATURE_TEST:"feature-test",ROLLOUT:"rollout"},t.FEATURE_VARIABLE_TYPES={BOOLEAN:"boolean",DOUBLE:"double",INTEGER:"integer",STRING:"string"},t.DATAFILE_VERSIONS={V2:"2",V3:"3",V4:"4"}},function(e,t){var r=Array.isArray;e.exports=r},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(22);function o(e){return Object.keys(e).map((function(t){return e[t]}))}t.getTimestamp=function(){return(new Date).getTime()},t.generateUUID=function(){return n.v4()},t.isValidEnum=function(e,t){for(var r=!1,n=Object.keys(e),o=0;o<n.length;o++)if(t===e[n[o]]){r=!0;break}return r},t.groupBy=function(e,t){var r={};return e.forEach((function(e){var n=t(e);r[n]=r[n]||[],r[n].push(e)})),o(r)},t.objectValues=o,t.objectEntries=function(e){return Object.keys(e).map((function(t){return[t,e[t]]}))},t.find=function(e,t){for(var r,n=0,o=e;n<o.length;n++){var i=o[n];if(t(i)){r=i;break}}return r},t.keyBy=function(e,t){var r={};return e.forEach((function(e){var n=t(e);r[n]=e})),r},t.sprintf=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=0;return e.replace(/%s/g,(function(){var e=t[n++],r=typeof e;return"function"===r?e():"string"===r?e:String(e)}))},function(e){e.ACTIVATE="ACTIVATE:experiment, user_id,attributes, variation, event",e.DECISION="DECISION:type, userId, attributes, decisionInfo",e.LOG_EVENT="LOG_EVENT:logEvent",e.OPTIMIZELY_CONFIG_UPDATE="OPTIMIZELY_CONFIG_UPDATE",e.TRACK="TRACK:event_key, user_id, attributes, event_tags, event"}(t.NOTIFICATION_TYPES||(t.NOTIFICATION_TYPES={}))},function(e,t,r){var n=r(22),o=r(123),i=Math.pow(2,53);e.exports={assign:r(124),assignIn:r(144),cloneDeep:r(147),currentTimestamp:function(){return Math.round((new Date).getTime())},isArray:r(1),isEmpty:r(194),isFinite:function(e){return o(e)&&Math.abs(e)<=i},keyBy:r(195),filter:r(228),forEach:r(230),forOwn:r(96),map:r(231),uuid:function(){return n.v4()},values:r(233),isNumber:r(235)}},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(66)),n(r(67)),n(r(120))},function(e,t,r){var n=r(71),o="object"==typeof self&&self&&self.Object===Object&&self,i=n||o||Function("return this")();e.exports=i},function(e,t){e.exports=function(e){return null!=e&&"object"==typeof e}},function(e,t,r){var n=r(125),o=r(130);e.exports=function(e,t){var r=o(e,t);return n(r)?r:void 0}},function(e,t){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},function(e,t,r){var n=r(73),o=r(41);e.exports=function(e){return null!=e&&o(e.length)&&!n(e)}},function(e,t,r){var n=r(76),o=r(77),i=r(9);e.exports=function(e){return i(e)?n(e):o(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"getOptimizelyUserId",{enumerable:!0,get:function(){return n.getOptimizelyUserId}}),Object.defineProperty(t,"sanitizeVariant",{enumerable:!0,get:function(){return n.sanitizeVariant}}),Object.defineProperty(t,"sanitizeForcedVariant",{enumerable:!0,get:function(){return n.sanitizeForcedVariant}}),Object.defineProperty(t,"getForcedVariant",{enumerable:!0,get:function(){return n.getForcedVariant}}),Object.defineProperty(t,"getForcedRollout",{enumerable:!0,get:function(){return n.getForcedRollout}}),Object.defineProperty(t,"filterRunningExperiments",{enumerable:!0,get:function(){return n.filterRunningExperiments}}),Object.defineProperty(t,"getExperiments",{enumerable:!0,get:function(){return n.getExperiments}}),Object.defineProperty(t,"getExperimentDriver",{enumerable:!0,get:function(){return n.getExperimentDriver}}),Object.defineProperty(t,"getDriver",{enumerable:!0,get:function(){return n.getDriver}}),Object.defineProperty(t,"mapExperimentKeys",{enumerable:!0,get:function(){return n.mapExperimentKeys}}),Object.defineProperty(t,"mapFeatureKeys",{enumerable:!0,get:function(){return n.mapFeatureKeys}}),Object.defineProperty(t,"activateExperiment",{enumerable:!0,get:function(){return n.activateExperiment}}),Object.defineProperty(t,"activateExperiments",{enumerable:!0,get:function(){return n.activateExperiments}}),Object.defineProperty(t,"getVariation",{enumerable:!0,get:function(){return n.getVariation}}),Object.defineProperty(t,"getVariations",{enumerable:!0,get:function(){return n.getVariations}}),Object.defineProperty(t,"getRollouts",{enumerable:!0,get:function(){return n.getRollouts}}),Object.defineProperty(t,"getVariantVariables",{enumerable:!0,get:function(){return n.getVariantVariables}}),Object.defineProperty(t,"getFeatureFlagByExperimentId",{enumerable:!0,get:function(){return n.getFeatureFlagByExperimentId}}),Object.defineProperty(t,"getFeatureFlagsByExperimentId",{enumerable:!0,get:function(){return n.getFeatureFlagsByExperimentId}}),Object.defineProperty(t,"getForcedExperiments",{enumerable:!0,get:function(){return n.getForcedExperiments}}),Object.defineProperty(t,"COOKIE_NAME",{enumerable:!0,get:function(){return o.COOKIE_NAME}});var n=r(114),o=r(280)},function(e,t,r){var n=r(18),o=r(126),i=r(127),a=n?n.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":a&&a in Object(e)?o(e):i(e)}},function(e,t,r){var n=r(39),o=r(40);e.exports=function(e,t,r,i){var a=!r;r||(r={});for(var s=-1,u=t.length;++s<u;){var c=t[s],l=i?i(r[c],e[c],c,r,e):void 0;void 0===l&&(l=e[c]),a?o(r,c,l):n(r,c,l)}return r}},function(e,t,r){var n=r(3),o=r(0),i=r(2).sprintf,a=r(57),s=r(251),u="PROJECT_CONFIG",c=o.ERROR_MESSAGES,l=o.LOG_MESSAGES,f=o.LOG_LEVEL,p=o.FEATURE_VARIABLE_TYPES;e.exports={createProjectConfig:function(e){var t,r=n.cloneDeep(e);return n.forEach(r.audiences,(function(e){e.conditions=JSON.parse(e.conditions)})),r.audiencesById=n.keyBy(r.audiences,"id"),n.assign(r.audiencesById,n.keyBy(r.typedAudiences,"id")),r.attributeKeyMap=n.keyBy(r.attributes,"key"),r.eventKeyMap=n.keyBy(r.events,"key"),r.groupIdMap=n.keyBy(r.groups,"id"),n.forEach(r.groupIdMap,(function(e,o){t=n.cloneDeep(e.experiments),n.forEach(t,(function(e){r.experiments.push(n.assignIn(e,{groupId:o}))}))})),r.rolloutIdMap=n.keyBy(r.rollouts||[],"id"),n.forOwn(r.rolloutIdMap,(function(e){n.forEach(e.experiments||[],(function(e){r.experiments.push(n.cloneDeep(e)),e.variationKeyMap=n.keyBy(e.variations,"key")}))})),r.experimentKeyMap=n.keyBy(r.experiments,"key"),r.experimentIdMap=n.keyBy(r.experiments,"id"),r.variationIdMap={},r.variationVariableUsageMap={},n.forEach(r.experiments,(function(e){e.variationKeyMap=n.keyBy(e.variations,"key"),n.assignIn(r.variationIdMap,n.keyBy(e.variations,"id")),n.forOwn(e.variationKeyMap,(function(e){e.variables&&(r.variationVariableUsageMap[e.id]=n.keyBy(e.variables,"id"))}))})),r.experimentFeatureMap={},r.featureKeyMap=n.keyBy(r.featureFlags||[],"key"),n.forOwn(r.featureKeyMap,(function(e){e.variableKeyMap=n.keyBy(e.variables,"key"),n.forEach(e.experimentIds||[],(function(t){r.experimentFeatureMap[t]?r.experimentFeatureMap[t].push(e.id):r.experimentFeatureMap[t]=[e.id];var n=r.experimentIdMap[t];n.groupId&&!e.groupId&&(e.groupId=n.groupId)}))})),r},getExperimentId:function(e,t){var r=e.experimentKeyMap[t];if(n.isEmpty(r))throw new Error(i(c.INVALID_EXPERIMENT_KEY,u,t));return r.id},getLayerId:function(e,t){var r=e.experimentIdMap[t];if(n.isEmpty(r))throw new Error(i(c.INVALID_EXPERIMENT_ID,u,t));return r.layerId},getAttributeId:function(e,t,r){var n=e.attributeKeyMap[t],o=0===t.indexOf("$opt_");return n?(o&&r.log(f.WARN,i("Attribute %s unexpectedly has reserved prefix %s; using attribute ID instead of reserved attribute name.",t,"$opt_")),n.id):o?t:(r.log(f.DEBUG,i(c.UNRECOGNIZED_ATTRIBUTE,u,t)),null)},getEventId:function(e,t){var r=e.eventKeyMap[t];return r?r.id:null},getExperimentStatus:function(e,t){var r=e.experimentKeyMap[t];if(n.isEmpty(r))throw new Error(i(c.INVALID_EXPERIMENT_KEY,u,t));return r.status},isActive:function(t,r){return"Running"===e.exports.getExperimentStatus(t,r)},isRunning:function(t,r){return"Running"===e.exports.getExperimentStatus(t,r)},getExperimentAudienceConditions:function(e,t){var r=e.experimentKeyMap[t];if(n.isEmpty(r))throw new Error(i(c.INVALID_EXPERIMENT_KEY,u,t));return r.audienceConditions||r.audienceIds},getVariationKeyFromId:function(e,t){return e.variationIdMap.hasOwnProperty(t)?e.variationIdMap[t].key:null},getVariationIdFromExperimentAndVariationKey:function(e,t,r){var n=e.experimentKeyMap[t];return n.variationKeyMap.hasOwnProperty(r)?n.variationKeyMap[r].id:null},getExperimentFromKey:function(e,t){if(e.experimentKeyMap.hasOwnProperty(t)){var r=e.experimentKeyMap[t];if(r)return r}throw new Error(i(c.EXPERIMENT_KEY_NOT_IN_DATAFILE,u,t))},getTrafficAllocation:function(e,t){var r=e.experimentKeyMap[t];if(n.isEmpty(r))throw new Error(i(c.INVALID_EXPERIMENT_KEY,u,t));return r.trafficAllocation},getExperimentFromId:function(e,t,r){if(e.experimentIdMap.hasOwnProperty(t)){var n=e.experimentIdMap[t];if(n)return n}return r.log(f.ERROR,i(c.INVALID_EXPERIMENT_ID,u,t)),null},getFeatureFromKey:function(e,t,r){if(e.featureKeyMap.hasOwnProperty(t)){var n=e.featureKeyMap[t];if(n)return n}return r.log(f.ERROR,i(c.FEATURE_NOT_IN_DATAFILE,u,t)),null},getVariableForFeature:function(e,t,r,n){var o=e.featureKeyMap[t];if(!o)return n.log(f.ERROR,i(c.FEATURE_NOT_IN_DATAFILE,u,t)),null;var a=o.variableKeyMap[r];return a||(n.log(f.ERROR,i(c.VARIABLE_KEY_NOT_IN_DATAFILE,u,r,t)),null)},getVariableValueForVariation:function(e,t,r,n){if(!t||!r)return null;if(!e.variationVariableUsageMap.hasOwnProperty(r.id))return n.log(f.ERROR,i(c.VARIATION_ID_NOT_IN_DATAFILE_NO_EXPERIMENT,u,r.id)),null;var o=e.variationVariableUsageMap[r.id][t.id];return o?o.value:null},getTypeCastValue:function(e,t,r){var n;switch(t){case p.BOOLEAN:"true"!==e&&"false"!==e?(r.log(f.ERROR,i(c.UNABLE_TO_CAST_VALUE,u,e,t)),n=null):n="true"===e;break;case p.INTEGER:n=parseInt(e,10),isNaN(n)&&(r.log(f.ERROR,i(c.UNABLE_TO_CAST_VALUE,u,e,t)),n=null);break;case p.DOUBLE:n=parseFloat(e),isNaN(n)&&(r.log(f.ERROR,i(c.UNABLE_TO_CAST_VALUE,u,e,t)),n=null);break;default:n=e}return n},getAudiencesById:function(e){return e.audiencesById},eventWithKeyExists:function(e,t){return e.eventKeyMap.hasOwnProperty(t)},isFeatureExperiment:function(e,t){return e.experimentFeatureMap.hasOwnProperty(t)},tryCreatingProjectConfig:function(t){return a.validateDatafile(t.datafile),!0===t.skipJSONValidation?t.logger.log(f.INFO,i(l.SKIPPING_JSON_VALIDATION,u)):t.jsonSchemaValidator&&(t.jsonSchemaValidator.validate(s,t.datafile),t.logger.log(f.INFO,i(l.VALID_DATAFILE,u))),e.exports.createProjectConfig(t.datafile)}}},function(e,t){function r(t){return e.exports=r=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},e.exports.__esModule=!0,e.exports.default=e.exports,r(t)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){var n=r(109),o=r(110),i=r(111),a=r(112);e.exports=function(e){return n(e)||o(e)||i(e)||a()},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){"use strict";
/*!
 * cookie
 * Copyright(c) 2012-2014 Roman Shtylman
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */t.parse=function(e,t){if("string"!=typeof e)throw new TypeError("argument str must be a string");for(var r={},o=t||{},i=e.split(";"),s=o.decode||n,u=0;u<i.length;u++){var c=i[u],l=c.indexOf("=");if(!(l<0)){var f=c.substring(0,l).trim();if(null==r[f]){var p=c.substring(l+1,c.length).trim();'"'===p[0]&&(p=p.slice(1,-1)),r[f]=a(p,s)}}}return r},t.serialize=function(e,t,r){var n=r||{},a=n.encode||o;if("function"!=typeof a)throw new TypeError("option encode is invalid");if(!i.test(e))throw new TypeError("argument name is invalid");var s=a(t);if(s&&!i.test(s))throw new TypeError("argument val is invalid");var u=e+"="+s;if(null!=n.maxAge){var c=n.maxAge-0;if(isNaN(c)||!isFinite(c))throw new TypeError("option maxAge is invalid");u+="; Max-Age="+Math.floor(c)}if(n.domain){if(!i.test(n.domain))throw new TypeError("option domain is invalid");u+="; Domain="+n.domain}if(n.path){if(!i.test(n.path))throw new TypeError("option path is invalid");u+="; Path="+n.path}if(n.expires){if("function"!=typeof n.expires.toUTCString)throw new TypeError("option expires is invalid");u+="; Expires="+n.expires.toUTCString()}n.httpOnly&&(u+="; HttpOnly");n.secure&&(u+="; Secure");if(n.sameSite){switch("string"==typeof n.sameSite?n.sameSite.toLowerCase():n.sameSite){case!0:u+="; SameSite=Strict";break;case"lax":u+="; SameSite=Lax";break;case"strict":u+="; SameSite=Strict";break;case"none":u+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}}return u};var n=decodeURIComponent,o=encodeURIComponent,i=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function a(e,t){try{return t(e)}catch(t){return e}}},function(e,t,r){var n=r(5).Symbol;e.exports=n},function(e,t){var r=Object.prototype;e.exports=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||r)}},function(e,t,r){var n=r(178),o=r(49),i=r(179),a=r(180),s=r(181),u=r(12),c=r(74),l=c(n),f=c(o),p=c(i),d=c(a),y=c(s),g=u;(n&&"[object DataView]"!=g(new n(new ArrayBuffer(1)))||o&&"[object Map]"!=g(new o)||i&&"[object Promise]"!=g(i.resolve())||a&&"[object Set]"!=g(new a)||s&&"[object WeakMap]"!=g(new s))&&(g=function(e){var t=u(e),r="[object Object]"==t?e.constructor:void 0,n=r?c(r):"";if(n)switch(n){case l:return"[object DataView]";case f:return"[object Map]";case p:return"[object Promise]";case d:return"[object Set]";case y:return"[object WeakMap]"}return t}),e.exports=g},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){var n=r(121),o=r(122),i=o;i.v1=n,i.v4=o,e.exports=i},function(e,t){e.exports=function(e,t){return e===t||e!=e&&t!=t}},function(e,t){e.exports=function(e){return e}},function(e,t,r){(function(e){var n=r(5),o=r(141),i=t&&!t.nodeType&&t,a=i&&"object"==typeof e&&e&&!e.nodeType&&e,s=a&&a.exports===i?n.Buffer:void 0,u=(s?s.isBuffer:void 0)||o;e.exports=u}).call(this,r(44)(e))},function(e,t,r){var n=r(76),o=r(145),i=r(9);e.exports=function(e){return i(e)?n(e,!0):o(e)}},function(e,t,r){var n=r(149),o=r(150),i=r(151),a=r(152),s=r(153);function u(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}u.prototype.clear=n,u.prototype.delete=o,u.prototype.get=i,u.prototype.has=a,u.prototype.set=s,e.exports=u},function(e,t,r){var n=r(23);e.exports=function(e,t){for(var r=e.length;r--;)if(n(e[r][0],t))return r;return-1}},function(e,t,r){var n=r(7)(Object,"create");e.exports=n},function(e,t,r){var n=r(167);e.exports=function(e,t){var r=e.__data__;return n(t)?r["string"==typeof t?"string":"hash"]:r.map}},function(e,t,r){var n=r(88),o=r(201)(n);e.exports=o},function(e,t,r){var n=r(55);e.exports=function(e){if("string"==typeof e||n(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){function r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}e.exports=function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){var n=r(107);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&n(e,t)},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){var n=r(64).default,o=r(108);e.exports=function(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return o(e)},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports={}},function(e,t,r){e.exports={exposed_search_in_mobile_v2:r(113).default}},function(e,t,r){var n=r(40),o=r(23),i=Object.prototype.hasOwnProperty;e.exports=function(e,t,r){var a=e[t];i.call(e,t)&&o(a,r)&&(void 0!==r||t in e)||n(e,t,r)}},function(e,t,r){var n=r(72);e.exports=function(e,t,r){"__proto__"==t&&n?n(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}},function(e,t){e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},function(e,t){var r=/^(?:0|[1-9]\d*)$/;e.exports=function(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&r.test(e))&&e>-1&&e%1==0&&e<t}},function(e,t,r){var n=r(140),o=r(6),i=Object.prototype,a=i.hasOwnProperty,s=i.propertyIsEnumerable,u=n(function(){return arguments}())?n:function(e){return o(e)&&a.call(e,"callee")&&!s.call(e,"callee")};e.exports=u},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,r){var n=r(142),o=r(46),i=r(47),a=i&&i.isTypedArray,s=a?o(a):n;e.exports=s},function(e,t){e.exports=function(e){return function(t){return e(t)}}},function(e,t,r){(function(e){var n=r(71),o=t&&!t.nodeType&&t,i=o&&"object"==typeof e&&e&&!e.nodeType&&e,a=i&&i.exports===o&&n.process,s=function(){try{var e=i&&i.require&&i.require("util").types;return e||a&&a.binding&&a.binding("util")}catch(e){}}();e.exports=s}).call(this,r(44)(e))},function(e,t,r){var n=r(27),o=r(154),i=r(155),a=r(156),s=r(157),u=r(158);function c(e){var t=this.__data__=new n(e);this.size=t.size}c.prototype.clear=o,c.prototype.delete=i,c.prototype.get=a,c.prototype.has=s,c.prototype.set=u,e.exports=c},function(e,t,r){var n=r(7)(r(5),"Map");e.exports=n},function(e,t,r){var n=r(159),o=r(166),i=r(168),a=r(169),s=r(170);function u(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}u.prototype.clear=n,u.prototype.delete=o,u.prototype.get=i,u.prototype.has=a,u.prototype.set=s,e.exports=u},function(e,t,r){var n=r(80),o=r(81),i=Object.prototype.propertyIsEnumerable,a=Object.getOwnPropertySymbols,s=a?function(e){return null==e?[]:(e=Object(e),n(a(e),(function(t){return i.call(e,t)})))}:o;e.exports=s},function(e,t,r){var n=r(87);e.exports=function(e){var t=new e.constructor(e.byteLength);return new n(t).set(new n(e)),t}},function(e,t,r){var n=r(202),o=r(215),i=r(24),a=r(1),s=r(225);e.exports=function(e){return"function"==typeof e?e:null==e?i:"object"==typeof e?a(e)?o(e[0],e[1]):n(e):s(e)}},function(e,t,r){var n=r(1),o=r(55),i=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;e.exports=function(e,t){if(n(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!o(e))||(a.test(e)||!i.test(e)||null!=t&&e in Object(t))}},function(e,t,r){var n=r(12),o=r(6);e.exports=function(e){return"symbol"==typeof e||o(e)&&"[object Symbol]"==n(e)}},function(e,t){e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length,o=Array(n);++r<n;)o[r]=t(e[r],r,e);return o}},function(e,t,r){var n=r(2).sprintf,o=r(0).ERROR_MESSAGES,i="CONFIG_VALIDATOR",a=r(0).DATAFILE_VERSIONS,s=[a.V2,a.V3,a.V4];e.exports={validate:function(e){if(e.errorHandler&&"function"!=typeof e.errorHandler.handleError)throw new Error(n(o.INVALID_ERROR_HANDLER,i));if(e.eventDispatcher&&"function"!=typeof e.eventDispatcher.dispatchEvent)throw new Error(n(o.INVALID_EVENT_DISPATCHER,i));if(e.logger&&"function"!=typeof e.logger.log)throw new Error(n(o.INVALID_LOGGER,i));return!0},validateDatafile:function(e){if(!e)throw new Error(n(o.NO_DATAFILE_SPECIFIED,i));if("string"==typeof e||e instanceof String)try{e=JSON.parse(e)}catch(e){throw new Error(n(o.INVALID_DATAFILE_MALFORMED,i))}if(-1===s.indexOf(e.version))throw new Error(n(o.INVALID_DATAFILE_VERSION,i,e.version));return!0}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(22);function o(e){return Object.keys(e).map((function(t){return e[t]}))}t.getTimestamp=function(){return(new Date).getTime()},t.generateUUID=function(){return n.v4()},t.isValidEnum=function(e,t){for(var r=!1,n=Object.keys(e),o=0;o<n.length;o++)if(t===e[n[o]]){r=!0;break}return r},t.groupBy=function(e,t){var r={};return e.forEach((function(e){var n=t(e);r[n]=r[n]||[],r[n].push(e)})),o(r)},t.objectValues=o,t.objectEntries=function(e){return Object.keys(e).map((function(t){return[t,e[t]]}))},t.find=function(e,t){for(var r,n=0,o=e;n<o.length;n++){var i=o[n];if(t(i)){r=i;break}}return r},t.keyBy=function(e,t){var r={};return e.forEach((function(e){var n=t(e);r[n]=e})),r},t.sprintf=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=0;return e.replace(/%s/g,(function(){var e=t[n++],r=typeof e;return"function"===r?e():"string"===r?e:String(e)}))},function(e){e.ACTIVATE="ACTIVATE:experiment, user_id,attributes, variation, event",e.DECISION="DECISION:type, userId, attributes, decisionInfo",e.LOG_EVENT="LOG_EVENT:logEvent",e.OPTIMIZELY_CONFIG_UPDATE="OPTIMIZELY_CONFIG_UPDATE",e.TRACK="TRACK:event_key, user_id, attributes, event_tags, event"}(t.NOTIFICATION_TYPES||(t.NOTIFICATION_TYPES={}))},function(e,t,r){var n=r(2).sprintf,o=r(96),i=r(3),a=r(0).ERROR_MESSAGES;e.exports={validate:function(e){if("object"!=typeof e||Array.isArray(e)||null===e)throw new Error(n(a.INVALID_ATTRIBUTES,"ATTRIBUTES_VALIDATOR"));return o(e,(function(e,t){if(void 0===e)throw new Error(n(a.UNDEFINED_ATTRIBUTE,"ATTRIBUTES_VALIDATOR",t))})),!0},isAttributeValid:function(e,t){return"string"==typeof e&&("string"==typeof t||"boolean"==typeof t||i.isNumber(t)&&i.isFinite(t))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_UPDATE_INTERVAL=3e5,t.MIN_UPDATE_INTERVAL=1e3,t.DEFAULT_URL_TEMPLATE="https://cdn.optimizely.com/datafiles/%s.json",t.BACKOFF_BASE_WAIT_SECONDS_BY_ERROR_COUNT=[0,8,16,32,64,128,256,512],t.REQUEST_TIMEOUT_MS=6e4},function(e,t,r){"use strict";var n=SyntaxError,o=Function,i=TypeError,a=function(e){try{return o('"use strict"; return ('+e+").constructor;")()}catch(e){}},s=Object.getOwnPropertyDescriptor;if(s)try{s({},"")}catch(e){s=null}var u=function(){throw new i},c=s?function(){try{return u}catch(e){try{return s(arguments,"callee").get}catch(e){return u}}}():u,l=r(271)(),f=Object.getPrototypeOf||function(e){return e.__proto__},p={},d="undefined"==typeof Uint8Array?void 0:f(Uint8Array),y={"%AggregateError%":"undefined"==typeof AggregateError?void 0:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?void 0:ArrayBuffer,"%ArrayIteratorPrototype%":l?f([][Symbol.iterator]()):void 0,"%AsyncFromSyncIteratorPrototype%":void 0,"%AsyncFunction%":p,"%AsyncGenerator%":p,"%AsyncGeneratorFunction%":p,"%AsyncIteratorPrototype%":p,"%Atomics%":"undefined"==typeof Atomics?void 0:Atomics,"%BigInt%":"undefined"==typeof BigInt?void 0:BigInt,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?void 0:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?void 0:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?void 0:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?void 0:FinalizationRegistry,"%Function%":o,"%GeneratorFunction%":p,"%Int8Array%":"undefined"==typeof Int8Array?void 0:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?void 0:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?void 0:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":l?f(f([][Symbol.iterator]())):void 0,"%JSON%":"object"==typeof JSON?JSON:void 0,"%Map%":"undefined"==typeof Map?void 0:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&l?f((new Map)[Symbol.iterator]()):void 0,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?void 0:Promise,"%Proxy%":"undefined"==typeof Proxy?void 0:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?void 0:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?void 0:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&l?f((new Set)[Symbol.iterator]()):void 0,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?void 0:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":l?f(""[Symbol.iterator]()):void 0,"%Symbol%":l?Symbol:void 0,"%SyntaxError%":n,"%ThrowTypeError%":c,"%TypedArray%":d,"%TypeError%":i,"%Uint8Array%":"undefined"==typeof Uint8Array?void 0:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?void 0:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?void 0:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?void 0:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?void 0:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?void 0:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?void 0:WeakSet},g={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},v=r(62),h=r(274),E=v.call(Function.call,Array.prototype.concat),_=v.call(Function.apply,Array.prototype.splice),m=v.call(Function.call,String.prototype.replace),I=v.call(Function.call,String.prototype.slice),O=v.call(Function.call,RegExp.prototype.exec),b=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,R=/\\(\\)?/g,T=function(e){var t=I(e,0,1),r=I(e,-1);if("%"===t&&"%"!==r)throw new n("invalid intrinsic syntax, expected closing `%`");if("%"===r&&"%"!==t)throw new n("invalid intrinsic syntax, expected opening `%`");var o=[];return m(e,b,(function(e,t,r,n){o[o.length]=r?m(n,R,"$1"):t||e})),o},A=function(e,t){var r,o=e;if(h(g,o)&&(o="%"+(r=g[o])[0]+"%"),h(y,o)){var s=y[o];if(s===p&&(s=function e(t){var r;if("%AsyncFunction%"===t)r=a("async function () {}");else if("%GeneratorFunction%"===t)r=a("function* () {}");else if("%AsyncGeneratorFunction%"===t)r=a("async function* () {}");else if("%AsyncGenerator%"===t){var n=e("%AsyncGeneratorFunction%");n&&(r=n.prototype)}else if("%AsyncIteratorPrototype%"===t){var o=e("%AsyncGenerator%");o&&(r=f(o.prototype))}return y[t]=r,r}(o)),void 0===s&&!t)throw new i("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:r,name:o,value:s}}throw new n("intrinsic "+e+" does not exist!")};e.exports=function(e,t){if("string"!=typeof e||0===e.length)throw new i("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof t)throw new i('"allowMissing" argument must be a boolean');if(null===O(/^%?[^%]*%?$/g,e))throw new n("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=T(e),o=r.length>0?r[0]:"",a=A("%"+o+"%",t),u=a.name,c=a.value,l=!1,f=a.alias;f&&(o=f[0],_(r,E([0,1],f)));for(var p=1,d=!0;p<r.length;p+=1){var g=r[p],v=I(g,0,1),m=I(g,-1);if(('"'===v||"'"===v||"`"===v||'"'===m||"'"===m||"`"===m)&&v!==m)throw new n("property names with quotes must have matching quotes");if("constructor"!==g&&d||(l=!0),h(y,u="%"+(o+="."+g)+"%"))c=y[u];else if(null!=c){if(!(g in c)){if(!t)throw new i("base intrinsic for "+e+" exists, but the property is not available.");return}if(s&&p+1>=r.length){var b=s(c,g);c=(d=!!b)&&"get"in b&&!("originalValue"in b.get)?b.get:c[g]}else d=h(c,g),c=c[g];d&&!l&&(y[u]=c)}}return c}},function(e,t,r){"use strict";var n=r(273);e.exports=Function.prototype.bind||n},function(e,t,r){"use strict";var n=String.prototype.replace,o=/%20/g,i="RFC1738",a="RFC3986";e.exports={default:a,formatters:{RFC1738:function(e){return n.call(e,o,"+")},RFC3986:function(e){return String(e)}},RFC1738:i,RFC3986:a}},function(e,t){function r(t){return e.exports=r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,r(t)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.handleError=function(e){},e}();t.NoopErrorHandler=n;var o=new n;t.setErrorHandler=function(e){o=e},t.getErrorHandler=function(){return o},t.resetErrorHandler=function(){o=new n}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.NOTSET=0]="NOTSET",e[e.DEBUG=1]="DEBUG",e[e.INFO=2]="INFO",e[e.WARNING=3]="WARNING",e[e.ERROR=4]="ERROR"}(t.LogLevel||(t.LogLevel={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(22);function o(e){return Object.keys(e).map((function(t){return e[t]}))}t.getTimestamp=function(){return(new Date).getTime()},t.generateUUID=function(){return n.v4()},t.isValidEnum=function(e,t){for(var r=!1,n=Object.keys(e),o=0;o<n.length;o++)if(t===e[n[o]]){r=!0;break}return r},t.groupBy=function(e,t){var r={};return e.forEach((function(e){var n=t(e);r[n]=r[n]||[],r[n].push(e)})),o(r)},t.objectValues=o,t.find=function(e,t){for(var r,n=0,o=e;n<o.length;n++){var i=o[n];if(t(i)){r=i;break}}return r},t.keyBy=function(e,t){var r={};return e.forEach((function(e){var n=t(e);r[n]=e})),r},t.sprintf=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=0;return e.replace(/%s/g,(function(){var e=t[n++],r=typeof e;return"function"===r?e():"string"===r?e:String(e)}))}},function(e,t){var r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(r){var n=new Uint8Array(16);e.exports=function(){return r(n),n}}else{var o=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}}},function(e,t){for(var r=[],n=0;n<256;++n)r[n]=(n+256).toString(16).substr(1);e.exports=function(e,t){var n=t||0,o=r;return[o[e[n++]],o[e[n++]],o[e[n++]],o[e[n++]],"-",o[e[n++]],o[e[n++]],"-",o[e[n++]],o[e[n++]],"-",o[e[n++]],o[e[n++]],"-",o[e[n++]],o[e[n++]],o[e[n++]],o[e[n++]],o[e[n++]],o[e[n++]]].join("")}},function(e,t,r){(function(t){var r="object"==typeof t&&t&&t.Object===Object&&t;e.exports=r}).call(this,r(21))},function(e,t,r){var n=r(7),o=function(){try{var e=n(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=o},function(e,t,r){var n=r(12),o=r(8);e.exports=function(e){if(!o(e))return!1;var t=n(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},function(e,t){var r=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return r.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},function(e,t,r){var n=r(131),o=r(138);e.exports=function(e){return n((function(t,r){var n=-1,i=r.length,a=i>1?r[i-1]:void 0,s=i>2?r[2]:void 0;for(a=e.length>3&&"function"==typeof a?(i--,a):void 0,s&&o(r[0],r[1],s)&&(a=i<3?void 0:a,i=1),t=Object(t);++n<i;){var u=r[n];u&&e(t,u,n,a)}return t}))}},function(e,t,r){var n=r(139),o=r(43),i=r(1),a=r(25),s=r(42),u=r(45),c=Object.prototype.hasOwnProperty;e.exports=function(e,t){var r=i(e),l=!r&&o(e),f=!r&&!l&&a(e),p=!r&&!l&&!f&&u(e),d=r||l||f||p,y=d?n(e.length,String):[],g=y.length;for(var v in e)!t&&!c.call(e,v)||d&&("length"==v||f&&("offset"==v||"parent"==v)||p&&("buffer"==v||"byteLength"==v||"byteOffset"==v)||s(v,g))||y.push(v);return y}},function(e,t,r){var n=r(19),o=r(143),i=Object.prototype.hasOwnProperty;e.exports=function(e){if(!n(e))return o(e);var t=[];for(var r in Object(e))i.call(e,r)&&"constructor"!=r&&t.push(r);return t}},function(e,t){e.exports=function(e,t){return function(r){return e(t(r))}}},function(e,t){e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e}},function(e,t){e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length,o=0,i=[];++r<n;){var a=e[r];t(a,r,e)&&(i[o++]=a)}return i}},function(e,t){e.exports=function(){return[]}},function(e,t,r){var n=r(83),o=r(84),i=r(51),a=r(81),s=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)n(t,i(e)),e=o(e);return t}:a;e.exports=s},function(e,t){e.exports=function(e,t){for(var r=-1,n=t.length,o=e.length;++r<n;)e[o+r]=t[r];return e}},function(e,t,r){var n=r(78)(Object.getPrototypeOf,Object);e.exports=n},function(e,t,r){var n=r(86),o=r(51),i=r(10);e.exports=function(e){return n(e,i,o)}},function(e,t,r){var n=r(83),o=r(1);e.exports=function(e,t,r){var i=t(e);return o(e)?i:n(i,r(e))}},function(e,t,r){var n=r(5).Uint8Array;e.exports=n},function(e,t,r){var n=r(199),o=r(10);e.exports=function(e,t){return e&&n(e,t,o)}},function(e,t,r){var n=r(204),o=r(6);e.exports=function e(t,r,i,a,s){return t===r||(null==t||null==r||!o(t)&&!o(r)?t!=t&&r!=r:n(t,r,i,a,e,s))}},function(e,t,r){var n=r(205),o=r(208),i=r(209);e.exports=function(e,t,r,a,s,u){var c=1&r,l=e.length,f=t.length;if(l!=f&&!(c&&f>l))return!1;var p=u.get(e),d=u.get(t);if(p&&d)return p==t&&d==e;var y=-1,g=!0,v=2&r?new n:void 0;for(u.set(e,t),u.set(t,e);++y<l;){var h=e[y],E=t[y];if(a)var _=c?a(E,h,y,t,e,u):a(h,E,y,e,t,u);if(void 0!==_){if(_)continue;g=!1;break}if(v){if(!o(t,(function(e,t){if(!i(v,t)&&(h===e||s(h,e,r,a,u)))return v.push(t)}))){g=!1;break}}else if(h!==E&&!s(h,E,r,a,u)){g=!1;break}}return u.delete(e),u.delete(t),g}},function(e,t,r){var n=r(8);e.exports=function(e){return e==e&&!n(e)}},function(e,t){e.exports=function(e,t){return function(r){return null!=r&&(r[e]===t&&(void 0!==t||e in Object(r)))}}},function(e,t,r){var n=r(94),o=r(32);e.exports=function(e,t){for(var r=0,i=(t=n(t,e)).length;null!=e&&r<i;)e=e[o(t[r++])];return r&&r==i?e:void 0}},function(e,t,r){var n=r(1),o=r(54),i=r(217),a=r(220);e.exports=function(e,t){return n(e)?e:o(e,t)?[e]:i(a(e))}},function(e,t,r){var n=r(24);e.exports=function(e){return"function"==typeof e?e:n}},function(e,t,r){var n=r(88),o=r(95);e.exports=function(e,t){return e&&n(e,o(t))}},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(98)),n(r(99)),n(r(240)),n(r(100)),n(r(242))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.areEventContextsEqual=function(e,t){var r=e.context,n=t.context;return r.accountId===n.accountId&&r.projectId===n.projectId&&r.clientName===n.clientName&&r.clientVersion===n.clientVersion&&r.revision===n.revision&&r.anonymizeIP===n.anonymizeIP&&r.botFiltering===n.botFiltering}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(98),i=r(238),a=r(4),s=r(58),u=n(r(239)),c=a.getLogger("EventProcessor"),l=function(){function e(e){var t=e.dispatcher,r=e.flushInterval,n=void 0===r?3e4:r,a=e.maxQueueSize,s=void 0===a?3e3:a,l=e.notificationCenter,f=this;this.dispatcher=t,n<=0&&(c.warn("Invalid flushInterval "+n+", defaulting to 30000"),n=3e4),(s=Math.floor(s))<1&&(c.warn("Invalid maxQueueSize "+s+", defaulting to 10"),s=10),s=Math.max(1,s),this.queue=s>1?new i.DefaultEventQueue({flushInterval:n,maxQueueSize:s,sink:function(e){return f.drainQueue(e)},batchComparator:o.areEventContextsEqual}):new i.SingleEventQueue({sink:function(e){return f.drainQueue(e)}}),this.notificationCenter=l,this.requestTracker=new u.default}return e.prototype.drainQueue=function(e){var t=this,r=new Promise((function(r){if(c.debug("draining queue with %s events",e.length),0!==e.length){var n=t.formatEvents(e);t.dispatcher.dispatchEvent(n,(function(){r()})),t.notificationCenter&&t.notificationCenter.sendNotifications(s.NOTIFICATION_TYPES.LOG_EVENT,n)}else r()}));return this.requestTracker.trackRequest(r),r},e.prototype.process=function(e){this.queue.enqueue(e)},e.prototype.stop=function(){try{return this.queue.stop(),this.requestTracker.onRequestsComplete()}catch(e){c.error('Error stopping EventProcessor: "%s"',e.message,e)}return Promise.resolve()},e.prototype.start=function(){this.queue.start()},e}();t.AbstractEventProcessor=l},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});function o(e){var t=n({},e.tags);delete t.revenue,delete t.value;var r={entity_id:e.event.id,key:e.event.key,timestamp:e.timestamp,uuid:e.uuid};return e.tags&&(r.tags=e.tags),null!=e.value&&(r.value=e.value),null!=e.revenue&&(r.revenue=e.revenue),{events:[r]}}function i(e){var t=e.layer,r=e.experiment,n=e.variation,o=t?t.id:null;return{decisions:[{campaign_id:o,experiment_id:r?r.id:null,variation_id:n?n.id:null}],events:[{entity_id:o,timestamp:e.timestamp,key:"campaign_activated",uuid:e.uuid}]}}function a(e){var t={snapshots:[],visitor_id:e.user.id,attributes:[]};return e.user.attributes.forEach((function(e){t.attributes.push({entity_id:e.entityId,key:e.key,type:"custom",value:e.value})})),"boolean"==typeof e.context.botFiltering&&t.attributes.push({entity_id:"$opt_bot_filtering",key:"$opt_bot_filtering",type:"custom",value:e.context.botFiltering}),t}t.makeBatchedEventV1=function(e){var t=[],r=e[0];return e.forEach((function(e){if("conversion"===e.type||"impression"===e.type){var r=a(e);"impression"===e.type?r.snapshots.push(i(e)):"conversion"===e.type&&r.snapshots.push(o(e)),t.push(r)}})),{client_name:r.context.clientName,client_version:r.context.clientVersion,account_id:r.context.accountId,project_id:r.context.projectId,revision:r.context.revision,anonymize_ip:r.context.anonymizeIP,enrich_decisions:!0,visitors:t}},t.buildImpressionEventV1=function(e){var t=a(e);return t.snapshots.push(i(e)),{client_name:e.context.clientName,client_version:e.context.clientVersion,account_id:e.context.accountId,project_id:e.context.projectId,revision:e.context.revision,anonymize_ip:e.context.anonymizeIP,enrich_decisions:!0,visitors:[t]}},t.buildConversionEventV1=function(e){var t=a(e);return t.snapshots.push(o(e)),{client_name:e.context.clientName,client_version:e.context.clientVersion,account_id:e.context.accountId,project_id:e.context.projectId,revision:e.context.revision,anonymize_ip:e.context.anonymizeIP,enrich_decisions:!0,visitors:[t]}}},function(e,t){e.exports={validate:function(e){return"string"==typeof e&&""!==e}}},function(e,t,r){var n=r(0),o=r(2).sprintf,i=n.LOG_LEVEL,a=n.LOG_MESSAGES,s=n.RESERVED_EVENT_KEYWORDS.REVENUE,u=n.RESERVED_EVENT_KEYWORDS.VALUE;e.exports={getRevenueValue:function(e,t){if(e&&e.hasOwnProperty(s)){var r=e[s],n=parseInt(r,10);return isNaN(n)?(t.log(i.INFO,o(a.FAILED_TO_PARSE_REVENUE,"EVENT_TAG_UTILS",r)),null):(t.log(i.INFO,o(a.PARSED_REVENUE_VALUE,"EVENT_TAG_UTILS",n)),n)}return null},getEventValue:function(e,t){if(e&&e.hasOwnProperty(u)){var r=e[u],n=parseFloat(r);return isNaN(n)?(t.log(i.INFO,o(a.FAILED_TO_PARSE_VALUE,"EVENT_TAG_UTILS",r)),null):(t.log(i.INFO,o(a.PARSED_NUMERIC_VALUE,"EVENT_TAG_UTILS",n)),n)}return null}}},function(e,t,r){"use strict";var n=r(63),o=Object.prototype.hasOwnProperty,i=Array.isArray,a=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}(),s=function(e,t){for(var r=t&&t.plainObjects?Object.create(null):{},n=0;n<e.length;++n)void 0!==e[n]&&(r[n]=e[n]);return r};e.exports={arrayToObject:s,assign:function(e,t){return Object.keys(t).reduce((function(e,r){return e[r]=t[r],e}),e)},combine:function(e,t){return[].concat(e,t)},compact:function(e){for(var t=[{obj:{o:e},prop:"o"}],r=[],n=0;n<t.length;++n)for(var o=t[n],a=o.obj[o.prop],s=Object.keys(a),u=0;u<s.length;++u){var c=s[u],l=a[c];"object"==typeof l&&null!==l&&-1===r.indexOf(l)&&(t.push({obj:a,prop:c}),r.push(l))}return function(e){for(;e.length>1;){var t=e.pop(),r=t.obj[t.prop];if(i(r)){for(var n=[],o=0;o<r.length;++o)void 0!==r[o]&&n.push(r[o]);t.obj[t.prop]=n}}}(t),e},decode:function(e,t,r){var n=e.replace(/\+/g," ");if("iso-8859-1"===r)return n.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(n)}catch(e){return n}},encode:function(e,t,r,o,i){if(0===e.length)return e;var s=e;if("symbol"==typeof e?s=Symbol.prototype.toString.call(e):"string"!=typeof e&&(s=String(e)),"iso-8859-1"===r)return escape(s).replace(/%u[0-9a-f]{4}/gi,(function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B"}));for(var u="",c=0;c<s.length;++c){var l=s.charCodeAt(c);45===l||46===l||95===l||126===l||l>=48&&l<=57||l>=65&&l<=90||l>=97&&l<=122||i===n.RFC1738&&(40===l||41===l)?u+=s.charAt(c):l<128?u+=a[l]:l<2048?u+=a[192|l>>6]+a[128|63&l]:l<55296||l>=57344?u+=a[224|l>>12]+a[128|l>>6&63]+a[128|63&l]:(c+=1,l=65536+((1023&l)<<10|1023&s.charCodeAt(c)),u+=a[240|l>>18]+a[128|l>>12&63]+a[128|l>>6&63]+a[128|63&l])}return u},isBuffer:function(e){return!(!e||"object"!=typeof e)&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},isRegExp:function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},maybeMap:function(e,t){if(i(e)){for(var r=[],n=0;n<e.length;n+=1)r.push(t(e[n]));return r}return t(e)},merge:function e(t,r,n){if(!r)return t;if("object"!=typeof r){if(i(t))t.push(r);else{if(!t||"object"!=typeof t)return[t,r];(n&&(n.plainObjects||n.allowPrototypes)||!o.call(Object.prototype,r))&&(t[r]=!0)}return t}if(!t||"object"!=typeof t)return[t].concat(r);var a=t;return i(t)&&!i(r)&&(a=s(t,n)),i(t)&&i(r)?(r.forEach((function(r,i){if(o.call(t,i)){var a=t[i];a&&"object"==typeof a&&r&&"object"==typeof r?t[i]=e(a,r,n):t.push(r)}else t[i]=r})),t):Object.keys(r).reduce((function(t,i){var a=r[i];return o.call(t,i)?t[i]=e(t[i],a,n):t[i]=a,t}),a)}}},function(e,t,r){r(106),e.exports=self.fetch.bind(self)},function(e,t){e.exports=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){"use strict";r.r(t),r.d(t,"Headers",(function(){return y})),r.d(t,"Request",(function(){return I})),r.d(t,"Response",(function(){return b})),r.d(t,"DOMException",(function(){return T})),r.d(t,"fetch",(function(){return A}));var n="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||void 0!==n&&n,o="URLSearchParams"in n,i="Symbol"in n&&"iterator"in Symbol,a="FileReader"in n&&"Blob"in n&&function(){try{return new Blob,!0}catch(e){return!1}}(),s="FormData"in n,u="ArrayBuffer"in n;if(u)var c=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],l=ArrayBuffer.isView||function(e){return e&&c.indexOf(Object.prototype.toString.call(e))>-1};function f(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(e)||""===e)throw new TypeError('Invalid character in header field name: "'+e+'"');return e.toLowerCase()}function p(e){return"string"!=typeof e&&(e=String(e)),e}function d(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return i&&(t[Symbol.iterator]=function(){return t}),t}function y(e){this.map={},e instanceof y?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function g(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function v(e){return new Promise((function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}}))}function h(e){var t=new FileReader,r=v(t);return t.readAsArrayBuffer(e),r}function E(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function _(){return this.bodyUsed=!1,this._initBody=function(e){var t;this.bodyUsed=this.bodyUsed,this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:a&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:s&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:o&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():u&&a&&((t=e)&&DataView.prototype.isPrototypeOf(t))?(this._bodyArrayBuffer=E(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):u&&(ArrayBuffer.prototype.isPrototypeOf(e)||l(e))?this._bodyArrayBuffer=E(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):o&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},a&&(this.blob=function(){var e=g(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){if(this._bodyArrayBuffer){var e=g(this);return e||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}return this.blob().then(h)}),this.text=function(){var e,t,r,n=g(this);if(n)return n;if(this._bodyBlob)return e=this._bodyBlob,t=new FileReader,r=v(t),t.readAsText(e),r;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),r=new Array(t.length),n=0;n<t.length;n++)r[n]=String.fromCharCode(t[n]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},s&&(this.formData=function(){return this.text().then(O)}),this.json=function(){return this.text().then(JSON.parse)},this}y.prototype.append=function(e,t){e=f(e),t=p(t);var r=this.map[e];this.map[e]=r?r+", "+t:t},y.prototype.delete=function(e){delete this.map[f(e)]},y.prototype.get=function(e){return e=f(e),this.has(e)?this.map[e]:null},y.prototype.has=function(e){return this.map.hasOwnProperty(f(e))},y.prototype.set=function(e,t){this.map[f(e)]=p(t)},y.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},y.prototype.keys=function(){var e=[];return this.forEach((function(t,r){e.push(r)})),d(e)},y.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),d(e)},y.prototype.entries=function(){var e=[];return this.forEach((function(t,r){e.push([r,t])})),d(e)},i&&(y.prototype[Symbol.iterator]=y.prototype.entries);var m=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function I(e,t){if(!(this instanceof I))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var r,n,o=(t=t||{}).body;if(e instanceof I){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new y(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,o||null==e._bodyInit||(o=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new y(t.headers)),this.method=(r=t.method||this.method||"GET",n=r.toUpperCase(),m.indexOf(n)>-1?n:r),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&o)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(o),!("GET"!==this.method&&"HEAD"!==this.method||"no-store"!==t.cache&&"no-cache"!==t.cache)){var i=/([?&])_=[^&]*/;if(i.test(this.url))this.url=this.url.replace(i,"$1_="+(new Date).getTime());else{this.url+=(/\?/.test(this.url)?"&":"?")+"_="+(new Date).getTime()}}}function O(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var r=e.split("="),n=r.shift().replace(/\+/g," "),o=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(n),decodeURIComponent(o))}})),t}function b(e,t){if(!(this instanceof b))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText=void 0===t.statusText?"":""+t.statusText,this.headers=new y(t.headers),this.url=t.url||"",this._initBody(e)}I.prototype.clone=function(){return new I(this,{body:this._bodyInit})},_.call(I.prototype),_.call(b.prototype),b.prototype.clone=function(){return new b(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new y(this.headers),url:this.url})},b.error=function(){var e=new b(null,{status:0,statusText:""});return e.type="error",e};var R=[301,302,303,307,308];b.redirect=function(e,t){if(-1===R.indexOf(t))throw new RangeError("Invalid status code");return new b(null,{status:t,headers:{location:e}})};var T=n.DOMException;try{new T}catch(e){(T=function(e,t){this.message=e,this.name=t;var r=Error(e);this.stack=r.stack}).prototype=Object.create(Error.prototype),T.prototype.constructor=T}function A(e,t){return new Promise((function(r,o){var i=new I(e,t);if(i.signal&&i.signal.aborted)return o(new T("Aborted","AbortError"));var s=new XMLHttpRequest;function c(){s.abort()}s.onload=function(){var e,t,n={status:s.status,statusText:s.statusText,headers:(e=s.getAllResponseHeaders()||"",t=new y,e.replace(/\r?\n[\t ]+/g," ").split("\r").map((function(e){return 0===e.indexOf("\n")?e.substr(1,e.length):e})).forEach((function(e){var r=e.split(":"),n=r.shift().trim();if(n){var o=r.join(":").trim();t.append(n,o)}})),t)};n.url="responseURL"in s?s.responseURL:n.headers.get("X-Request-URL");var o="response"in s?s.response:s.responseText;setTimeout((function(){r(new b(o,n))}),0)},s.onerror=function(){setTimeout((function(){o(new TypeError("Network request failed"))}),0)},s.ontimeout=function(){setTimeout((function(){o(new TypeError("Network request failed"))}),0)},s.onabort=function(){setTimeout((function(){o(new T("Aborted","AbortError"))}),0)},s.open(i.method,function(e){try{return""===e&&n.location.href?n.location.href:e}catch(t){return e}}(i.url),!0),"include"===i.credentials?s.withCredentials=!0:"omit"===i.credentials&&(s.withCredentials=!1),"responseType"in s&&(a?s.responseType="blob":u&&i.headers.get("Content-Type")&&-1!==i.headers.get("Content-Type").indexOf("application/octet-stream")&&(s.responseType="arraybuffer")),!t||"object"!=typeof t.headers||t.headers instanceof y?i.headers.forEach((function(e,t){s.setRequestHeader(t,e)})):Object.getOwnPropertyNames(t.headers).forEach((function(e){s.setRequestHeader(e,p(t.headers[e]))})),i.signal&&(i.signal.addEventListener("abort",c),s.onreadystatechange=function(){4===s.readyState&&i.signal.removeEventListener("abort",c)}),s.send(void 0===i._bodyInit?null:i._bodyInit)}))}A.polyfill=!0,n.fetch||(n.fetch=A,n.Headers=y,n.Request=I,n.Response=b)},function(e,t){function r(t,n){return e.exports=r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},e.exports.__esModule=!0,e.exports.default=e.exports,r(t,n)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){var n=r(65);e.exports=function(e){if(Array.isArray(e))return n(e)},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){var n=r(65);e.exports=function(e,t){if(e){if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){"use strict";function n(e){var t=e.variationKey,r=e.dotcomNav.opts.appInfo.viewChannel;if(t&&("homepage"===r||"cart"===r||"test"===r)){var n=document.getElementsByClassName("pre-l-header-container")[0],o=document.querySelectorAll('[data-search-input="standard"]')[0],i=document.querySelectorAll('[data-search-input="extended"]')[0];switch(t){case"CONTROL":null==n||n.classList.remove("mobile-header-exposed-search-enabled");break;case"VARIANT_1":null==n||n.classList.add("mobile-header-exposed-search-enabled"),null==i||i.remove();break;case"VARIANT_2":null==n||n.classList.add("mobile-header-exposed-search-enabled"),null==i||i.classList.remove("hide-search-input"),null==o||o.remove()}}}r.r(t),r.d(t,"default",(function(){return n}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getVariantVariables=t.getFeatureVariable=t.getFeatureVariableObject=t.getFeatureFlagByExperimentId=t.getFeatureFlagsByExperimentId=t.getDriver=t.getExperimentDriver=t.filterRunningExperiments=t.activateExperiments=t.getRollouts=t.getVariations=t.activateExperiment=t.getVariation=t.getForcedRollout=t.sanitizeRollout=t.getForcedVariant=t.getForced=t.getForcedExperiments=t.sanitizeForcedVariant=t.sanitizeVariant=t.getExperiment=t.getExperiments=t.mapFeatureKeys=t.mapExperimentKeys=t.getOptimizelyUserId=t.ACTIVE_ROLLOUT_KEY=void 0;var n=s(r(115)),o=r(267),i=s(r(282)),a=s(r(268));function s(e){return e&&e.__esModule?e:{default:e}}function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){l(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function f(e){return function(e){if(Array.isArray(e))return p(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return p(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return p(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}t.ACTIVE_ROLLOUT_KEY="1";var d=function(e){return new i.default(o.canUseDOM?void 0:e).get("anonymousId")};t.getOptimizelyUserId=d;var y=function(e){return e.key};t.mapExperimentKeys=y;var g=y;t.mapFeatureKeys=g;var v=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=[];try{return r=f(e.experiments),e.groups.forEach((function(e){r=[].concat(f(r),f(e.experiments))})),t?r.filter(t):r}catch(e){return r}};t.getExperiments=v;var h=function(e,t){return v(e,t)[0]};t.getExperiment=h;var E=function(e,t,r){if(e&&r&&r.projectConfigManager.getConfig()){var n=function(){for(var e=v(r.projectConfigManager.getConfig()),n=0;n<e.length;n+=1)if(e[n].key===t)return e[n]}();if(!n)return;var o=n.variations.map((function(e){return e.key.toUpperCase()}));return o.indexOf(e.toUpperCase())>-1?o[o.indexOf(e.toUpperCase())]:void 0}};t.sanitizeVariant=E;var _=E;t.sanitizeForcedVariant=_;var m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"opxp",t=o.canUseDOM&&a.default.parse(document.location.search,{allowDots:!0,ignoreQueryPrefix:!0});return t&&t[e]||{}};t.getForcedExperiments=m;var I=function(e,t,r,n,o){var i=m(n),a=t&&t[n]&&t[n][e]||i[e];return r?o(a,e,r):a};t.getForced=I;var O=function(e,t,r){return I(e,t,r,"opxp",_)};t.getForcedVariant=O;var b=function(e,t){return t.projectConfigManager.getConfig().featureFlags.map(g).find((function(t){return t===e}))?e:void 0};t.sanitizeRollout=b;var R=function(e,t,r){var n=I(e,t,void 0,"oprp");return r?b(e,r)&&n:n};t.getForcedRollout=R;var T=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:d(),n=arguments.length>3?arguments[3]:void 0,o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:O,a=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],s=i&&"function"==typeof i&&i(t,void 0,a&&e);if(s)return e.setForcedVariation(t,r,s),s;var u="function"==typeof o?o(e,t,r,n,o,i,a):o;return e[u?"activate":"getVariation"](t,r,n)};t.getVariation=T;t.activateExperiment=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:d(),n=arguments.length>3?arguments[3]:void 0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:O,i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];return T(e,t,r,n,!0,o,i)};var A=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:O,a=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],s={};return t.forEach((function(t){s[t]=T(e,t,r,n,o,i,a)})),s};t.getVariations=A;t.getRollouts=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:R,o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i={};return e.projectConfigManager.getConfig().featureFlags.map(g).forEach((function(a){var s=e.isFeatureEnabled(a,t,r);(n(a,o&&e)||s)&&(i[a]="1")})),i};t.activateExperiments=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:O,i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];return A(e,t,r,n,!0,o,i)};t.filterRunningExperiments=function(e){return"Running"===e.status};var N=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n.default.createInstance(c({datafile:e,skipJSONValidation:!0},t))};t.getExperimentDriver=N;var S=N;t.getDriver=S;var x=function(e,t){return e.featureFlags.filter((function(e){return e.experimentIds.includes(t)}))};t.getFeatureFlagsByExperimentId=x;var P=function(e,t){return x(e,t)[0]||null};t.getFeatureFlagByExperimentId=P;var L=function(e,t){for(var r=0;r<e.featureFlags.length;r+=1){var n=e.featureFlags[r].variables.find(t);if(n)return n}};t.getFeatureVariableObject=L;var U=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:d(),o=arguments.length>4?arguments[4]:void 0,i=L(e.projectConfigManager.getConfig(),(function(e){return e.key===r})),a=i.type;return function(){switch(a){case"integer":return e.getFeatureVariableInteger(t,r,n,o)||null;case"double":return e.getFeatureVariableDouble(t,r,n,o)||null;case"boolean":return null===e.getFeatureVariableBoolean(t,r,n,o)?null:e.getFeatureVariableBoolean(t,r,n,o);case"string":default:return e.getFeatureVariableString(t,r,n,o)||null}}()};t.getFeatureVariable=U;t.getVariantVariables=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o={},i=e.projectConfigManager.getConfig();return t.map((function(e){return h(i,(function(t){return t.key===e}))})).filter(Boolean).forEach((function(t){o[t.key]={},t.variations.forEach((function(a){a.variables&&a.variables.forEach((function(a){var s=L(e.projectConfigManager.getConfig(),(function(e){var t=e.id;return a.id===t})).key,u=P(i,t.id);u&&(o[t.key][s]=U(e,u.key,s,r,n))}))}))})),o}},function(e,t,r){r(116);var n=r(4),o=r(3),i=r(57),a=r(236),s=r(237),u=r(0),c=r(97),l=r(243),f=r(244),p=r(266),d=n.getLogger();n.setLogHandler(l.createLogger()),n.setLogLevel(n.LogLevel.INFO);var y=!1;e.exports={logging:l,errorHandler:a,eventDispatcher:s,enums:u,setLogger:n.setLogHandler,setLogLevel:n.setLogLevel,createInstance:function(e){try{(e=e||{}).errorHandler&&n.setErrorHandler(e.errorHandler),e.logger&&(n.setLogHandler(e.logger),n.setLogLevel(n.LogLevel.NOTSET)),void 0!==e.logLevel&&n.setLogLevel(e.logLevel);try{i.validate(e),e.isValidInstance=!0}catch(t){d.error(t),e.isValidInstance=!1}var t;null==e.skipJSONValidation&&(e.skipJSONValidation=!0),null==e.eventDispatcher?(t=new c.LocalStoragePendingEventsDispatcher({eventDispatcher:s}),y||(t.sendPendingEvents(),y=!0)):t=e.eventDispatcher,e=o.assignIn({clientEngine:u.JAVASCRIPT_CLIENT_ENGINE,eventBatchSize:10,eventFlushInterval:1e3},e,{eventDispatcher:t,logger:d,errorHandler:n.getErrorHandler()}),p.validateEventBatchSize(e.eventBatchSize)||(d.warn("Invalid eventBatchSize %s, defaulting to %s",e.eventBatchSize,10),e.eventBatchSize=10),p.validateEventFlushInterval(e.eventFlushInterval)||(d.warn("Invalid eventFlushInterval %s, defaulting to %s",e.eventFlushInterval,1e3),e.eventFlushInterval=1e3);var r=new f(e);try{if("function"==typeof window.addEventListener){var a="onpagehide"in window?"pagehide":"unload";window.addEventListener(a,(function(){r.close()}),!1)}}catch(e){d.error(u.LOG_MESSAGES.UNABLE_TO_ATTACH_UNLOAD,"INDEX_BROWSER",e.message)}return r}catch(e){return d.error(e),null}},__internalResetRetryState:function(){y=!1}}},function(e,t,r){(function(e,t){(function(){"use strict";function r(e){var t=this.constructor;return this.then((function(r){return t.resolve(e()).then((function(){return r}))}),(function(r){return t.resolve(e()).then((function(){return t.reject(r)}))}))}var n=setTimeout;function o(){}function i(e){if(!(this instanceof i))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],f(e,this)}function a(e,t){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,i._immediateFn((function(){var r=1===e._state?t.onFulfilled:t.onRejected;if(null!==r){var n;try{n=r(e._value)}catch(e){return void u(t.promise,e)}s(t.promise,n)}else(1===e._state?s:u)(t.promise,e._value)}))):e._deferreds.push(t)}function s(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var r=t.then;if(t instanceof i)return e._state=3,e._value=t,void c(e);if("function"==typeof r)return void f((n=r,o=t,function(){n.apply(o,arguments)}),e)}e._state=1,e._value=t,c(e)}catch(t){u(e,t)}var n,o}function u(e,t){e._state=2,e._value=t,c(e)}function c(e){2===e._state&&0===e._deferreds.length&&i._immediateFn((function(){e._handled||i._unhandledRejectionFn(e._value)}));for(var t=0,r=e._deferreds.length;t<r;t++)a(e,e._deferreds[t]);e._deferreds=null}function l(e,t,r){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=r}function f(e,t){var r=!1;try{e((function(e){r||(r=!0,s(t,e))}),(function(e){r||(r=!0,u(t,e))}))}catch(e){if(r)return;r=!0,u(t,e)}}i.prototype.catch=function(e){return this.then(null,e)},i.prototype.then=function(e,t){var r=new this.constructor(o);return a(this,new l(e,t,r)),r},i.prototype.finally=r,i.all=function(e){return new i((function(t,r){if(!e||void 0===e.length)throw new TypeError("Promise.all accepts an array");var n=Array.prototype.slice.call(e);if(0===n.length)return t([]);var o=n.length;function i(e,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var s=a.then;if("function"==typeof s)return void s.call(a,(function(t){i(e,t)}),r)}n[e]=a,0==--o&&t(n)}catch(e){r(e)}}for(var a=0;a<n.length;a++)i(a,n[a])}))},i.resolve=function(e){return e&&"object"==typeof e&&e.constructor===i?e:new i((function(t){t(e)}))},i.reject=function(e){return new i((function(t,r){r(e)}))},i.race=function(e){return new i((function(t,r){for(var n=0,o=e.length;n<o;n++)e[n].then(t,r)}))},i._immediateFn="function"==typeof e&&function(t){e(t)}||function(e){n(e,0)},i._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)};var p=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==t)return t;throw new Error("unable to locate global object")}();"Promise"in p?p.Promise.prototype.finally||(p.Promise.prototype.finally=r):p.Promise=i})()}).call(this,r(117).setImmediate,r(21))},function(e,t,r){(function(e){var n=void 0!==e&&e||"undefined"!=typeof self&&self||window,o=Function.prototype.apply;function i(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new i(o.call(setTimeout,n,arguments),clearTimeout)},t.setInterval=function(){return new i(o.call(setInterval,n,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(n,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},r(118),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,r(21))},function(e,t,r){(function(e,t){!function(e,r){"use strict";if(!e.setImmediate){var n,o,i,a,s,u=1,c={},l=!1,f=e.document,p=Object.getPrototypeOf&&Object.getPrototypeOf(e);p=p&&p.setTimeout?p:e,"[object process]"==={}.toString.call(e.process)?n=function(e){t.nextTick((function(){y(e)}))}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,r=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=r,t}}()?e.MessageChannel?((i=new MessageChannel).port1.onmessage=function(e){y(e.data)},n=function(e){i.port2.postMessage(e)}):f&&"onreadystatechange"in f.createElement("script")?(o=f.documentElement,n=function(e){var t=f.createElement("script");t.onreadystatechange=function(){y(e),t.onreadystatechange=null,o.removeChild(t),t=null},o.appendChild(t)}):n=function(e){setTimeout(y,0,e)}:(a="setImmediate$"+Math.random()+"$",s=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(a)&&y(+t.data.slice(a.length))},e.addEventListener?e.addEventListener("message",s,!1):e.attachEvent("onmessage",s),n=function(t){e.postMessage(a+t,"*")}),p.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),r=0;r<t.length;r++)t[r]=arguments[r+1];var o={callback:e,args:t};return c[u]=o,n(u),u++},p.clearImmediate=d}function d(e){delete c[e]}function y(e){if(l)setTimeout(y,0,e);else{var t=c[e];if(t){l=!0;try{!function(e){var t=e.callback,r=e.args;switch(r.length){case 0:t();break;case 1:t(r[0]);break;case 2:t(r[0],r[1]);break;case 3:t(r[0],r[1],r[2]);break;default:t.apply(void 0,r)}}(t)}finally{d(e),l=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,r(21),r(119))},function(e,t){var r,n,o=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(r===setTimeout)return setTimeout(e,0);if((r===i||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:i}catch(e){r=i}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(e){n=a}}();var u,c=[],l=!1,f=-1;function p(){l&&u&&(l=!1,u.length?c=u.concat(c):f=-1,c.length&&d())}function d(){if(!l){var e=s(p);l=!0;for(var t=c.length;t;){for(u=c,c=[];++f<t;)u&&u[f].run();f=-1,t=c.length}u=null,l=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function y(e,t){this.fun=e,this.array=t}function g(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];c.push(new y(e,t)),1!==c.length||l||s(d)},y.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=g,o.addListener=g,o.once=g,o.off=g,o.removeListener=g,o.removeAllListeners=g,o.emit=g,o.prependListener=g,o.prependOnceListener=g,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(66),o=r(68),i=r(67),a={NOTSET:0,DEBUG:1,INFO:2,WARNING:3,ERROR:4};function s(e){return"string"!=typeof e?e:("WARN"===(e=e.toUpperCase())&&(e="WARNING"),a[e]?a[e]:e)}var u=function(){function e(){this.defaultLoggerFacade=new p,this.loggers={}}return e.prototype.getLogger=function(e){return e?(this.loggers[e]||(this.loggers[e]=new p({messagePrefix:e})),this.loggers[e]):this.defaultLoggerFacade},e}(),c=function(){function e(e){void 0===e&&(e={}),this.logLevel=i.LogLevel.NOTSET,void 0!==e.logLevel&&o.isValidEnum(i.LogLevel,e.logLevel)&&this.setLogLevel(e.logLevel),this.logToConsole=void 0===e.logToConsole||!!e.logToConsole,this.prefix=void 0!==e.prefix?e.prefix:"[OPTIMIZELY]"}return e.prototype.log=function(e,t){if(this.shouldLog(e)&&this.logToConsole){var r=this.prefix+" - "+this.getLogLevelName(e)+" "+this.getTime()+" "+t;this.consoleLog(e,[r])}},e.prototype.setLogLevel=function(e){e=s(e),o.isValidEnum(i.LogLevel,e)&&void 0!==e?this.logLevel=e:this.logLevel=i.LogLevel.ERROR},e.prototype.getTime=function(){return(new Date).toISOString()},e.prototype.shouldLog=function(e){return e>=this.logLevel},e.prototype.getLogLevelName=function(e){switch(e){case i.LogLevel.DEBUG:return"DEBUG";case i.LogLevel.INFO:return"INFO ";case i.LogLevel.WARNING:return"WARN ";case i.LogLevel.ERROR:return"ERROR";default:return"NOTSET"}},e.prototype.consoleLog=function(e,t){switch(e){case i.LogLevel.DEBUG:console.log.apply(console,t);break;case i.LogLevel.INFO:console.info.apply(console,t);break;case i.LogLevel.WARNING:console.warn.apply(console,t);break;case i.LogLevel.ERROR:console.error.apply(console,t);break;default:console.log.apply(console,t)}},e}();t.ConsoleLogHandler=c;var l=i.LogLevel.NOTSET,f=null,p=function(){function e(e){void 0===e&&(e={}),this.messagePrefix="",e.messagePrefix&&(this.messagePrefix=e.messagePrefix)}return e.prototype.log=function(e,t){this.internalLog(s(e),{message:t,splat:[]})},e.prototype.info=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this.namedLog(i.LogLevel.INFO,e,t)},e.prototype.debug=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this.namedLog(i.LogLevel.DEBUG,e,t)},e.prototype.warn=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this.namedLog(i.LogLevel.WARNING,e,t)},e.prototype.error=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this.namedLog(i.LogLevel.ERROR,e,t)},e.prototype.format=function(e){return(this.messagePrefix?this.messagePrefix+": ":"")+o.sprintf.apply(void 0,[e.message].concat(e.splat))},e.prototype.internalLog=function(e,t){f&&(e<l||(f.log(e,this.format(t)),t.error&&t.error instanceof Error&&n.getErrorHandler().handleError(t.error)))},e.prototype.namedLog=function(e,t,r){var n;if(t instanceof Error)return t=(n=t).message,void this.internalLog(e,{error:n,message:t,splat:r});if(0!==r.length){var o=r[r.length-1];o instanceof Error&&(n=o,r.splice(-1)),this.internalLog(e,{message:t,error:n,splat:r})}else this.internalLog(e,{message:t,splat:r})},e}(),d=new u;t.getLogger=function(e){return d.getLogger(e)},t.setLogHandler=function(e){f=e},t.setLogLevel=function(e){e=s(e),l=o.isValidEnum(i.LogLevel,e)&&void 0!==e?e:i.LogLevel.ERROR},t.getLogLevel=function(){return l},t.resetLogger=function(){d=new u,l=i.LogLevel.NOTSET}},function(e,t,r){var n,o,i=r(69),a=r(70),s=0,u=0;e.exports=function(e,t,r){var c=t&&r||0,l=t||[],f=(e=e||{}).node||n,p=void 0!==e.clockseq?e.clockseq:o;if(null==f||null==p){var d=i();null==f&&(f=n=[1|d[0],d[1],d[2],d[3],d[4],d[5]]),null==p&&(p=o=16383&(d[6]<<8|d[7]))}var y=void 0!==e.msecs?e.msecs:(new Date).getTime(),g=void 0!==e.nsecs?e.nsecs:u+1,v=y-s+(g-u)/1e4;if(v<0&&void 0===e.clockseq&&(p=p+1&16383),(v<0||y>s)&&void 0===e.nsecs&&(g=0),g>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");s=y,u=g,o=p;var h=(1e4*(268435455&(y+=122192928e5))+g)%4294967296;l[c++]=h>>>24&255,l[c++]=h>>>16&255,l[c++]=h>>>8&255,l[c++]=255&h;var E=y/4294967296*1e4&268435455;l[c++]=E>>>8&255,l[c++]=255&E,l[c++]=E>>>24&15|16,l[c++]=E>>>16&255,l[c++]=p>>>8|128,l[c++]=255&p;for(var _=0;_<6;++_)l[c+_]=f[_];return t||a(l)}},function(e,t,r){var n=r(69),o=r(70);e.exports=function(e,t,r){var i=t&&r||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||n)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var s=0;s<16;++s)t[i+s]=a[s];return t||o(a)}},function(e,t,r){var n=r(5).isFinite;e.exports=function(e){return"number"==typeof e&&n(e)}},function(e,t,r){var n=r(39),o=r(13),i=r(75),a=r(9),s=r(19),u=r(10),c=Object.prototype.hasOwnProperty,l=i((function(e,t){if(s(t)||a(t))o(t,u(t),e);else for(var r in t)c.call(t,r)&&n(e,r,t[r])}));e.exports=l},function(e,t,r){var n=r(73),o=r(128),i=r(8),a=r(74),s=/^\[object .+?Constructor\]$/,u=Function.prototype,c=Object.prototype,l=u.toString,f=c.hasOwnProperty,p=RegExp("^"+l.call(f).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!i(e)||o(e))&&(n(e)?p:s).test(a(e))}},function(e,t,r){var n=r(18),o=Object.prototype,i=o.hasOwnProperty,a=o.toString,s=n?n.toStringTag:void 0;e.exports=function(e){var t=i.call(e,s),r=e[s];try{e[s]=void 0;var n=!0}catch(e){}var o=a.call(e);return n&&(t?e[s]=r:delete e[s]),o}},function(e,t){var r=Object.prototype.toString;e.exports=function(e){return r.call(e)}},function(e,t,r){var n,o=r(129),i=(n=/[^.]+$/.exec(o&&o.keys&&o.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"";e.exports=function(e){return!!i&&i in e}},function(e,t,r){var n=r(5)["__core-js_shared__"];e.exports=n},function(e,t){e.exports=function(e,t){return null==e?void 0:e[t]}},function(e,t,r){var n=r(24),o=r(132),i=r(134);e.exports=function(e,t){return i(o(e,t,n),e+"")}},function(e,t,r){var n=r(133),o=Math.max;e.exports=function(e,t,r){return t=o(void 0===t?e.length-1:t,0),function(){for(var i=arguments,a=-1,s=o(i.length-t,0),u=Array(s);++a<s;)u[a]=i[t+a];a=-1;for(var c=Array(t+1);++a<t;)c[a]=i[a];return c[t]=r(u),n(e,this,c)}}},function(e,t){e.exports=function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}},function(e,t,r){var n=r(135),o=r(137)(n);e.exports=o},function(e,t,r){var n=r(136),o=r(72),i=r(24),a=o?function(e,t){return o(e,"toString",{configurable:!0,enumerable:!1,value:n(t),writable:!0})}:i;e.exports=a},function(e,t){e.exports=function(e){return function(){return e}}},function(e,t){var r=Date.now;e.exports=function(e){var t=0,n=0;return function(){var o=r(),i=16-(o-n);if(n=o,i>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}},function(e,t,r){var n=r(23),o=r(9),i=r(42),a=r(8);e.exports=function(e,t,r){if(!a(r))return!1;var s=typeof t;return!!("number"==s?o(r)&&i(t,r.length):"string"==s&&t in r)&&n(r[t],e)}},function(e,t){e.exports=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}},function(e,t,r){var n=r(12),o=r(6);e.exports=function(e){return o(e)&&"[object Arguments]"==n(e)}},function(e,t){e.exports=function(){return!1}},function(e,t,r){var n=r(12),o=r(41),i=r(6),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1,e.exports=function(e){return i(e)&&o(e.length)&&!!a[n(e)]}},function(e,t,r){var n=r(78)(Object.keys,Object);e.exports=n},function(e,t,r){var n=r(13),o=r(75),i=r(26),a=o((function(e,t){n(t,i(t),e)}));e.exports=a},function(e,t,r){var n=r(8),o=r(19),i=r(146),a=Object.prototype.hasOwnProperty;e.exports=function(e){if(!n(e))return i(e);var t=o(e),r=[];for(var s in e)("constructor"!=s||!t&&a.call(e,s))&&r.push(s);return r}},function(e,t){e.exports=function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}},function(e,t,r){var n=r(148);e.exports=function(e){return n(e,5)}},function(e,t,r){var n=r(48),o=r(79),i=r(39),a=r(171),s=r(172),u=r(173),c=r(174),l=r(175),f=r(176),p=r(85),d=r(177),y=r(20),g=r(182),v=r(183),h=r(188),E=r(1),_=r(25),m=r(190),I=r(8),O=r(192),b=r(10),R=r(26),T={};T["[object Arguments]"]=T["[object Array]"]=T["[object ArrayBuffer]"]=T["[object DataView]"]=T["[object Boolean]"]=T["[object Date]"]=T["[object Float32Array]"]=T["[object Float64Array]"]=T["[object Int8Array]"]=T["[object Int16Array]"]=T["[object Int32Array]"]=T["[object Map]"]=T["[object Number]"]=T["[object Object]"]=T["[object RegExp]"]=T["[object Set]"]=T["[object String]"]=T["[object Symbol]"]=T["[object Uint8Array]"]=T["[object Uint8ClampedArray]"]=T["[object Uint16Array]"]=T["[object Uint32Array]"]=!0,T["[object Error]"]=T["[object Function]"]=T["[object WeakMap]"]=!1,e.exports=function e(t,r,A,N,S,x){var P,L=1&r,U=2&r,j=4&r;if(A&&(P=S?A(t,N,S,x):A(t)),void 0!==P)return P;if(!I(t))return t;var w=E(t);if(w){if(P=g(t),!L)return c(t,P)}else{var D=y(t),C="[object Function]"==D||"[object GeneratorFunction]"==D;if(_(t))return u(t,L);if("[object Object]"==D||"[object Arguments]"==D||C&&!S){if(P=U||C?{}:h(t),!L)return U?f(t,s(P,t)):l(t,a(P,t))}else{if(!T[D])return S?t:{};P=v(t,D,L)}}x||(x=new n);var V=x.get(t);if(V)return V;x.set(t,P),O(t)?t.forEach((function(n){P.add(e(n,r,A,n,t,x))})):m(t)&&t.forEach((function(n,o){P.set(o,e(n,r,A,o,t,x))}));var F=w?void 0:(j?U?d:p:U?R:b)(t);return o(F||t,(function(n,o){F&&(n=t[o=n]),i(P,o,e(n,r,A,o,t,x))})),P}},function(e,t){e.exports=function(){this.__data__=[],this.size=0}},function(e,t,r){var n=r(28),o=Array.prototype.splice;e.exports=function(e){var t=this.__data__,r=n(t,e);return!(r<0)&&(r==t.length-1?t.pop():o.call(t,r,1),--this.size,!0)}},function(e,t,r){var n=r(28);e.exports=function(e){var t=this.__data__,r=n(t,e);return r<0?void 0:t[r][1]}},function(e,t,r){var n=r(28);e.exports=function(e){return n(this.__data__,e)>-1}},function(e,t,r){var n=r(28);e.exports=function(e,t){var r=this.__data__,o=n(r,e);return o<0?(++this.size,r.push([e,t])):r[o][1]=t,this}},function(e,t,r){var n=r(27);e.exports=function(){this.__data__=new n,this.size=0}},function(e,t){e.exports=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}},function(e,t){e.exports=function(e){return this.__data__.get(e)}},function(e,t){e.exports=function(e){return this.__data__.has(e)}},function(e,t,r){var n=r(27),o=r(49),i=r(50);e.exports=function(e,t){var r=this.__data__;if(r instanceof n){var a=r.__data__;if(!o||a.length<199)return a.push([e,t]),this.size=++r.size,this;r=this.__data__=new i(a)}return r.set(e,t),this.size=r.size,this}},function(e,t,r){var n=r(160),o=r(27),i=r(49);e.exports=function(){this.size=0,this.__data__={hash:new n,map:new(i||o),string:new n}}},function(e,t,r){var n=r(161),o=r(162),i=r(163),a=r(164),s=r(165);function u(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}u.prototype.clear=n,u.prototype.delete=o,u.prototype.get=i,u.prototype.has=a,u.prototype.set=s,e.exports=u},function(e,t,r){var n=r(29);e.exports=function(){this.__data__=n?n(null):{},this.size=0}},function(e,t){e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},function(e,t,r){var n=r(29),o=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(n){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return o.call(t,e)?t[e]:void 0}},function(e,t,r){var n=r(29),o=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return n?void 0!==t[e]:o.call(t,e)}},function(e,t,r){var n=r(29);e.exports=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=n&&void 0===t?"__lodash_hash_undefined__":t,this}},function(e,t,r){var n=r(30);e.exports=function(e){var t=n(this,e).delete(e);return this.size-=t?1:0,t}},function(e,t){e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},function(e,t,r){var n=r(30);e.exports=function(e){return n(this,e).get(e)}},function(e,t,r){var n=r(30);e.exports=function(e){return n(this,e).has(e)}},function(e,t,r){var n=r(30);e.exports=function(e,t){var r=n(this,e),o=r.size;return r.set(e,t),this.size+=r.size==o?0:1,this}},function(e,t,r){var n=r(13),o=r(10);e.exports=function(e,t){return e&&n(t,o(t),e)}},function(e,t,r){var n=r(13),o=r(26);e.exports=function(e,t){return e&&n(t,o(t),e)}},function(e,t,r){(function(e){var n=r(5),o=t&&!t.nodeType&&t,i=o&&"object"==typeof e&&e&&!e.nodeType&&e,a=i&&i.exports===o?n.Buffer:void 0,s=a?a.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var r=e.length,n=s?s(r):new e.constructor(r);return e.copy(n),n}}).call(this,r(44)(e))},function(e,t){e.exports=function(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}},function(e,t,r){var n=r(13),o=r(51);e.exports=function(e,t){return n(e,o(e),t)}},function(e,t,r){var n=r(13),o=r(82);e.exports=function(e,t){return n(e,o(e),t)}},function(e,t,r){var n=r(86),o=r(82),i=r(26);e.exports=function(e){return n(e,i,o)}},function(e,t,r){var n=r(7)(r(5),"DataView");e.exports=n},function(e,t,r){var n=r(7)(r(5),"Promise");e.exports=n},function(e,t,r){var n=r(7)(r(5),"Set");e.exports=n},function(e,t,r){var n=r(7)(r(5),"WeakMap");e.exports=n},function(e,t){var r=Object.prototype.hasOwnProperty;e.exports=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&r.call(e,"index")&&(n.index=e.index,n.input=e.input),n}},function(e,t,r){var n=r(52),o=r(184),i=r(185),a=r(186),s=r(187);e.exports=function(e,t,r){var u=e.constructor;switch(t){case"[object ArrayBuffer]":return n(e);case"[object Boolean]":case"[object Date]":return new u(+e);case"[object DataView]":return o(e,r);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return s(e,r);case"[object Map]":return new u;case"[object Number]":case"[object String]":return new u(e);case"[object RegExp]":return i(e);case"[object Set]":return new u;case"[object Symbol]":return a(e)}}},function(e,t,r){var n=r(52);e.exports=function(e,t){var r=t?n(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}},function(e,t){var r=/\w*$/;e.exports=function(e){var t=new e.constructor(e.source,r.exec(e));return t.lastIndex=e.lastIndex,t}},function(e,t,r){var n=r(18),o=n?n.prototype:void 0,i=o?o.valueOf:void 0;e.exports=function(e){return i?Object(i.call(e)):{}}},function(e,t,r){var n=r(52);e.exports=function(e,t){var r=t?n(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}},function(e,t,r){var n=r(189),o=r(84),i=r(19);e.exports=function(e){return"function"!=typeof e.constructor||i(e)?{}:n(o(e))}},function(e,t,r){var n=r(8),o=Object.create,i=function(){function e(){}return function(t){if(!n(t))return{};if(o)return o(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();e.exports=i},function(e,t,r){var n=r(191),o=r(46),i=r(47),a=i&&i.isMap,s=a?o(a):n;e.exports=s},function(e,t,r){var n=r(20),o=r(6);e.exports=function(e){return o(e)&&"[object Map]"==n(e)}},function(e,t,r){var n=r(193),o=r(46),i=r(47),a=i&&i.isSet,s=a?o(a):n;e.exports=s},function(e,t,r){var n=r(20),o=r(6);e.exports=function(e){return o(e)&&"[object Set]"==n(e)}},function(e,t,r){var n=r(77),o=r(20),i=r(43),a=r(1),s=r(9),u=r(25),c=r(19),l=r(45),f=Object.prototype.hasOwnProperty;e.exports=function(e){if(null==e)return!0;if(s(e)&&(a(e)||"string"==typeof e||"function"==typeof e.splice||u(e)||l(e)||i(e)))return!e.length;var t=o(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(c(e))return!n(e).length;for(var r in e)if(f.call(e,r))return!1;return!0}},function(e,t,r){var n=r(40),o=r(196)((function(e,t,r){n(e,r,t)}));e.exports=o},function(e,t,r){var n=r(197),o=r(198),i=r(53),a=r(1);e.exports=function(e,t){return function(r,s){var u=a(r)?n:o,c=t?t():{};return u(r,e,i(s,2),c)}}},function(e,t){e.exports=function(e,t,r,n){for(var o=-1,i=null==e?0:e.length;++o<i;){var a=e[o];t(n,a,r(a),e)}return n}},function(e,t,r){var n=r(31);e.exports=function(e,t,r,o){return n(e,(function(e,n,i){t(o,e,r(e),i)})),o}},function(e,t,r){var n=r(200)();e.exports=n},function(e,t){e.exports=function(e){return function(t,r,n){for(var o=-1,i=Object(t),a=n(t),s=a.length;s--;){var u=a[e?s:++o];if(!1===r(i[u],u,i))break}return t}}},function(e,t,r){var n=r(9);e.exports=function(e,t){return function(r,o){if(null==r)return r;if(!n(r))return e(r,o);for(var i=r.length,a=t?i:-1,s=Object(r);(t?a--:++a<i)&&!1!==o(s[a],a,s););return r}}},function(e,t,r){var n=r(203),o=r(214),i=r(92);e.exports=function(e){var t=o(e);return 1==t.length&&t[0][2]?i(t[0][0],t[0][1]):function(r){return r===e||n(r,e,t)}}},function(e,t,r){var n=r(48),o=r(89);e.exports=function(e,t,r,i){var a=r.length,s=a,u=!i;if(null==e)return!s;for(e=Object(e);a--;){var c=r[a];if(u&&c[2]?c[1]!==e[c[0]]:!(c[0]in e))return!1}for(;++a<s;){var l=(c=r[a])[0],f=e[l],p=c[1];if(u&&c[2]){if(void 0===f&&!(l in e))return!1}else{var d=new n;if(i)var y=i(f,p,l,e,t,d);if(!(void 0===y?o(p,f,3,i,d):y))return!1}}return!0}},function(e,t,r){var n=r(48),o=r(90),i=r(210),a=r(213),s=r(20),u=r(1),c=r(25),l=r(45),f="[object Object]",p=Object.prototype.hasOwnProperty;e.exports=function(e,t,r,d,y,g){var v=u(e),h=u(t),E=v?"[object Array]":s(e),_=h?"[object Array]":s(t),m=(E="[object Arguments]"==E?f:E)==f,I=(_="[object Arguments]"==_?f:_)==f,O=E==_;if(O&&c(e)){if(!c(t))return!1;v=!0,m=!1}if(O&&!m)return g||(g=new n),v||l(e)?o(e,t,r,d,y,g):i(e,t,E,r,d,y,g);if(!(1&r)){var b=m&&p.call(e,"__wrapped__"),R=I&&p.call(t,"__wrapped__");if(b||R){var T=b?e.value():e,A=R?t.value():t;return g||(g=new n),y(T,A,r,d,g)}}return!!O&&(g||(g=new n),a(e,t,r,d,y,g))}},function(e,t,r){var n=r(50),o=r(206),i=r(207);function a(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new n;++t<r;)this.add(e[t])}a.prototype.add=a.prototype.push=o,a.prototype.has=i,e.exports=a},function(e,t){e.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},function(e,t){e.exports=function(e){return this.__data__.has(e)}},function(e,t){e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}},function(e,t){e.exports=function(e,t){return e.has(t)}},function(e,t,r){var n=r(18),o=r(87),i=r(23),a=r(90),s=r(211),u=r(212),c=n?n.prototype:void 0,l=c?c.valueOf:void 0;e.exports=function(e,t,r,n,c,f,p){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!f(new o(e),new o(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return i(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var d=s;case"[object Set]":var y=1&n;if(d||(d=u),e.size!=t.size&&!y)return!1;var g=p.get(e);if(g)return g==t;n|=2,p.set(e,t);var v=a(d(e),d(t),n,c,f,p);return p.delete(e),v;case"[object Symbol]":if(l)return l.call(e)==l.call(t)}return!1}},function(e,t){e.exports=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r}},function(e,t){e.exports=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}},function(e,t,r){var n=r(85),o=Object.prototype.hasOwnProperty;e.exports=function(e,t,r,i,a,s){var u=1&r,c=n(e),l=c.length;if(l!=n(t).length&&!u)return!1;for(var f=l;f--;){var p=c[f];if(!(u?p in t:o.call(t,p)))return!1}var d=s.get(e),y=s.get(t);if(d&&y)return d==t&&y==e;var g=!0;s.set(e,t),s.set(t,e);for(var v=u;++f<l;){var h=e[p=c[f]],E=t[p];if(i)var _=u?i(E,h,p,t,e,s):i(h,E,p,e,t,s);if(!(void 0===_?h===E||a(h,E,r,i,s):_)){g=!1;break}v||(v="constructor"==p)}if(g&&!v){var m=e.constructor,I=t.constructor;m==I||!("constructor"in e)||!("constructor"in t)||"function"==typeof m&&m instanceof m&&"function"==typeof I&&I instanceof I||(g=!1)}return s.delete(e),s.delete(t),g}},function(e,t,r){var n=r(91),o=r(10);e.exports=function(e){for(var t=o(e),r=t.length;r--;){var i=t[r],a=e[i];t[r]=[i,a,n(a)]}return t}},function(e,t,r){var n=r(89),o=r(216),i=r(222),a=r(54),s=r(91),u=r(92),c=r(32);e.exports=function(e,t){return a(e)&&s(t)?u(c(e),t):function(r){var a=o(r,e);return void 0===a&&a===t?i(r,e):n(t,a,3)}}},function(e,t,r){var n=r(93);e.exports=function(e,t,r){var o=null==e?void 0:n(e,t);return void 0===o?r:o}},function(e,t,r){var n=r(218),o=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,i=/\\(\\)?/g,a=n((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(o,(function(e,r,n,o){t.push(n?o.replace(i,"$1"):r||e)})),t}));e.exports=a},function(e,t,r){var n=r(219);e.exports=function(e){var t=n(e,(function(e){return 500===r.size&&r.clear(),e})),r=t.cache;return t}},function(e,t,r){var n=r(50);function o(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var r=function(){var n=arguments,o=t?t.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var a=e.apply(this,n);return r.cache=i.set(o,a)||i,a};return r.cache=new(o.Cache||n),r}o.Cache=n,e.exports=o},function(e,t,r){var n=r(221);e.exports=function(e){return null==e?"":n(e)}},function(e,t,r){var n=r(18),o=r(56),i=r(1),a=r(55),s=n?n.prototype:void 0,u=s?s.toString:void 0;e.exports=function e(t){if("string"==typeof t)return t;if(i(t))return o(t,e)+"";if(a(t))return u?u.call(t):"";var r=t+"";return"0"==r&&1/t==-1/0?"-0":r}},function(e,t,r){var n=r(223),o=r(224);e.exports=function(e,t){return null!=e&&o(e,t,n)}},function(e,t){e.exports=function(e,t){return null!=e&&t in Object(e)}},function(e,t,r){var n=r(94),o=r(43),i=r(1),a=r(42),s=r(41),u=r(32);e.exports=function(e,t,r){for(var c=-1,l=(t=n(t,e)).length,f=!1;++c<l;){var p=u(t[c]);if(!(f=null!=e&&r(e,p)))break;e=e[p]}return f||++c!=l?f:!!(l=null==e?0:e.length)&&s(l)&&a(p,l)&&(i(e)||o(e))}},function(e,t,r){var n=r(226),o=r(227),i=r(54),a=r(32);e.exports=function(e){return i(e)?n(a(e)):o(e)}},function(e,t){e.exports=function(e){return function(t){return null==t?void 0:t[e]}}},function(e,t,r){var n=r(93);e.exports=function(e){return function(t){return n(t,e)}}},function(e,t,r){var n=r(80),o=r(229),i=r(53),a=r(1);e.exports=function(e,t){return(a(e)?n:o)(e,i(t,3))}},function(e,t,r){var n=r(31);e.exports=function(e,t){var r=[];return n(e,(function(e,n,o){t(e,n,o)&&r.push(e)})),r}},function(e,t,r){var n=r(79),o=r(31),i=r(95),a=r(1);e.exports=function(e,t){return(a(e)?n:o)(e,i(t))}},function(e,t,r){var n=r(56),o=r(53),i=r(232),a=r(1);e.exports=function(e,t){return(a(e)?n:i)(e,o(t,3))}},function(e,t,r){var n=r(31),o=r(9);e.exports=function(e,t){var r=-1,i=o(e)?Array(e.length):[];return n(e,(function(e,n,o){i[++r]=t(e,n,o)})),i}},function(e,t,r){var n=r(234),o=r(10);e.exports=function(e){return null==e?[]:n(e,o(e))}},function(e,t,r){var n=r(56);e.exports=function(e,t){return n(t,(function(t){return e[t]}))}},function(e,t,r){var n=r(12),o=r(6);e.exports=function(e){return"number"==typeof e||o(e)&&"[object Number]"==n(e)}},function(e,t){e.exports={handleError:function(){}}},function(e,t,r){var n=r(3);e.exports={dispatchEvent:function(e,t){var r,n=e.url,i=e.params;"POST"===e.httpVerb?((r=new XMLHttpRequest).open("POST",n,!0),r.setRequestHeader("Content-Type","application/json"),r.onreadystatechange=function(){if(4===r.readyState&&t&&"function"==typeof t)try{t(i)}catch(e){}},r.send(JSON.stringify(i))):(n+="?wxhr=true",i&&(n+="&"+o(i)),(r=new XMLHttpRequest).open("GET",n,!0),r.onreadystatechange=function(){if(4===r.readyState&&t&&"function"==typeof t)try{t()}catch(e){}},r.send())}};var o=function(e){return n.map(e,(function(e,t){return encodeURIComponent(t)+"="+encodeURIComponent(e)})).join("&")}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(4).getLogger("EventProcessor"),o=function(){function e(e){var t=e.timeout,r=e.callback;this.timeout=Math.max(t,0),this.callback=r}return e.prototype.start=function(){this.timeoutId=setTimeout(this.callback,this.timeout)},e.prototype.refresh=function(){this.stop(),this.start()},e.prototype.stop=function(){this.timeoutId&&clearTimeout(this.timeoutId)},e}(),i=function(){function e(e){var t=e.sink;this.sink=t}return e.prototype.start=function(){},e.prototype.stop=function(){return Promise.resolve()},e.prototype.enqueue=function(e){this.sink([e])},e}();t.SingleEventQueue=i;var a=function(){function e(e){var t=e.flushInterval,r=e.maxQueueSize,n=e.sink,i=e.batchComparator;this.buffer=[],this.maxQueueSize=Math.max(r,1),this.sink=n,this.batchComparator=i,this.timer=new o({callback:this.flush.bind(this),timeout:t}),this.started=!1}return e.prototype.start=function(){this.started=!0},e.prototype.stop=function(){this.started=!1;var e=this.sink(this.buffer);return this.buffer=[],this.timer.stop(),e},e.prototype.enqueue=function(e){if(this.started){var t=this.buffer[0];t&&!this.batchComparator(t,e)&&this.flush(),0===this.buffer.length&&this.timer.refresh(),this.buffer.push(e),this.buffer.length>=this.maxQueueSize&&this.flush()}else n.warn("Queue is stopped, not accepting event")},e.prototype.flush=function(){this.sink(this.buffer),this.buffer=[],this.timer.stop()},e}();t.DefaultEventQueue=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.reqsInFlightCount=0,this.reqsCompleteResolvers=[]}return e.prototype.trackRequest=function(e){var t=this;this.reqsInFlightCount++;var r=function(){t.reqsInFlightCount--,0===t.reqsInFlightCount&&(t.reqsCompleteResolvers.forEach((function(e){return e()})),t.reqsCompleteResolvers=[])};e.then(r,r)},e.prototype.onRequestsComplete=function(){var e=this;return new Promise((function(t){0===e.reqsInFlightCount?t():e.reqsCompleteResolvers.push(t)}))},e}();t.default=n},function(e,t,r){"use strict";var n,o=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var i=r(4),a=r(241),s=r(58),u=i.getLogger("EventProcessor"),c=function(){function e(e){var t=e.eventDispatcher,r=e.store;this.dispatcher=t,this.store=r}return e.prototype.dispatchEvent=function(e,t){this.send({uuid:s.generateUUID(),timestamp:s.getTimestamp(),request:e},t)},e.prototype.sendPendingEvents=function(){var e=this,t=this.store.values();u.debug("Sending %s pending events from previous page",t.length),t.forEach((function(t){try{e.send(t,(function(){}))}catch(e){}}))},e.prototype.send=function(e,t){var r=this;this.store.set(e.uuid,e),this.dispatcher.dispatchEvent(e.request,(function(n){r.store.remove(e.uuid),t(n)}))},e}();t.PendingEventsDispatcher=c;var l=function(e){function t(t){var r=t.eventDispatcher;return e.call(this,{eventDispatcher:r,store:new a.LocalStorageStore({maxValues:100,key:"fs_optly_pending_events"})})||this}return o(t,e),t}(c);t.LocalStoragePendingEventsDispatcher=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(58),o=r(4).getLogger("EventProcessor"),i=function(){function e(e){var t=e.key,r=e.maxValues,n=void 0===r?1e3:r;this.LS_KEY=t,this.maxValues=n}return e.prototype.get=function(e){return this.getMap()[e]||null},e.prototype.set=function(e,t){var r=this.getMap();r[e]=t,this.replace(r)},e.prototype.remove=function(e){var t=this.getMap();delete t[e],this.replace(t)},e.prototype.values=function(){return n.objectValues(this.getMap())},e.prototype.clear=function(){this.replace({})},e.prototype.replace=function(e){try{window.localStorage&&localStorage.setItem(this.LS_KEY,JSON.stringify(e)),this.clean()}catch(e){o.error(e)}},e.prototype.clean=function(){var e=this.getMap(),t=Object.keys(e),r=t.length-this.maxValues;if(!(r<1)){var n=t.map((function(t){return{key:t,value:e[t]}}));n.sort((function(e,t){return e.value.timestamp-t.value.timestamp}));for(var o=0;o<r;o++)delete e[n[o].key];this.replace(e)}},e.prototype.getMap=function(){try{var e=window.localStorage&&localStorage.getItem(this.LS_KEY);if(e)return JSON.parse(e)||{}}catch(e){o.error(e)}return{}},e}();t.LocalStorageStore=i},function(e,t,r){"use strict";var n,o=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var i=r(99),a=r(100),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.formatEvents=function(e){return{url:"https://logx.optimizely.com/v1/events",httpVerb:"POST",params:a.makeBatchedEventV1(e)}},t}(i.AbstractEventProcessor);t.LogTierV1EventProcessor=s},function(e,t,r){var n=r(4);function o(){}o.prototype.log=function(){},e.exports={createLogger:function(e){return new n.ConsoleLogHandler(e)},createNoOpLogger:function(){return new o}}},function(e,t,r){var n=r(3),o=r(59),i=r(245),a=r(0),s=r(252),u=r(253),c=r(97),l=r(254),f=r(255),p=r(14),d=r(2).sprintf,y=r(256),g=r(101),v=r(257),h=a.ERROR_MESSAGES,E=a.LOG_LEVEL,_=a.LOG_MESSAGES,m=a.DECISION_SOURCES,I=a.FEATURE_VARIABLE_TYPES,O=a.DECISION_NOTIFICATION_TYPES,b=a.NOTIFICATION_TYPES;function R(e){var t=e.clientEngine;-1===a.VALID_CLIENT_ENGINES.indexOf(t)&&(e.logger.log(E.INFO,d(_.INVALID_CLIENT_ENGINE,"OPTIMIZELY",t)),t=a.NODE_CLIENT_ENGINE),this.clientEngine=t,this.clientVersion=e.clientVersion||a.NODE_CLIENT_VERSION,this.errorHandler=e.errorHandler,this.eventDispatcher=e.eventDispatcher,this.__isOptimizelyConfigValid=e.isValidInstance,this.logger=e.logger,this.projectConfigManager=new v.ProjectConfigManager({datafile:e.datafile,datafileOptions:e.datafileOptions,jsonSchemaValidator:e.jsonSchemaValidator,sdkKey:e.sdkKey,skipJSONValidation:e.skipJSONValidation}),this.__disposeOnUpdate=this.projectConfigManager.onUpdate(function(e){this.logger.log(E.INFO,d(_.UPDATED_OPTIMIZELY_CONFIG,"OPTIMIZELY",e.revision,e.projectId)),this.notificationCenter.sendNotifications(b.OPTIMIZELY_CONFIG_UPDATE)}.bind(this)),this.__readyPromise=this.projectConfigManager.onReady();var r=null;if(e.userProfileService)try{y.validate(e.userProfileService)&&(r=e.userProfileService,this.logger.log(E.INFO,d(_.VALID_USER_PROFILE_SERVICE,"OPTIMIZELY")))}catch(e){this.logger.log(E.WARNING,e.message)}this.decisionService=i.createDecisionService({userProfileService:r,logger:this.logger,UNSTABLE_conditionEvaluators:e.UNSTABLE_conditionEvaluators}),this.notificationCenter=f.createNotificationCenter({logger:this.logger,errorHandler:this.errorHandler}),this.eventProcessor=new c.LogTierV1EventProcessor({dispatcher:this.eventDispatcher,flushInterval:e.eventFlushInterval,maxQueueSize:e.eventBatchSize,notificationCenter:this.notificationCenter}),this.eventProcessor.start(),this.__readyTimeouts={},this.__nextReadyTimeoutId=0}R.prototype.__isValidInstance=function(){return this.__isOptimizelyConfigValid&&this.projectConfigManager.getConfig()},R.prototype.activate=function(e,t,r){try{if(!this.__isValidInstance())return this.logger.log(E.ERROR,d(_.INVALID_OBJECT,"OPTIMIZELY","activate")),null;if(!this.__validateInputs({experiment_key:e,user_id:t},r))return this.__notActivatingExperiment(e,t);var n=this.projectConfigManager.getConfig();if(!n)return null;try{var o=this.getVariation(e,t,r);if(null===o)return this.__notActivatingExperiment(e,t);if(!p.isRunning(n,e)){var i=d(_.SHOULD_NOT_DISPATCH_ACTIVATE,"OPTIMIZELY",e);return this.logger.log(E.DEBUG,i),o}return this._sendImpressionEvent(e,o,t,r),o}catch(r){this.logger.log(E.ERROR,r.message);var a=d(_.NOT_ACTIVATING_USER,"OPTIMIZELY",t,e);return this.logger.log(E.INFO,a),this.errorHandler.handleError(r),null}}catch(e){return this.logger.log(E.ERROR,e.message),this.errorHandler.handleError(e),null}},R.prototype._sendImpressionEvent=function(e,t,r,n){var o=this.projectConfigManager.getConfig();if(o){var i=u.buildImpressionEvent({experimentKey:e,variationKey:t,userId:r,userAttributes:n,clientEngine:this.clientEngine,clientVersion:this.clientVersion,configObj:o});this.eventProcessor.process(i),this.__emitNotificationCenterActivate(e,t,r,n)}},R.prototype.__emitNotificationCenterActivate=function(e,t,r,n){var o=this.projectConfigManager.getConfig();if(o){var i,a=p.getVariationIdFromExperimentAndVariationKey(o,e,t),u=p.getExperimentId(o,e),c={attributes:n,clientEngine:this.clientEngine,clientVersion:this.clientVersion,configObj:o,experimentId:u,userId:r,variationId:a,logger:this.logger},l=s.getImpressionEvent(c),f=o.experimentKeyMap[e];f&&f.variationKeyMap&&(i=f.variationKeyMap[t]),this.notificationCenter.sendNotifications(b.ACTIVATE,{experiment:f,userId:r,attributes:n,variation:i,logEvent:l})}},R.prototype.track=function(e,t,r,n){try{if(!this.__isValidInstance())return void this.logger.log(E.ERROR,d(_.INVALID_OBJECT,"OPTIMIZELY","track"));if(!this.__validateInputs({user_id:t,event_key:e},r,n))return;var o=this.projectConfigManager.getConfig();if(!o)return;if(!p.eventWithKeyExists(o,e))throw new Error(d(h.INVALID_EVENT_KEY,"OPTIMIZELY",e));n=this.__filterEmptyValues(n);var i=u.buildConversionEvent({eventKey:e,eventTags:n,userId:t,userAttributes:r,clientEngine:this.clientEngine,clientVersion:this.clientVersion,configObj:o});this.logger.log(E.INFO,d(a.LOG_MESSAGES.TRACK_EVENT,"OPTIMIZELY",e,t)),this.eventProcessor.process(i),this.__emitNotificationCenterTrack(e,t,r,n)}catch(e){this.logger.log(E.ERROR,e.message),this.errorHandler.handleError(e);var s=d(_.NOT_TRACKING_USER,"OPTIMIZELY",t);this.logger.log(E.INFO,s)}},R.prototype.__emitNotificationCenterTrack=function(e,t,r,n){try{var o=this.projectConfigManager.getConfig();if(!o)return;var i={attributes:r,clientEngine:this.clientEngine,clientVersion:this.clientVersion,configObj:o,eventKey:e,eventTags:n,logger:this.logger,userId:t},a=s.getConversionEvent(i);this.notificationCenter.sendNotifications(b.TRACK,{eventKey:e,userId:t,attributes:r,eventTags:n,logEvent:a})}catch(e){this.logger.log(E.ERROR,e.message),this.errorHandler.handleError(e)}},R.prototype.getVariation=function(e,t,r){try{if(!this.__isValidInstance())return this.logger.log(E.ERROR,d(_.INVALID_OBJECT,"OPTIMIZELY","getVariation")),null;try{if(!this.__validateInputs({experiment_key:e,user_id:t},r))return null;var o=this.projectConfigManager.getConfig();if(!o)return null;var i=o.experimentKeyMap[e];if(n.isEmpty(i))return this.logger.log(E.DEBUG,d(h.INVALID_EXPERIMENT_KEY,"OPTIMIZELY",e)),null;var a=this.decisionService.getVariation(o,e,t,r),s=p.isFeatureExperiment(o,i.id)?O.FEATURE_TEST:O.AB_TEST;return this.notificationCenter.sendNotifications(b.DECISION,{type:s,userId:t,attributes:r||{},decisionInfo:{experimentKey:e,variationKey:a}}),a}catch(e){return this.logger.log(E.ERROR,e.message),this.errorHandler.handleError(e),null}}catch(e){return this.logger.log(E.ERROR,e.message),this.errorHandler.handleError(e),null}},R.prototype.setForcedVariation=function(e,t,r){if(!this.__validateInputs({experiment_key:e,user_id:t}))return!1;var n=this.projectConfigManager.getConfig();if(!n)return!1;try{return this.decisionService.setForcedVariation(n,e,t,r)}catch(e){return this.logger.log(E.ERROR,e.message),this.errorHandler.handleError(e),!1}},R.prototype.getForcedVariation=function(e,t){if(!this.__validateInputs({experiment_key:e,user_id:t}))return null;var r=this.projectConfigManager.getConfig();if(!r)return null;try{return this.decisionService.getForcedVariation(r,e,t)}catch(e){return this.logger.log(E.ERROR,e.message),this.errorHandler.handleError(e),null}},R.prototype.__validateInputs=function(e,t,r){try{if(e.hasOwnProperty("user_id")){var n=e.user_id;if("string"!=typeof n||null===n||"undefined"===n)throw new Error(d(h.INVALID_INPUT_FORMAT,"OPTIMIZELY","user_id"));delete e.user_id}for(var i=Object.keys(e),a=0;a<i.length;a++){var s=i[a];if(!g.validate(e[s]))throw new Error(d(h.INVALID_INPUT_FORMAT,"OPTIMIZELY",s))}return t&&o.validate(t),r&&l.validate(r),!0}catch(e){return this.logger.log(E.ERROR,e.message),this.errorHandler.handleError(e),!1}},R.prototype.__notActivatingExperiment=function(e,t){var r=d(_.NOT_ACTIVATING_USER,"OPTIMIZELY",t,e);return this.logger.log(E.INFO,r),null},R.prototype.__filterEmptyValues=function(e){for(var t in e)!e.hasOwnProperty(t)||null!==e[t]&&void 0!==e[t]||delete e[t];return e},R.prototype.isFeatureEnabled=function(e,t,r){try{if(!this.__isValidInstance())return this.logger.log(E.ERROR,d(_.INVALID_OBJECT,"OPTIMIZELY","isFeatureEnabled")),!1;if(!this.__validateInputs({feature_key:e,user_id:t},r))return!1;var n=this.projectConfigManager.getConfig();if(!n)return!1;var o=p.getFeatureFromKey(n,e,this.logger);if(!o)return!1;var i=!1,a=this.decisionService.getVariationForFeature(n,o,t,r),s=a.variation,u={};s&&(i=s.featureEnabled,a.decisionSource===m.FEATURE_TEST&&(u={experimentKey:a.experiment.key,variationKey:a.variation.key},this._sendImpressionEvent(a.experiment.key,a.variation.key,t,r))),!0===i?this.logger.log(E.INFO,d(_.FEATURE_ENABLED_FOR_USER,"OPTIMIZELY",e,t)):(this.logger.log(E.INFO,d(_.FEATURE_NOT_ENABLED_FOR_USER,"OPTIMIZELY",e,t)),i=!1);var c={featureKey:e,featureEnabled:i,source:a.decisionSource,sourceInfo:u};return this.notificationCenter.sendNotifications(b.DECISION,{type:O.FEATURE,userId:t,attributes:r||{},decisionInfo:c}),i}catch(e){return this.logger.log(E.ERROR,e.message),this.errorHandler.handleError(e),!1}},R.prototype.getEnabledFeatures=function(e,t){try{var r=[];if(!this.__isValidInstance())return this.logger.log(E.ERROR,d(_.INVALID_OBJECT,"OPTIMIZELY","getEnabledFeatures")),r;if(!this.__validateInputs({user_id:e}))return r;var o=this.projectConfigManager.getConfig();return o?(n.forOwn(o.featureKeyMap,function(n){this.isFeatureEnabled(n.key,e,t)&&r.push(n.key)}.bind(this)),r):r}catch(e){return this.logger.log(E.ERROR,e.message),this.errorHandler.handleError(e),[]}},R.prototype.getFeatureVariable=function(e,t,r,n){try{return this._getFeatureVariableForType(e,t,null,r,n)}catch(e){return this.logger.log(E.ERROR,e.message),this.errorHandler.handleError(e),null}},R.prototype._getFeatureVariableForType=function(e,t,r,n,o){if(!this.__isValidInstance()){var i=r?"getFeatureVariable"+r.charAt(0).toUpperCase()+r.slice(1):"getFeatureVariable";return this.logger.log(E.ERROR,d(_.INVALID_OBJECT,"OPTIMIZELY",i)),null}if(!this.__validateInputs({feature_key:e,variable_key:t,user_id:n},o))return null;var a=this.projectConfigManager.getConfig();if(!a)return null;var s=p.getFeatureFromKey(a,e,this.logger);if(!s)return null;var u=p.getVariableForFeature(a,e,t,this.logger);if(!u)return null;if(r){if(u.type!==r)return this.logger.log(E.WARNING,d(_.VARIABLE_REQUESTED_WITH_WRONG_TYPE,"OPTIMIZELY",r,u.type)),null}else r=u.type;var c=!1,l=u.defaultValue,f=this.decisionService.getVariationForFeature(a,s,n,o);if(null!==f.variation){c=f.variation.featureEnabled;var y=p.getVariableValueForVariation(a,u,f.variation,this.logger);null!==y?!0===c?(l=y,this.logger.log(E.INFO,d(_.USER_RECEIVED_VARIABLE_VALUE,"OPTIMIZELY",t,s.key,l,n))):this.logger.log(E.INFO,d(_.FEATURE_NOT_ENABLED_RETURN_DEFAULT_VARIABLE_VALUE,"OPTIMIZELY",s.key,n,t)):this.logger.log(E.INFO,d(_.VARIABLE_NOT_USED_RETURN_DEFAULT_VARIABLE_VALUE,"OPTIMIZELY",t,f.variation.key))}else this.logger.log(E.INFO,d(_.USER_RECEIVED_DEFAULT_VARIABLE_VALUE,"OPTIMIZELY",n,t,s.key));var g={};f.decisionSource===m.FEATURE_TEST&&(g={experimentKey:f.experiment.key,variationKey:f.variation.key});var v=p.getTypeCastValue(l,r,this.logger);return this.notificationCenter.sendNotifications(b.DECISION,{type:O.FEATURE_VARIABLE,userId:n,attributes:o||{},decisionInfo:{featureKey:e,featureEnabled:c,source:f.decisionSource,variableKey:t,variableValue:v,variableType:r,sourceInfo:g}}),v},R.prototype.getFeatureVariableBoolean=function(e,t,r,n){try{return this._getFeatureVariableForType(e,t,I.BOOLEAN,r,n)}catch(e){return this.logger.log(E.ERROR,e.message),this.errorHandler.handleError(e),null}},R.prototype.getFeatureVariableDouble=function(e,t,r,n){try{return this._getFeatureVariableForType(e,t,I.DOUBLE,r,n)}catch(e){return this.logger.log(E.ERROR,e.message),this.errorHandler.handleError(e),null}},R.prototype.getFeatureVariableInteger=function(e,t,r,n){try{return this._getFeatureVariableForType(e,t,I.INTEGER,r,n)}catch(e){return this.logger.log(E.ERROR,e.message),this.errorHandler.handleError(e),null}},R.prototype.getFeatureVariableString=function(e,t,r,n){try{return this._getFeatureVariableForType(e,t,I.STRING,r,n)}catch(e){return this.logger.log(E.ERROR,e.message),this.errorHandler.handleError(e),null}},R.prototype.getOptimizelyConfig=function(){try{return this.projectConfigManager.getConfig()?this.projectConfigManager.getOptimizelyConfig():null}catch(e){return this.logger.log(E.ERROR,e.message),this.errorHandler.handleError(e),null}},R.prototype.close=function(){try{var e=this.eventProcessor.stop();return this.__disposeOnUpdate&&(this.__disposeOnUpdate(),this.__disposeOnUpdate=null),this.projectConfigManager&&this.projectConfigManager.stop(),Object.keys(this.__readyTimeouts).forEach(function(e){var t=this.__readyTimeouts[e];clearTimeout(t.readyTimeout),t.onClose()}.bind(this)),this.__readyTimeouts={},e.then((function(){return{success:!0}}),(function(e){return{success:!1,reason:String(e)}}))}catch(e){return this.logger.log(E.ERROR,e.message),this.errorHandler.handleError(e),Promise.resolve({success:!1,reason:String(e)})}},R.prototype.onReady=function(e){var t,r;"object"==typeof e&&null!==e&&(t=e.timeout),n.isFinite(t)||(t=3e4);var o=new Promise((function(e){r=e})),i=this.__nextReadyTimeoutId;this.__nextReadyTimeoutId++;var a=function(){delete this.__readyTimeouts[i],r({success:!1,reason:d("onReady timeout expired after %s ms",t)})}.bind(this),s=setTimeout(a,t);return this.__readyTimeouts[i]={readyTimeout:s,onClose:function(){r({success:!1,reason:"Instance closed"})}},this.__readyPromise.then(function(){clearTimeout(s),delete this.__readyTimeouts[i],r({success:!0})}.bind(this)),Promise.race([this.__readyPromise,o])},e.exports=R},function(e,t,r){var n=r(246),o=r(249),i=r(0),a=r(3),s=r(14),u=r(101),c=r(2).sprintf,l="DECISION_SERVICE",f=i.ERROR_MESSAGES,p=i.LOG_LEVEL,d=i.LOG_MESSAGES,y=i.DECISION_SOURCES;function g(e){this.audienceEvaluator=new n(e.UNSTABLE_conditionEvaluators),this.forcedVariationMap={},this.logger=e.logger,this.userProfileService=e.userProfileService||null}g.prototype.getVariation=function(e,t,r,n){var i=this._getBucketingId(r,n);if(!this.__checkIfExperimentIsActive(e,t))return null;var a=e.experimentKeyMap[t],s=this.getForcedVariation(e,t,r);if(s)return s;var u=this.__getWhitelistedVariation(a,r);if(u)return u.key;var f=this.__resolveExperimentBucketMap(r,n);if(u=this.__getStoredVariation(e,a,r,f))return this.logger.log(p.INFO,c(d.RETURNING_STORED_VARIATION,l,u.key,t,r)),u.key;if(!this.__checkIfUserIsInAudience(e,t,r,n))return null;var y=this.__buildBucketerParams(e,t,i,r),g=o.bucket(y);return(u=e.variationIdMap[g])?(this.__saveUserProfile(a,u,r,f),u.key):null},g.prototype.__resolveExperimentBucketMap=function(e,t){t=t||{};var r=this.__getUserProfile(e)||{},n=t[i.CONTROL_ATTRIBUTES.STICKY_BUCKETING_KEY];return a.assignIn({},r.experiment_bucket_map,n)},g.prototype.__checkIfExperimentIsActive=function(e,t){if(!s.isActive(e,t)){var r=c(d.EXPERIMENT_NOT_RUNNING,l,t);return this.logger.log(p.INFO,r),!1}return!0},g.prototype.__getWhitelistedVariation=function(e,t){if(!a.isEmpty(e.forcedVariations)&&e.forcedVariations.hasOwnProperty(t)){var r=e.forcedVariations[t];if(e.variationKeyMap.hasOwnProperty(r)){var n=c(d.USER_FORCED_IN_VARIATION,l,t,r);return this.logger.log(p.INFO,n),e.variationKeyMap[r]}var o=c(d.FORCED_BUCKETING_FAILED,l,r,t);return this.logger.log(p.ERROR,o),null}return null},g.prototype.__checkIfUserIsInAudience=function(e,t,r,n){var o=s.getExperimentAudienceConditions(e,t),i=s.getAudiencesById(e);this.logger.log(p.DEBUG,c(d.EVALUATING_AUDIENCES_COMBINED,l,t,JSON.stringify(o)));var a=this.audienceEvaluator.evaluate(o,i,n);if(this.logger.log(p.INFO,c(d.AUDIENCE_EVALUATION_RESULT_COMBINED,l,t,a.toString().toUpperCase())),!a){var u=c(d.USER_NOT_IN_EXPERIMENT,l,r,t);return this.logger.log(p.INFO,u),!1}return!0},g.prototype.__buildBucketerParams=function(e,t,r,n){var o={};return o.experimentKey=t,o.experimentId=s.getExperimentId(e,t),o.userId=n,o.trafficAllocationConfig=s.getTrafficAllocation(e,t),o.experimentKeyMap=e.experimentKeyMap,o.groupIdMap=e.groupIdMap,o.variationIdMap=e.variationIdMap,o.logger=this.logger,o.bucketingId=r,o},g.prototype.__getStoredVariation=function(e,t,r,n){if(n.hasOwnProperty(t.id)){var o=n[t.id],i=o.variation_id;if(e.variationIdMap.hasOwnProperty(i))return e.variationIdMap[o.variation_id];this.logger.log(p.INFO,c(d.SAVED_VARIATION_NOT_FOUND,l,r,i,t.key))}return null},g.prototype.__getUserProfile=function(e){var t={user_id:e,experiment_bucket_map:{}};if(!this.userProfileService)return t;try{return this.userProfileService.lookup(e)}catch(t){this.logger.log(p.ERROR,c(f.USER_PROFILE_LOOKUP_ERROR,l,e,t.message))}},g.prototype.__saveUserProfile=function(e,t,r,n){if(this.userProfileService)try{var o=a.cloneDeep(n);o[e.id]={variation_id:t.id},this.userProfileService.save({user_id:r,experiment_bucket_map:o}),this.logger.log(p.INFO,c(d.SAVED_VARIATION,l,t.key,e.key,r))}catch(e){this.logger.log(p.ERROR,c(f.USER_PROFILE_SAVE_ERROR,l,r,e.message))}},g.prototype.getVariationForFeature=function(e,t,r,n){var o=this._getVariationForFeatureExperiment(e,t,r,n);if(null!==o.variation)return this.logger.log(p.DEBUG,c(d.USER_IN_FEATURE_EXPERIMENT,l,r,o.variation.key,o.experiment.key,t.key)),o;this.logger.log(p.DEBUG,c(d.USER_NOT_IN_FEATURE_EXPERIMENT,l,r,t.key));var i=this._getVariationForRollout(e,t,r,n);return null!==i.variation?(this.logger.log(p.DEBUG,c(d.USER_IN_ROLLOUT,l,r,t.key)),i):(this.logger.log(p.DEBUG,c(d.USER_NOT_IN_ROLLOUT,l,r,t.key)),i)},g.prototype._getVariationForFeatureExperiment=function(e,t,r,n){var o=null,i=null;if(t.hasOwnProperty("groupId")){var a=e.groupIdMap[t.groupId];a&&(o=this._getExperimentInGroup(e,a,r))&&-1!==t.experimentIds.indexOf(o.id)&&(i=this.getVariation(e,o.key,r,n))}else t.experimentIds.length>0?(o=s.getExperimentFromId(e,t.experimentIds[0],this.logger))&&(i=this.getVariation(e,o.key,r,n)):this.logger.log(p.DEBUG,c(d.FEATURE_HAS_NO_EXPERIMENTS,l,t.key));var u=null;return null!==i&&null!==o&&(u=o.variationKeyMap[i]),{experiment:o,variation:u,decisionSource:y.FEATURE_TEST}},g.prototype._getExperimentInGroup=function(e,t,r){var n=o.bucketUserIntoExperiment(t,r,r,this.logger);if(n){this.logger.log(p.INFO,c(d.USER_BUCKETED_INTO_EXPERIMENT_IN_GROUP,l,r,n,t.id));var i=s.getExperimentFromId(e,n,this.logger);if(i)return i}return this.logger.log(p.INFO,c(d.USER_NOT_BUCKETED_INTO_ANY_EXPERIMENT_IN_GROUP,l,r,t.id)),null},g.prototype._getVariationForRollout=function(e,t,r,n){if(!t.rolloutId)return this.logger.log(p.DEBUG,c(d.NO_ROLLOUT_EXISTS,l,t.key)),{experiment:null,variation:null,decisionSource:y.ROLLOUT};var i=e.rolloutIdMap[t.rolloutId];if(!i)return this.logger.log(p.ERROR,c(f.INVALID_ROLLOUT_ID,l,t.rolloutId,t.key)),{experiment:null,variation:null,decisionSource:y.ROLLOUT};if(0===i.experiments.length)return this.logger.log(p.ERROR,c(d.ROLLOUT_HAS_NO_EXPERIMENTS,l,t.rolloutId)),{experiment:null,variation:null,decisionSource:y.ROLLOUT};var a,s,u,g,v,h=this._getBucketingId(r,n),E=i.experiments.length-1;for(a=0;a<E;a++){if(s=e.experimentKeyMap[i.experiments[a].key],this.__checkIfUserIsInAudience(e,s.key,r,n)){if(this.logger.log(p.DEBUG,c(d.USER_MEETS_CONDITIONS_FOR_TARGETING_RULE,l,r,a+1)),u=this.__buildBucketerParams(e,s.key,h,r),g=o.bucket(u),v=e.variationIdMap[g])return this.logger.log(p.DEBUG,c(d.USER_BUCKETED_INTO_TARGETING_RULE,l,r,a+1)),{experiment:s,variation:v,decisionSource:y.ROLLOUT};this.logger.log(p.DEBUG,c(d.USER_NOT_BUCKETED_INTO_TARGETING_RULE,l,r,a+1));break}this.logger.log(p.DEBUG,c(d.USER_DOESNT_MEET_CONDITIONS_FOR_TARGETING_RULE,l,r,a+1))}var _=e.experimentKeyMap[i.experiments[E].key];if(this.__checkIfUserIsInAudience(e,_.key,r,n)){if(u=this.__buildBucketerParams(e,_.key,h,r),g=o.bucket(u),v=e.variationIdMap[g])return this.logger.log(p.DEBUG,c(d.USER_BUCKETED_INTO_EVERYONE_TARGETING_RULE,l,r)),{experiment:_,variation:v,decisionSource:y.ROLLOUT};this.logger.log(p.DEBUG,c(d.USER_NOT_BUCKETED_INTO_EVERYONE_TARGETING_RULE,l,r))}return{experiment:null,variation:null,decisionSource:y.ROLLOUT}},g.prototype._getBucketingId=function(e,t){var r=e;return null!=t&&"object"==typeof t&&t.hasOwnProperty(i.CONTROL_ATTRIBUTES.BUCKETING_ID)&&("string"==typeof t[i.CONTROL_ATTRIBUTES.BUCKETING_ID]?(r=t[i.CONTROL_ATTRIBUTES.BUCKETING_ID],this.logger.log(p.DEBUG,c(d.VALID_BUCKETING_ID,l,r))):this.logger.log(p.WARNING,c(d.BUCKETING_ID_NOT_STRING,l))),r},g.prototype.removeForcedVariation=function(e,t,r){if(!e)throw new Error(c(f.INVALID_USER_ID,l));if(!this.forcedVariationMap.hasOwnProperty(e))throw new Error(c(f.USER_NOT_IN_FORCED_VARIATION,l,e));delete this.forcedVariationMap[e][t],this.logger.log(p.DEBUG,c(d.VARIATION_REMOVED_FOR_USER,l,r,e))},g.prototype.__setInForcedVariationMap=function(e,t,r){this.forcedVariationMap.hasOwnProperty(e)||(this.forcedVariationMap[e]={}),this.forcedVariationMap[e][t]=r,this.logger.log(p.DEBUG,c(d.USER_MAPPED_TO_FORCED_VARIATION,l,r,t,e))},g.prototype.getForcedVariation=function(e,t,r){var n,o=this.forcedVariationMap[r];if(!o)return this.logger.log(p.DEBUG,c(d.USER_HAS_NO_FORCED_VARIATION,l,r)),null;try{var i=s.getExperimentFromKey(e,t);if(!i.hasOwnProperty("id"))return this.logger.log(p.ERROR,c(f.IMPROPERLY_FORMATTED_EXPERIMENT,l,t)),null;n=i.id}catch(e){return this.logger.log(p.ERROR,e.message),null}var a=o[n];if(!a)return this.logger.log(p.DEBUG,c(d.USER_HAS_NO_FORCED_VARIATION_FOR_EXPERIMENT,l,t,r)),null;var u=s.getVariationKeyFromId(e,a);return u?this.logger.log(p.DEBUG,c(d.USER_HAS_FORCED_VARIATION,l,u,t,r)):this.logger.log(p.DEBUG,c(d.USER_HAS_NO_FORCED_VARIATION_FOR_EXPERIMENT,l,t,r)),u},g.prototype.setForcedVariation=function(e,t,r,n){if(null!=n&&!u.validate(n))return this.logger.log(p.ERROR,c(f.INVALID_VARIATION_KEY,l)),!1;var o;try{var i=s.getExperimentFromKey(e,t);if(!i.hasOwnProperty("id"))return this.logger.log(p.ERROR,c(f.IMPROPERLY_FORMATTED_EXPERIMENT,l,t)),!1;o=i.id}catch(e){return this.logger.log(p.ERROR,e.message),!1}if(null==n)try{return this.removeForcedVariation(r,o,t,this.logger),!0}catch(e){return this.logger.log(p.ERROR,e.message),!1}var a=s.getVariationIdFromExperimentAndVariationKey(e,t,n);if(!a)return this.logger.log(p.ERROR,c(f.NO_VARIATION_FOR_EXPERIMENT_KEY,l,n,t)),!1;try{return this.__setInForcedVariationMap(r,o,a),!0}catch(e){return this.logger.log(p.ERROR,e.message),!1}},e.exports={createDecisionService:function(e){return new g(e)}}},function(e,t,r){var n=r(247),o=r(248),i=r(0),a=r(3),s=r(2).sprintf,u=r(4).getLogger(),c=i.ERROR_MESSAGES,l=i.LOG_LEVEL,f=i.LOG_MESSAGES,p="AUDIENCE_EVALUATOR";function d(e){this.typeToEvaluatorMap=a.assignIn({},e,{custom_attribute:o})}d.prototype.evaluate=function(e,t,r){if(!e||0===e.length)return!0;r||(r={});var o=function(e){var o=t[e];if(o){u.log(l.DEBUG,s(f.EVALUATING_AUDIENCE,p,e,JSON.stringify(o.conditions)));var i=n.evaluate(o.conditions,this.evaluateConditionWithUserAttributes.bind(this,r)),a=null===i?"UNKNOWN":i.toString().toUpperCase();return u.log(l.INFO,s(f.AUDIENCE_EVALUATION_RESULT,p,e,a)),i}return null}.bind(this);return n.evaluate(e,o)||!1},d.prototype.evaluateConditionWithUserAttributes=function(e,t){var r=this.typeToEvaluatorMap[t.type];if(!r)return u.log(l.WARNING,s(f.UNKNOWN_CONDITION_TYPE,p,JSON.stringify(t))),null;try{return r.evaluate(t,e,u)}catch(e){u.log(l.ERROR,s(c.CONDITION_EVALUATOR_ERROR,p,t.type,e.message))}return null},e.exports=d},function(e,t){var r=["and","or","not"];function n(e,t){if(Array.isArray(e)){var o=e[0],i=e.slice(1);switch(-1===r.indexOf(o)&&(o="or",i=e),o){case"and":return function(e,t){for(var r=!1,o=0;o<e.length;o++){var i=n(e[o],t);if(!1===i)return!1;null===i&&(r=!0)}return!r||null}(i,t);case"not":return function(e,t){if(e.length>0){var r=n(e[0],t);return null===r?null:!r}return null}(i,t);default:return function(e,t){for(var r=!1,o=0;o<e.length;o++){var i=n(e[o],t);if(!0===i)return!0;null===i&&(r=!0)}return!!r&&null}(i,t)}}return t(e)}e.exports={evaluate:n}},function(e,t,r){var n=r(3),o=r(0),i=r(2).sprintf,a=o.LOG_LEVEL,s=o.LOG_MESSAGES,u="CUSTOM_ATTRIBUTE_CONDITION_EVALUATOR",c=["exact","exists","gt","lt","substring"],l={};function f(e){return"string"==typeof e||"boolean"==typeof e||n.isNumber(e)}function p(e,t,r){var o=e.value,c=typeof o,l=e.name,p=t[l],d=typeof p;return!f(o)||n.isNumber(o)&&!n.isFinite(o)?(r.log(a.WARNING,i(s.UNEXPECTED_CONDITION_VALUE,u,JSON.stringify(e))),null):null===p?(r.log(a.DEBUG,i(s.UNEXPECTED_TYPE_NULL,u,JSON.stringify(e),l)),null):f(p)&&c===d?n.isNumber(p)&&!n.isFinite(p)?(r.log(a.WARNING,i(s.OUT_OF_BOUNDS,u,JSON.stringify(e),l)),null):o===p:(r.log(a.WARNING,i(s.UNEXPECTED_TYPE,u,JSON.stringify(e),d,l)),null)}l.exact=p,l.exists=function(e,t){var r=t[e.name];return null!=r},l.gt=function(e,t,r){var o=e.name,c=t[o],l=typeof c,f=e.value;if(!n.isFinite(f))return r.log(a.WARNING,i(s.UNEXPECTED_CONDITION_VALUE,u,JSON.stringify(e))),null;if(null===c)return r.log(a.DEBUG,i(s.UNEXPECTED_TYPE_NULL,u,JSON.stringify(e),o)),null;if(!n.isNumber(c))return r.log(a.WARNING,i(s.UNEXPECTED_TYPE,u,JSON.stringify(e),l,o)),null;if(!n.isFinite(c))return r.log(a.WARNING,i(s.OUT_OF_BOUNDS,u,JSON.stringify(e),o)),null;return c>f},l.lt=function(e,t,r){var o=e.name,c=t[e.name],l=typeof c,f=e.value;if(!n.isFinite(f))return r.log(a.WARNING,i(s.UNEXPECTED_CONDITION_VALUE,u,JSON.stringify(e))),null;if(null===c)return r.log(a.DEBUG,i(s.UNEXPECTED_TYPE_NULL,u,JSON.stringify(e),o)),null;if(!n.isNumber(c))return r.log(a.WARNING,i(s.UNEXPECTED_TYPE,u,JSON.stringify(e),l,o)),null;if(!n.isFinite(c))return r.log(a.WARNING,i(s.OUT_OF_BOUNDS,u,JSON.stringify(e),o)),null;return c<f},l.substring=function(e,t,r){var n=e.name,o=t[e.name],c=typeof o,l=e.value;if("string"!=typeof l)return r.log(a.WARNING,i(s.UNEXPECTED_CONDITION_VALUE,u,JSON.stringify(e))),null;if(null===o)return r.log(a.DEBUG,i(s.UNEXPECTED_TYPE_NULL,u,JSON.stringify(e),n)),null;if("string"!=typeof o)return r.log(a.WARNING,i(s.UNEXPECTED_TYPE,u,JSON.stringify(e),c,n)),null;return-1!==o.indexOf(l)},e.exports={evaluate:function(e,t,r){var n=e.match;if(void 0!==n&&-1===c.indexOf(n))return r.log(a.WARNING,i(s.UNKNOWN_MATCH_TYPE,u,JSON.stringify(e))),null;var o=e.name;return t.hasOwnProperty(o)||"exists"==n?(l[n]||p)(e,t,r):(r.log(a.DEBUG,i(s.MISSING_ATTRIBUTE_VALUE,u,JSON.stringify(e),o)),null)}}},function(e,t,r){var n=r(0),o=r(250),i=r(2).sprintf,a=n.ERROR_MESSAGES,s=n.LOG_LEVEL,u=n.LOG_MESSAGES,c=Math.pow(2,32);e.exports={bucket:function(t){var r=t.experimentKeyMap[t.experimentKey].groupId;if(r){var n=t.groupIdMap[r];if(!n)throw new Error(i(a.INVALID_GROUP_ID,"BUCKETER",r));if("random"===n.policy){var o=e.exports.bucketUserIntoExperiment(n,t.bucketingId,t.userId,t.logger);if(null===o){var c=i(u.USER_NOT_IN_ANY_EXPERIMENT,"BUCKETER",t.userId,r);return t.logger.log(s.INFO,c),null}if(o!==t.experimentId){var l=i(u.USER_NOT_BUCKETED_INTO_EXPERIMENT_IN_GROUP,"BUCKETER",t.userId,t.experimentKey,r);return t.logger.log(s.INFO,l),null}var f=i(u.USER_BUCKETED_INTO_EXPERIMENT_IN_GROUP,"BUCKETER",t.userId,t.experimentKey,r);t.logger.log(s.INFO,f)}}var p=i("%s%s",t.bucketingId,t.experimentId),d=e.exports._generateBucketValue(p),y=i(u.USER_ASSIGNED_TO_VARIATION_BUCKET,"BUCKETER",d,t.userId);t.logger.log(s.DEBUG,y);var g=e.exports._findBucket(d,t.trafficAllocationConfig);if(g){if(!t.variationIdMap.hasOwnProperty(g)){var v=i(u.INVALID_VARIATION_ID,"BUCKETER");return t.logger.log(s.WARNING,v),null}var h=t.variationIdMap[g].key,E=i(u.USER_HAS_VARIATION,"BUCKETER",t.userId,h,t.experimentKey);t.logger.log(s.INFO,E)}else{var _=i(u.USER_HAS_NO_VARIATION,"BUCKETER",t.userId,t.experimentKey);t.logger.log(s.DEBUG,_)}return g},bucketUserIntoExperiment:function(t,r,n,o){var a=i("%s%s",r,t.id),c=e.exports._generateBucketValue(a);o.log(s.DEBUG,i(u.USER_ASSIGNED_TO_EXPERIMENT_BUCKET,"BUCKETER",c,n));var l=t.trafficAllocation;return e.exports._findBucket(c,l)},_findBucket:function(e,t){for(var r=0;r<t.length;r++)if(e<t[r].endOfRange)return t[r].entityId;return null},_generateBucketValue:function(e){try{var t=o.v3(e,1);return parseInt(1e4*(t/c),10)}catch(t){throw new Error(i(a.INVALID_BUCKETING_ID,"BUCKETER",e,t.message))}}}},function(e,t,r){!function(){function t(e,t){var r,n,o,i,a,s,u,c;for(r=3&e.length,n=e.length-r,o=t,a=3432918353,s=461845907,c=0;c<n;)u=255&e.charCodeAt(c)|(255&e.charCodeAt(++c))<<8|(255&e.charCodeAt(++c))<<16|(255&e.charCodeAt(++c))<<24,++c,o=27492+(65535&(i=5*(65535&(o=(o^=u=(65535&(u=(u=(65535&u)*a+(((u>>>16)*a&65535)<<16)&4294967295)<<15|u>>>17))*s+(((u>>>16)*s&65535)<<16)&4294967295)<<13|o>>>19))+((5*(o>>>16)&65535)<<16)&4294967295))+((58964+(i>>>16)&65535)<<16);switch(u=0,r){case 3:u^=(255&e.charCodeAt(c+2))<<16;case 2:u^=(255&e.charCodeAt(c+1))<<8;case 1:o^=u=(65535&(u=(u=(65535&(u^=255&e.charCodeAt(c)))*a+(((u>>>16)*a&65535)<<16)&4294967295)<<15|u>>>17))*s+(((u>>>16)*s&65535)<<16)&4294967295}return o^=e.length,o=2246822507*(65535&(o^=o>>>16))+((2246822507*(o>>>16)&65535)<<16)&4294967295,o=3266489909*(65535&(o^=o>>>13))+((3266489909*(o>>>16)&65535)<<16)&4294967295,(o^=o>>>16)>>>0}var r=t;r.v2=function(e,t){for(var r,n=e.length,o=t^n,i=0;n>=4;)r=1540483477*(65535&(r=255&e.charCodeAt(i)|(255&e.charCodeAt(++i))<<8|(255&e.charCodeAt(++i))<<16|(255&e.charCodeAt(++i))<<24))+((1540483477*(r>>>16)&65535)<<16),o=1540483477*(65535&o)+((1540483477*(o>>>16)&65535)<<16)^(r=1540483477*(65535&(r^=r>>>24))+((1540483477*(r>>>16)&65535)<<16)),n-=4,++i;switch(n){case 3:o^=(255&e.charCodeAt(i+2))<<16;case 2:o^=(255&e.charCodeAt(i+1))<<8;case 1:o=1540483477*(65535&(o^=255&e.charCodeAt(i)))+((1540483477*(o>>>16)&65535)<<16)}return o=1540483477*(65535&(o^=o>>>13))+((1540483477*(o>>>16)&65535)<<16),(o^=o>>>15)>>>0},r.v3=t,e.exports=r}()},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{projectId:{type:"string",required:!0},accountId:{type:"string",required:!0},groups:{type:"array",items:{type:"object",properties:{id:{type:"string",required:!0},policy:{type:"string",required:!0},trafficAllocation:{type:"array",items:{type:"object",properties:{entityId:{type:"string",required:!0},endOfRange:{type:"integer",required:!0}}},required:!0},experiments:{type:"array",items:{type:"object",properties:{id:{type:"string",required:!0},key:{type:"string",required:!0},status:{type:"string",required:!0},layerId:{type:"string",required:!0},variations:{type:"array",items:{type:"object",properties:{id:{type:"string",required:!0},key:{type:"string",required:!0}}},required:!0},trafficAllocation:{type:"array",items:{type:"object",properties:{entityId:{type:"string",required:!0},endOfRange:{type:"integer",required:!0}}},required:!0},audienceIds:{type:"array",items:{type:"string"},required:!0},forcedVariations:{type:"object",required:!0}}},required:!0}}},required:!0},experiments:{type:"array",items:{type:"object",properties:{id:{type:"string",required:!0},key:{type:"string",required:!0},status:{type:"string",required:!0},layerId:{type:"string",required:!0},variations:{type:"array",items:{type:"object",properties:{id:{type:"string",required:!0},key:{type:"string",required:!0}}},required:!0},trafficAllocation:{type:"array",items:{type:"object",properties:{entityId:{type:"string",required:!0},endOfRange:{type:"integer",required:!0}}},required:!0},audienceIds:{type:"array",items:{type:"string"},required:!0},forcedVariations:{type:"object",required:!0}}},required:!0},events:{type:"array",items:{type:"object",properties:{key:{type:"string",required:!0},experimentIds:{type:"array",items:{type:"string",required:!0}},id:{type:"string",required:!0}}},required:!0},audiences:{type:"array",items:{type:"object",properties:{id:{type:"string",required:!0},name:{type:"string",required:!0},conditions:{type:"string",required:!0}}},required:!0},attributes:{type:"array",items:{type:"object",properties:{id:{type:"string",required:!0},key:{type:"string",required:!0}}},required:!0},version:{type:"string",required:!0},revision:{type:"string",required:!0}}}},function(e,t,r){var n=r(0),o=r(3),i=r(102),a=r(14),s=r(59),u="https://logx.optimizely.com/v1/events";function c(e){var t=e.attributes,r=e.configObj,i=r.anonymizeIP,u=r.botFiltering;null==i&&(i=!1);var c={snapshots:[],visitor_id:e.userId,attributes:[]},l={account_id:r.accountId,project_id:r.projectId,visitors:[c],revision:r.revision,client_name:e.clientEngine,client_version:e.clientVersion,anonymize_ip:i,enrich_decisions:!0};return o.forOwn(t,(function(r,n){if(s.isAttributeValid(n,r)){var o=a.getAttributeId(e.configObj,n,e.logger);o&&l.visitors[0].attributes.push({entity_id:o,key:n,type:"custom",value:t[n]})}})),"boolean"==typeof u&&l.visitors[0].attributes.push({entity_id:n.CONTROL_ATTRIBUTES.BOT_FILTERING,key:n.CONTROL_ATTRIBUTES.BOT_FILTERING,type:"custom",value:u}),l}e.exports={getImpressionEvent:function(e){var t={httpVerb:"POST"},r=c(e);t.url=u;var n,i,s,l=(n=e.configObj,i=e.experimentId,s=e.variationId,{decisions:[{campaign_id:a.getLayerId(n,i),experiment_id:i,variation_id:s}],events:[{entity_id:a.getLayerId(n,i),timestamp:o.currentTimestamp(),key:"campaign_activated",uuid:o.uuid()}]});return r.visitors[0].snapshots.push(l),t.params=r,t},getConversionEvent:function(e){var t={httpVerb:"POST"},r=c(e);t.url=u;var s=function(e,t,r,s){var u={events:[]},c={entity_id:a.getEventId(e,t),timestamp:o.currentTimestamp(),uuid:o.uuid(),key:t};if(r){var l=i.getRevenueValue(r,s);null!==l&&(c[n.RESERVED_EVENT_KEYWORDS.REVENUE]=l);var f=i.getEventValue(r,s);null!==f&&(c[n.RESERVED_EVENT_KEYWORDS.VALUE]=f),c.tags=r}return u.events.push(c),u}(e.configObj,e.eventKey,e.eventTags,e.logger);return r.visitors[0].snapshots=[s],t.params=r,t}}},function(e,t,r){var n=r(4),o=r(59),i=r(3),a=r(102),s=r(14),u=n.getLogger("EVENT_BUILDER");function c(e,t){var r=[];return i.forOwn(t,(function(n,i){if(o.isAttributeValid(i,n)){var a=s.getAttributeId(e,i,u);a&&r.push({entityId:a,key:i,value:t[i]})}})),r}t.buildImpressionEvent=function(e){var t=e.configObj,r=e.experimentKey,n=e.variationKey,o=e.userId,a=e.userAttributes,u=e.clientEngine,l=e.clientVersion,f=s.getVariationIdFromExperimentAndVariationKey(t,r,n),p=s.getExperimentId(t,r),d=s.getLayerId(t,p);return{type:"impression",timestamp:i.currentTimestamp(),uuid:i.uuid(),user:{id:o,attributes:c(t,a)},context:{accountId:t.accountId,projectId:t.projectId,revision:t.revision,clientName:u,clientVersion:l,anonymizeIP:t.anonymizeIP||!1,botFiltering:t.botFiltering},layer:{id:d},experiment:{id:p,key:r},variation:{id:f,key:n}}},t.buildConversionEvent=function(e){var t=e.configObj,r=e.userId,n=e.userAttributes,o=e.clientEngine,l=e.clientVersion,f=e.eventKey,p=e.eventTags,d=s.getEventId(t,f);return{type:"conversion",timestamp:i.currentTimestamp(),uuid:i.uuid(),user:{id:r,attributes:c(t,n)},context:{accountId:t.accountId,projectId:t.projectId,revision:t.revision,clientName:o,clientVersion:l,anonymizeIP:t.anonymizeIP||!1,botFiltering:t.botFiltering},event:{id:d,key:f},revenue:a.getRevenueValue(p,u),value:a.getEventValue(p,u),tags:p}}},function(e,t,r){var n=r(2).sprintf,o=r(0).ERROR_MESSAGES;e.exports={validate:function(e){if("object"!=typeof e||Array.isArray(e)||null===e)throw new Error(n(o.INVALID_EVENT_TAGS,"EVENT_TAGS_VALIDATOR"));return!0}}},function(e,t,r){var n=r(0),o=r(3),i=r(2).sprintf,a=n.LOG_LEVEL,s=n.LOG_MESSAGES;function u(e){this.logger=e.logger,this.errorHandler=e.errorHandler,this.__notificationListeners={},o.forOwn(n.NOTIFICATION_TYPES,function(e){this.__notificationListeners[e]=[]}.bind(this)),this.__listenerId=1}u.prototype.addNotificationListener=function(e,t){try{if(!(o.values(n.NOTIFICATION_TYPES).indexOf(e)>-1))return-1;this.__notificationListeners[e]||(this.__notificationListeners[e]=[]);var r=!1;if(o.forEach(this.__notificationListeners[e],(function(e){if(e.callback===t)return r=!0,!1})),r)return-1;this.__notificationListeners[e].push({id:this.__listenerId,callback:t});var i=this.__listenerId;return this.__listenerId+=1,i}catch(e){return this.logger.log(a.ERROR,e.message),this.errorHandler.handleError(e),-1}},u.prototype.removeNotificationListener=function(e){try{var t,r;if(o.forOwn(this.__notificationListeners,(function(n,i){if(o.forEach(n,(function(n,o){if(n.id===e)return t=o,r=i,!1})),void 0!==t&&void 0!==r)return!1})),void 0!==t&&void 0!==r)return this.__notificationListeners[r].splice(t,1),!0}catch(e){this.logger.log(a.ERROR,e.message),this.errorHandler.handleError(e)}return!1},u.prototype.clearAllNotificationListeners=function(){try{o.forOwn(n.NOTIFICATION_TYPES,function(e){this.__notificationListeners[e]=[]}.bind(this))}catch(e){this.logger.log(a.ERROR,e.message),this.errorHandler.handleError(e)}},u.prototype.clearNotificationListeners=function(e){try{this.__notificationListeners[e]=[]}catch(e){this.logger.log(a.ERROR,e.message),this.errorHandler.handleError(e)}},u.prototype.sendNotifications=function(e,t){try{o.forEach(this.__notificationListeners[e],function(r){var n=r.callback;try{n(t)}catch(t){this.logger.log(a.ERROR,i(s.NOTIFICATION_LISTENER_EXCEPTION,"NOTIFICATION_CENTER",e,t.message))}}.bind(this))}catch(e){this.logger.log(a.ERROR,e.message),this.errorHandler.handleError(e)}},e.exports={createNotificationCenter:function(e){return new u(e)}}},function(e,t,r){var n=r(2).sprintf,o=r(0).ERROR_MESSAGES;e.exports={validate:function(e){if("function"!=typeof e.lookup)throw new Error(n(o.INVALID_USER_PROFILE_SERVICE,"USER_PROFILE_SERVICE_VALIDATOR","Missing function 'lookup'"));if("function"!=typeof e.save)throw new Error(n(o.INVALID_USER_PROFILE_SERVICE,"USER_PROFILE_SERVICE_VALIDATOR","Missing function 'save'"));return!0}}},function(e,t,r){var n=r(3),o=r(2).sprintf,i=r(4),a=r(57),s=r(258),u=r(0),c=r(14),l=r(265),f=i.getLogger(),p=u.ERROR_MESSAGES;function d(e,t){return e instanceof Error?e.message:t||"Unknown error"}function y(e){try{this.__initialize(e)}catch(e){f.error(e),this.__updateListeners=[],this.__configObj=null,this.__optimizelyConfigObj=null,this.__readyPromise=Promise.resolve({success:!1,reason:d(e,"Error in initialize")})}}y.prototype.__initialize=function(e){if(this.__updateListeners=[],this.jsonSchemaValidator=e.jsonSchemaValidator,this.skipJSONValidation=e.skipJSONValidation,!e.datafile&&!e.sdkKey){this.__configObj=null;var t=new Error(o(p.DATAFILE_AND_SDK_KEY_MISSING,"PROJECT_CONFIG_MANAGER"));return this.__readyPromise=Promise.resolve({success:!1,reason:d(t)}),void f.error(t)}var r,i=this.__getDatafileFromConfig(e);if(i)try{this.__configObj=c.tryCreatingProjectConfig({datafile:i,jsonSchemaValidator:this.jsonSchemaValidator,logger:f,skipJSONValidation:this.skipJSONValidation}),this.__optimizelyConfigObj=l.getOptimizelyConfig(this.__configObj)}catch(e){f.error(e),r=e,this.__configObj=null}else this.__configObj=null;if(e.sdkKey){var a={sdkKey:e.sdkKey};this.__validateDatafileOptions(e.datafileOptions)&&n.assign(a,e.datafileOptions),i&&this.__configObj&&(a.datafile=i),this.datafileManager=new s.HttpPollingDatafileManager(a),this.datafileManager.start(),this.__readyPromise=this.datafileManager.onReady().then(this.__onDatafileManagerReadyFulfill.bind(this),this.__onDatafileManagerReadyReject.bind(this)),this.datafileManager.on("update",this.__onDatafileManagerUpdate.bind(this))}else this.__configObj?this.__readyPromise=Promise.resolve({success:!0}):this.__readyPromise=Promise.resolve({success:!1,reason:d(r,"Invalid datafile")})},y.prototype.__onDatafileManagerReadyFulfill=function(){var e,t=this.datafileManager.get();try{e=c.tryCreatingProjectConfig({datafile:t,jsonSchemaValidator:this.jsonSchemaValidator,logger:f,skipJSONValidation:this.skipJSONValidation})}catch(e){return f.error(e),{success:!1,reason:d(e)}}return this.__handleNewConfigObj(e),{success:!0}},y.prototype.__onDatafileManagerReadyReject=function(e){return{success:!1,reason:d(e,"Failed to become ready")}},y.prototype.__onDatafileManagerUpdate=function(){var e,t=this.datafileManager.get();try{e=c.tryCreatingProjectConfig({datafile:t,jsonSchemaValidator:this.jsonSchemaValidator,logger:f,skipJSONValidation:this.skipJSONValidation})}catch(e){f.error(e)}e&&this.__handleNewConfigObj(e)},y.prototype.__getDatafileFromConfig=function(e){var t=null;try{e.datafile&&(a.validateDatafile(e.datafile),t="string"==typeof e.datafile||e.datafile instanceof String?JSON.parse(e.datafile):e.datafile)}catch(e){f.error(e)}return t},y.prototype.__validateDatafileOptions=function(e){return void 0===e||"object"==typeof e&&null!==e},y.prototype.__handleNewConfigObj=function(e){var t=this.__configObj;(t?t.revision:"null")!==e.revision&&(this.__configObj=e,this.__optimizelyConfigObj=l.getOptimizelyConfig(e),this.__updateListeners.forEach((function(t){t(e)})))},y.prototype.getConfig=function(){return this.__configObj},y.prototype.getOptimizelyConfig=function(){return this.__optimizelyConfigObj},y.prototype.onReady=function(){return this.__readyPromise},y.prototype.onUpdate=function(e){return this.__updateListeners.push(e),function(){var t=this.__updateListeners.indexOf(e);t>-1&&this.__updateListeners.splice(t,1)}.bind(this)},y.prototype.stop=function(){this.datafileManager&&this.datafileManager.stop(),this.__updateListeners=[]},e.exports={ProjectConfigManager:y}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(259);t.HttpPollingDatafileManager=n.default;var o=r(264);t.StaticDatafileManager=o.default},function(e,t,r){"use strict";var n,o=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(260),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.makeGetRequest=function(e,t){return a.makeGetRequest(e,t)},t.prototype.getConfigDefaults=function(){return{autoUpdate:!1}},t}(i(r(261)).default);t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(60),o=r(4).getLogger("DatafileManager");t.makeGetRequest=function(e,t){var r=new XMLHttpRequest;return{responsePromise:new Promise((function(i,a){r.open("GET",e,!0),function(e,t){Object.keys(e).forEach((function(r){var n=e[r];t.setRequestHeader(r,n)}))}(t,r),r.onreadystatechange=function(){if(4===r.readyState){if(0===r.status)return void a(new Error("Request error"));var e=function(e){var t=e.getAllResponseHeaders();if(null===t)return{};var r=t.split("\r\n"),n={};return r.forEach((function(e){var t=e.indexOf(": ");if(t>-1){var r=e.slice(0,t),o=e.slice(t+2);o.length>0&&(n[r]=o)}})),n}(r),t={statusCode:r.status,body:r.responseText,headers:e};i(t)}},r.timeout=n.REQUEST_TIMEOUT_MS,r.ontimeout=function(){o.error("Request timed out")},r.send()})),abort:function(){r.abort()}}}},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(4),a=r(68),s=o(r(262)),u=r(60),c=o(r(263)),l=i.getLogger("DatafileManager");function f(e){return e>=200&&e<400}var p=function(){function e(e){var t=this,r=n({},this.getConfigDefaults(),e),o=r.datafile,i=r.autoUpdate,f=void 0!==i&&i,p=r.sdkKey,d=r.updateInterval,y=void 0===d?u.DEFAULT_UPDATE_INTERVAL:d,g=r.urlTemplate,v=void 0===g?u.DEFAULT_URL_TEMPLATE:g;this.isReadyPromiseSettled=!1,this.readyPromiseResolver=function(){},this.readyPromiseRejecter=function(){},this.readyPromise=new Promise((function(e,r){t.readyPromiseResolver=e,t.readyPromiseRejecter=r})),o?(this.currentDatafile=o,this.resolveReadyPromise()):this.currentDatafile=null,this.isStarted=!1,this.datafileUrl=a.sprintf(v,p),this.emitter=new s.default,this.autoUpdate=f,!function(e){return e>=u.MIN_UPDATE_INTERVAL}(y)?(l.warn("Invalid updateInterval %s, defaulting to %s",y,u.DEFAULT_UPDATE_INTERVAL),this.updateInterval=u.DEFAULT_UPDATE_INTERVAL):this.updateInterval=y,this.currentTimeout=null,this.currentRequest=null,this.backoffController=new c.default,this.syncOnCurrentRequestComplete=!1}return e.prototype.get=function(){return this.currentDatafile},e.prototype.start=function(){this.isStarted||(l.debug("Datafile manager started"),this.isStarted=!0,this.backoffController.reset(),this.syncDatafile())},e.prototype.stop=function(){return l.debug("Datafile manager stopped"),this.isStarted=!1,this.currentTimeout&&(clearTimeout(this.currentTimeout),this.currentTimeout=null),this.emitter.removeAllListeners(),this.currentRequest&&(this.currentRequest.abort(),this.currentRequest=null),Promise.resolve()},e.prototype.onReady=function(){return this.readyPromise},e.prototype.on=function(e,t){return this.emitter.on(e,t)},e.prototype.onRequestRejected=function(e){this.isStarted&&(this.backoffController.countError(),e instanceof Error?l.error("Error fetching datafile: %s",e.message,e):"string"==typeof e?l.error("Error fetching datafile: %s",e):l.error("Error fetching datafile"))},e.prototype.onRequestResolved=function(e){if(this.isStarted){void 0!==e.statusCode&&f(e.statusCode)?this.backoffController.reset():this.backoffController.countError(),this.trySavingLastModified(e.headers);var t=this.getNextDatafileFromResponse(e);if(null!==t)if(l.info("Updating datafile from response"),this.currentDatafile=t,this.isReadyPromiseSettled){var r={datafile:t};this.emitter.emit("update",r)}else this.resolveReadyPromise()}},e.prototype.onRequestComplete=function(){this.isStarted&&(this.currentRequest=null,this.isReadyPromiseSettled||this.autoUpdate||this.rejectReadyPromise(new Error("Failed to become ready")),this.autoUpdate&&this.syncOnCurrentRequestComplete&&this.syncDatafile(),this.syncOnCurrentRequestComplete=!1)},e.prototype.syncDatafile=function(){var e=this,t={};this.lastResponseLastModified&&(t["if-modified-since"]=this.lastResponseLastModified),l.debug("Making datafile request to url %s with headers: %s",this.datafileUrl,(function(){return JSON.stringify(t)})),this.currentRequest=this.makeGetRequest(this.datafileUrl,t);var r=function(){e.onRequestComplete()};this.currentRequest.responsePromise.then((function(t){e.onRequestResolved(t)}),(function(t){e.onRequestRejected(t)})).then(r,r),this.autoUpdate&&this.scheduleNextUpdate()},e.prototype.resolveReadyPromise=function(){this.readyPromiseResolver(),this.isReadyPromiseSettled=!0},e.prototype.rejectReadyPromise=function(e){this.readyPromiseRejecter(e),this.isReadyPromiseSettled=!0},e.prototype.scheduleNextUpdate=function(){var e=this,t=this.backoffController.getDelay(),r=Math.max(t,this.updateInterval);l.debug("Scheduling sync in %s ms",r),this.currentTimeout=setTimeout((function(){e.currentRequest?e.syncOnCurrentRequestComplete=!0:e.syncDatafile()}),r)},e.prototype.getNextDatafileFromResponse=function(e){return l.debug("Response status code: %s",e.statusCode),void 0===e.statusCode||304===e.statusCode?null:f(e.statusCode)?this.tryParsingBodyAsJSON(e.body):null},e.prototype.tryParsingBodyAsJSON=function(e){var t;try{t=JSON.parse(e)}catch(e){return l.error("Error parsing response body: %s",e.message,e),null}var r=null;return"object"==typeof t&&null!==t?r=t:l.error("Error parsing response body: was not an object"),r},e.prototype.trySavingLastModified=function(e){var t=e["last-modified"]||e["Last-Modified"];void 0!==t&&(this.lastResponseLastModified=t,l.debug("Saved last modified header value from response: %s",this.lastResponseLastModified))},e}();t.default=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.listeners={},this.listenerId=1}return e.prototype.on=function(e,t){var r=this;this.listeners[e]||(this.listeners[e]={});var n=String(this.listenerId);return this.listenerId++,this.listeners[e][n]=t,function(){r.listeners[e]&&delete r.listeners[e][n]}},e.prototype.emit=function(e,t){var r=this.listeners[e];r&&Object.keys(r).forEach((function(e){(0,r[e])(t)}))},e.prototype.removeAllListeners=function(){this.listeners={}},e}();t.default=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(60);var o=function(){function e(){this.errorCount=0}return e.prototype.getDelay=function(){return 0===this.errorCount?0:1e3*n.BACKOFF_BASE_WAIT_SECONDS_BY_ERROR_COUNT[Math.min(n.BACKOFF_BASE_WAIT_SECONDS_BY_ERROR_COUNT.length-1,this.errorCount)]+Math.round(1e3*Math.random())},e.prototype.countError=function(){this.errorCount<n.BACKOFF_BASE_WAIT_SECONDS_BY_ERROR_COUNT.length-1&&this.errorCount++},e.prototype.reset=function(){this.errorCount=0},e}();t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){},o=function(){function e(e){this.datafile=e,this.readyPromise=Promise.resolve()}return e.prototype.get=function(){return this.datafile},e.prototype.onReady=function(){return this.readyPromise},e.prototype.start=function(){},e.prototype.stop=function(){return Promise.resolve()},e.prototype.on=function(e,t){return n},e}();t.default=o},function(e,t,r){var n=r(14);function o(e,t,r,n){var o=e.experimentFeatureMap[r],i={};if(o){var a=n[o],s=(t.variables||[]).reduce((function(e,t){return e[t.id]={id:t.id,value:t.value},e}),{});i=(a||[]).reduce((function(e,r){var n=s[r.id],o=t.featureEnabled&&n?n.value:r.defaultValue;return e[r.key]={id:r.id,key:r.key,type:r.type,value:o},e}),{})}return i}function i(e,t){return(e.featureFlags||[]).reduce((function(r,n){return r[n.key]={id:n.id,key:n.key,experimentsMap:(n.experimentIds||[]).reduce((function(r,n){var o=e.experimentIdMap[n].key;return r[o]=t[o],r}),{}),variablesMap:(n.variables||[]).reduce((function(e,t){return e[t.key]={id:t.id,key:t.key,type:t.type,value:t.defaultValue},e}),{})},r}),{})}e.exports={getOptimizelyConfig:function(e){var t=function(e){var t=(e.rollouts||[]).reduce((function(e,t){return t.experiments.forEach((function(t){e[t.id]=!0})),e}),{}),r=(e.featureFlags||[]).reduce((function(e,t){return e[t.id]=t.variables,e}),{});return(e.experiments||[]).reduce((function(i,a){return t[a.id]||(i[a.key]={id:a.id,key:a.key,variationsMap:(a.variations||[]).reduce((function(t,i){return t[i.key]={id:i.id,key:i.key,variablesMap:o(e,i,a.id,r)},n.isFeatureExperiment(e,a.id)&&(t[i.key].featureEnabled=i.featureEnabled),t}),{})}),i}),{})}(e);return{experimentsMap:t,featuresMap:i(e,t),revision:e.revision}}}},function(e,t,r){var n=r(3);e.exports={validateEventBatchSize:function(e){return n.isFinite(e)&&e>=1},validateEventFlushInterval:function(e){return n.isFinite(e)&&e>0}}},function(e,t,r){var n;
/*!
  Copyright (c) 2015 Jed Watson.
  Based on code that is Copyright 2013-2015, Facebook, Inc.
  All rights reserved.
*/!function(){"use strict";var o=!("undefined"==typeof window||!window.document||!window.document.createElement),i={canUseDOM:o,canUseWorkers:"undefined"!=typeof Worker,canUseEventListeners:o&&!(!window.addEventListener&&!window.attachEvent),canUseViewport:o&&!!window.screen};void 0===(n=function(){return i}.call(t,r,t,e))||(e.exports=n)}()},function(e,t,r){"use strict";var n=r(269),o=r(279),i=r(63);e.exports={formats:i,parse:o,stringify:n}},function(e,t,r){"use strict";var n=r(270),o=r(103),i=r(63),a=Object.prototype.hasOwnProperty,s={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},u=Array.isArray,c=String.prototype.split,l=Array.prototype.push,f=function(e,t){l.apply(e,u(t)?t:[t])},p=Date.prototype.toISOString,d=i.default,y={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:o.encode,encodeValuesOnly:!1,format:d,formatter:i.formatters[d],indices:!1,serializeDate:function(e){return p.call(e)},skipNulls:!1,strictNullHandling:!1},g={},v=function e(t,r,i,a,s,l,p,d,v,h,E,_,m,I,O,b){for(var R,T=t,A=b,N=0,S=!1;void 0!==(A=A.get(g))&&!S;){var x=A.get(t);if(N+=1,void 0!==x){if(x===N)throw new RangeError("Cyclic object value");S=!0}void 0===A.get(g)&&(N=0)}if("function"==typeof d?T=d(r,T):T instanceof Date?T=E(T):"comma"===i&&u(T)&&(T=o.maybeMap(T,(function(e){return e instanceof Date?E(e):e}))),null===T){if(s)return p&&!I?p(r,y.encoder,O,"key",_):r;T=""}if("string"==typeof(R=T)||"number"==typeof R||"boolean"==typeof R||"symbol"==typeof R||"bigint"==typeof R||o.isBuffer(T)){if(p){var P=I?r:p(r,y.encoder,O,"key",_);if("comma"===i&&I){for(var L=c.call(String(T),","),U="",j=0;j<L.length;++j)U+=(0===j?"":",")+m(p(L[j],y.encoder,O,"value",_));return[m(P)+(a&&u(T)&&1===L.length?"[]":"")+"="+U]}return[m(P)+"="+m(p(T,y.encoder,O,"value",_))]}return[m(r)+"="+m(String(T))]}var w,D=[];if(void 0===T)return D;if("comma"===i&&u(T))w=[{value:T.length>0?T.join(",")||null:void 0}];else if(u(d))w=d;else{var C=Object.keys(T);w=v?C.sort(v):C}for(var V=a&&u(T)&&1===T.length?r+"[]":r,F=0;F<w.length;++F){var M=w[F],k="object"==typeof M&&void 0!==M.value?M.value:T[M];if(!l||null!==k){var B=u(T)?"function"==typeof i?i(V,M):V:V+(h?"."+M:"["+M+"]");b.set(t,N);var G=n();G.set(g,b),f(D,e(k,B,i,a,s,l,p,d,v,h,E,_,m,I,O,G))}}return D};e.exports=function(e,t){var r,o=e,c=function(e){if(!e)return y;if(null!==e.encoder&&void 0!==e.encoder&&"function"!=typeof e.encoder)throw new TypeError("Encoder has to be a function.");var t=e.charset||y.charset;if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var r=i.default;if(void 0!==e.format){if(!a.call(i.formatters,e.format))throw new TypeError("Unknown format option provided.");r=e.format}var n=i.formatters[r],o=y.filter;return("function"==typeof e.filter||u(e.filter))&&(o=e.filter),{addQueryPrefix:"boolean"==typeof e.addQueryPrefix?e.addQueryPrefix:y.addQueryPrefix,allowDots:void 0===e.allowDots?y.allowDots:!!e.allowDots,charset:t,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:y.charsetSentinel,delimiter:void 0===e.delimiter?y.delimiter:e.delimiter,encode:"boolean"==typeof e.encode?e.encode:y.encode,encoder:"function"==typeof e.encoder?e.encoder:y.encoder,encodeValuesOnly:"boolean"==typeof e.encodeValuesOnly?e.encodeValuesOnly:y.encodeValuesOnly,filter:o,format:r,formatter:n,serializeDate:"function"==typeof e.serializeDate?e.serializeDate:y.serializeDate,skipNulls:"boolean"==typeof e.skipNulls?e.skipNulls:y.skipNulls,sort:"function"==typeof e.sort?e.sort:null,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:y.strictNullHandling}}(t);"function"==typeof c.filter?o=(0,c.filter)("",o):u(c.filter)&&(r=c.filter);var l,p=[];if("object"!=typeof o||null===o)return"";l=t&&t.arrayFormat in s?t.arrayFormat:t&&"indices"in t?t.indices?"indices":"repeat":"indices";var d=s[l];if(t&&"commaRoundTrip"in t&&"boolean"!=typeof t.commaRoundTrip)throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var g="comma"===d&&t&&t.commaRoundTrip;r||(r=Object.keys(o)),c.sort&&r.sort(c.sort);for(var h=n(),E=0;E<r.length;++E){var _=r[E];c.skipNulls&&null===o[_]||f(p,v(o[_],_,d,g,c.strictNullHandling,c.skipNulls,c.encode?c.encoder:null,c.filter,c.sort,c.allowDots,c.serializeDate,c.format,c.formatter,c.encodeValuesOnly,c.charset,h))}var m=p.join(c.delimiter),I=!0===c.addQueryPrefix?"?":"";return c.charsetSentinel&&("iso-8859-1"===c.charset?I+="utf8=%26%2310003%3B&":I+="utf8=%E2%9C%93&"),m.length>0?I+m:""}},function(e,t,r){"use strict";var n=r(61),o=r(275),i=r(277),a=n("%TypeError%"),s=n("%WeakMap%",!0),u=n("%Map%",!0),c=o("WeakMap.prototype.get",!0),l=o("WeakMap.prototype.set",!0),f=o("WeakMap.prototype.has",!0),p=o("Map.prototype.get",!0),d=o("Map.prototype.set",!0),y=o("Map.prototype.has",!0),g=function(e,t){for(var r,n=e;null!==(r=n.next);n=r)if(r.key===t)return n.next=r.next,r.next=e.next,e.next=r,r};e.exports=function(){var e,t,r,n={assert:function(e){if(!n.has(e))throw new a("Side channel does not contain "+i(e))},get:function(n){if(s&&n&&("object"==typeof n||"function"==typeof n)){if(e)return c(e,n)}else if(u){if(t)return p(t,n)}else if(r)return function(e,t){var r=g(e,t);return r&&r.value}(r,n)},has:function(n){if(s&&n&&("object"==typeof n||"function"==typeof n)){if(e)return f(e,n)}else if(u){if(t)return y(t,n)}else if(r)return function(e,t){return!!g(e,t)}(r,n);return!1},set:function(n,o){s&&n&&("object"==typeof n||"function"==typeof n)?(e||(e=new s),l(e,n,o)):u?(t||(t=new u),d(t,n,o)):(r||(r={key:{},next:null}),function(e,t,r){var n=g(e,t);n?n.value=r:e.next={key:t,next:e.next,value:r}}(r,n,o))}};return n}},function(e,t,r){"use strict";var n="undefined"!=typeof Symbol&&Symbol,o=r(272);e.exports=function(){return"function"==typeof n&&("function"==typeof Symbol&&("symbol"==typeof n("foo")&&("symbol"==typeof Symbol("bar")&&o())))}},function(e,t,r){"use strict";e.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var e={},t=Symbol("test"),r=Object(t);if("string"==typeof t)return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;if("[object Symbol]"!==Object.prototype.toString.call(r))return!1;for(t in e[t]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var n=Object.getOwnPropertySymbols(e);if(1!==n.length||n[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var o=Object.getOwnPropertyDescriptor(e,t);if(42!==o.value||!0!==o.enumerable)return!1}return!0}},function(e,t,r){"use strict";var n="Function.prototype.bind called on incompatible ",o=Array.prototype.slice,i=Object.prototype.toString;e.exports=function(e){var t=this;if("function"!=typeof t||"[object Function]"!==i.call(t))throw new TypeError(n+t);for(var r,a=o.call(arguments,1),s=function(){if(this instanceof r){var n=t.apply(this,a.concat(o.call(arguments)));return Object(n)===n?n:this}return t.apply(e,a.concat(o.call(arguments)))},u=Math.max(0,t.length-a.length),c=[],l=0;l<u;l++)c.push("$"+l);if(r=Function("binder","return function ("+c.join(",")+"){ return binder.apply(this,arguments); }")(s),t.prototype){var f=function(){};f.prototype=t.prototype,r.prototype=new f,f.prototype=null}return r}},function(e,t,r){"use strict";var n=r(62);e.exports=n.call(Function.call,Object.prototype.hasOwnProperty)},function(e,t,r){"use strict";var n=r(61),o=r(276),i=o(n("String.prototype.indexOf"));e.exports=function(e,t){var r=n(e,!!t);return"function"==typeof r&&i(e,".prototype.")>-1?o(r):r}},function(e,t,r){"use strict";var n=r(62),o=r(61),i=o("%Function.prototype.apply%"),a=o("%Function.prototype.call%"),s=o("%Reflect.apply%",!0)||n.call(a,i),u=o("%Object.getOwnPropertyDescriptor%",!0),c=o("%Object.defineProperty%",!0),l=o("%Math.max%");if(c)try{c({},"a",{value:1})}catch(e){c=null}e.exports=function(e){var t=s(n,a,arguments);if(u&&c){var r=u(t,"length");r.configurable&&c(t,"length",{value:1+l(0,e.length-(arguments.length-1))})}return t};var f=function(){return s(n,i,arguments)};c?c(e.exports,"apply",{value:f}):e.exports.apply=f},function(e,t,r){var n="function"==typeof Map&&Map.prototype,o=Object.getOwnPropertyDescriptor&&n?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,i=n&&o&&"function"==typeof o.get?o.get:null,a=n&&Map.prototype.forEach,s="function"==typeof Set&&Set.prototype,u=Object.getOwnPropertyDescriptor&&s?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,c=s&&u&&"function"==typeof u.get?u.get:null,l=s&&Set.prototype.forEach,f="function"==typeof WeakMap&&WeakMap.prototype?WeakMap.prototype.has:null,p="function"==typeof WeakSet&&WeakSet.prototype?WeakSet.prototype.has:null,d="function"==typeof WeakRef&&WeakRef.prototype?WeakRef.prototype.deref:null,y=Boolean.prototype.valueOf,g=Object.prototype.toString,v=Function.prototype.toString,h=String.prototype.match,E=String.prototype.slice,_=String.prototype.replace,m=String.prototype.toUpperCase,I=String.prototype.toLowerCase,O=RegExp.prototype.test,b=Array.prototype.concat,R=Array.prototype.join,T=Array.prototype.slice,A=Math.floor,N="function"==typeof BigInt?BigInt.prototype.valueOf:null,S=Object.getOwnPropertySymbols,x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?Symbol.prototype.toString:null,P="function"==typeof Symbol&&"object"==typeof Symbol.iterator,L="function"==typeof Symbol&&Symbol.toStringTag&&(typeof Symbol.toStringTag===P||"symbol")?Symbol.toStringTag:null,U=Object.prototype.propertyIsEnumerable,j=("function"==typeof Reflect?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(e){return e.__proto__}:null);function w(e,t){if(e===1/0||e===-1/0||e!=e||e&&e>-1e3&&e<1e3||O.call(/e/,t))return t;var r=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if("number"==typeof e){var n=e<0?-A(-e):A(e);if(n!==e){var o=String(n),i=E.call(t,o.length+1);return _.call(o,r,"$&_")+"."+_.call(_.call(i,/([0-9]{3})/g,"$&_"),/_$/,"")}}return _.call(t,r,"$&_")}var D=r(278),C=D.custom,V=G(C)?C:null;function F(e,t,r){var n="double"===(r.quoteStyle||t)?'"':"'";return n+e+n}function M(e){return _.call(String(e),/"/g,"&quot;")}function k(e){return!("[object Array]"!==z(e)||L&&"object"==typeof e&&L in e)}function B(e){return!("[object RegExp]"!==z(e)||L&&"object"==typeof e&&L in e)}function G(e){if(P)return e&&"object"==typeof e&&e instanceof Symbol;if("symbol"==typeof e)return!0;if(!e||"object"!=typeof e||!x)return!1;try{return x.call(e),!0}catch(e){}return!1}e.exports=function e(t,r,n,o){var s=r||{};if(q(s,"quoteStyle")&&"single"!==s.quoteStyle&&"double"!==s.quoteStyle)throw new TypeError('option "quoteStyle" must be "single" or "double"');if(q(s,"maxStringLength")&&("number"==typeof s.maxStringLength?s.maxStringLength<0&&s.maxStringLength!==1/0:null!==s.maxStringLength))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var u=!q(s,"customInspect")||s.customInspect;if("boolean"!=typeof u&&"symbol"!==u)throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(q(s,"indent")&&null!==s.indent&&"\t"!==s.indent&&!(parseInt(s.indent,10)===s.indent&&s.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(q(s,"numericSeparator")&&"boolean"!=typeof s.numericSeparator)throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var g=s.numericSeparator;if(void 0===t)return"undefined";if(null===t)return"null";if("boolean"==typeof t)return t?"true":"false";if("string"==typeof t)return function e(t,r){if(t.length>r.maxStringLength){var n=t.length-r.maxStringLength,o="... "+n+" more character"+(n>1?"s":"");return e(E.call(t,0,r.maxStringLength),r)+o}return F(_.call(_.call(t,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,Y),"single",r)}(t,s);if("number"==typeof t){if(0===t)return 1/0/t>0?"0":"-0";var m=String(t);return g?w(t,m):m}if("bigint"==typeof t){var O=String(t)+"n";return g?w(t,O):O}var A=void 0===s.depth?5:s.depth;if(void 0===n&&(n=0),n>=A&&A>0&&"object"==typeof t)return k(t)?"[Array]":"[Object]";var S=function(e,t){var r;if("\t"===e.indent)r="\t";else{if(!("number"==typeof e.indent&&e.indent>0))return null;r=R.call(Array(e.indent+1)," ")}return{base:r,prev:R.call(Array(t+1),r)}}(s,n);if(void 0===o)o=[];else if(H(o,t)>=0)return"[Circular]";function C(t,r,i){if(r&&(o=T.call(o)).push(r),i){var a={depth:s.depth};return q(s,"quoteStyle")&&(a.quoteStyle=s.quoteStyle),e(t,a,n+1,o)}return e(t,s,n+1,o)}if("function"==typeof t&&!B(t)){var K=function(e){if(e.name)return e.name;var t=h.call(v.call(e),/^function\s*([\w$]+)/);if(t)return t[1];return null}(t),Q=Z(t,C);return"[Function"+(K?": "+K:" (anonymous)")+"]"+(Q.length>0?" { "+R.call(Q,", ")+" }":"")}if(G(t)){var ee=P?_.call(String(t),/^(Symbol\(.*\))_[^)]*$/,"$1"):x.call(t);return"object"!=typeof t||P?ee:W(ee)}if(function(e){if(!e||"object"!=typeof e)return!1;if("undefined"!=typeof HTMLElement&&e instanceof HTMLElement)return!0;return"string"==typeof e.nodeName&&"function"==typeof e.getAttribute}(t)){for(var te="<"+I.call(String(t.nodeName)),re=t.attributes||[],ne=0;ne<re.length;ne++)te+=" "+re[ne].name+"="+F(M(re[ne].value),"double",s);return te+=">",t.childNodes&&t.childNodes.length&&(te+="..."),te+="</"+I.call(String(t.nodeName))+">"}if(k(t)){if(0===t.length)return"[]";var oe=Z(t,C);return S&&!function(e){for(var t=0;t<e.length;t++)if(H(e[t],"\n")>=0)return!1;return!0}(oe)?"["+$(oe,S)+"]":"[ "+R.call(oe,", ")+" ]"}if(function(e){return!("[object Error]"!==z(e)||L&&"object"==typeof e&&L in e)}(t)){var ie=Z(t,C);return"cause"in Error.prototype||!("cause"in t)||U.call(t,"cause")?0===ie.length?"["+String(t)+"]":"{ ["+String(t)+"] "+R.call(ie,", ")+" }":"{ ["+String(t)+"] "+R.call(b.call("[cause]: "+C(t.cause),ie),", ")+" }"}if("object"==typeof t&&u){if(V&&"function"==typeof t[V]&&D)return D(t,{depth:A-n});if("symbol"!==u&&"function"==typeof t.inspect)return t.inspect()}if(function(e){if(!i||!e||"object"!=typeof e)return!1;try{i.call(e);try{c.call(e)}catch(e){return!0}return e instanceof Map}catch(e){}return!1}(t)){var ae=[];return a.call(t,(function(e,r){ae.push(C(r,t,!0)+" => "+C(e,t))})),X("Map",i.call(t),ae,S)}if(function(e){if(!c||!e||"object"!=typeof e)return!1;try{c.call(e);try{i.call(e)}catch(e){return!0}return e instanceof Set}catch(e){}return!1}(t)){var se=[];return l.call(t,(function(e){se.push(C(e,t))})),X("Set",c.call(t),se,S)}if(function(e){if(!f||!e||"object"!=typeof e)return!1;try{f.call(e,f);try{p.call(e,p)}catch(e){return!0}return e instanceof WeakMap}catch(e){}return!1}(t))return J("WeakMap");if(function(e){if(!p||!e||"object"!=typeof e)return!1;try{p.call(e,p);try{f.call(e,f)}catch(e){return!0}return e instanceof WeakSet}catch(e){}return!1}(t))return J("WeakSet");if(function(e){if(!d||!e||"object"!=typeof e)return!1;try{return d.call(e),!0}catch(e){}return!1}(t))return J("WeakRef");if(function(e){return!("[object Number]"!==z(e)||L&&"object"==typeof e&&L in e)}(t))return W(C(Number(t)));if(function(e){if(!e||"object"!=typeof e||!N)return!1;try{return N.call(e),!0}catch(e){}return!1}(t))return W(C(N.call(t)));if(function(e){return!("[object Boolean]"!==z(e)||L&&"object"==typeof e&&L in e)}(t))return W(y.call(t));if(function(e){return!("[object String]"!==z(e)||L&&"object"==typeof e&&L in e)}(t))return W(C(String(t)));if(!function(e){return!("[object Date]"!==z(e)||L&&"object"==typeof e&&L in e)}(t)&&!B(t)){var ue=Z(t,C),ce=j?j(t)===Object.prototype:t instanceof Object||t.constructor===Object,le=t instanceof Object?"":"null prototype",fe=!ce&&L&&Object(t)===t&&L in t?E.call(z(t),8,-1):le?"Object":"",pe=(ce||"function"!=typeof t.constructor?"":t.constructor.name?t.constructor.name+" ":"")+(fe||le?"["+R.call(b.call([],fe||[],le||[]),": ")+"] ":"");return 0===ue.length?pe+"{}":S?pe+"{"+$(ue,S)+"}":pe+"{ "+R.call(ue,", ")+" }"}return String(t)};var K=Object.prototype.hasOwnProperty||function(e){return e in this};function q(e,t){return K.call(e,t)}function z(e){return g.call(e)}function H(e,t){if(e.indexOf)return e.indexOf(t);for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}function Y(e){var t=e.charCodeAt(0),r={8:"b",9:"t",10:"n",12:"f",13:"r"}[t];return r?"\\"+r:"\\x"+(t<16?"0":"")+m.call(t.toString(16))}function W(e){return"Object("+e+")"}function J(e){return e+" { ? }"}function X(e,t,r,n){return e+" ("+t+") {"+(n?$(r,n):R.call(r,", "))+"}"}function $(e,t){if(0===e.length)return"";var r="\n"+t.prev+t.base;return r+R.call(e,","+r)+"\n"+t.prev}function Z(e,t){var r=k(e),n=[];if(r){n.length=e.length;for(var o=0;o<e.length;o++)n[o]=q(e,o)?t(e[o],e):""}var i,a="function"==typeof S?S(e):[];if(P){i={};for(var s=0;s<a.length;s++)i["$"+a[s]]=a[s]}for(var u in e)q(e,u)&&(r&&String(Number(u))===u&&u<e.length||P&&i["$"+u]instanceof Symbol||(O.call(/[^\w$]/,u)?n.push(t(u,e)+": "+t(e[u],e)):n.push(u+": "+t(e[u],e))));if("function"==typeof S)for(var c=0;c<a.length;c++)U.call(e,a[c])&&n.push("["+t(a[c])+"]: "+t(e[a[c]],e));return n}},function(e,t){},function(e,t,r){"use strict";var n=r(103),o=Object.prototype.hasOwnProperty,i=Array.isArray,a={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:n.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},s=function(e){return e.replace(/&#(\d+);/g,(function(e,t){return String.fromCharCode(parseInt(t,10))}))},u=function(e,t){return e&&"string"==typeof e&&t.comma&&e.indexOf(",")>-1?e.split(","):e},c=function(e,t,r,n){if(e){var i=r.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,a=/(\[[^[\]]*])/g,s=r.depth>0&&/(\[[^[\]]*])/.exec(i),c=s?i.slice(0,s.index):i,l=[];if(c){if(!r.plainObjects&&o.call(Object.prototype,c)&&!r.allowPrototypes)return;l.push(c)}for(var f=0;r.depth>0&&null!==(s=a.exec(i))&&f<r.depth;){if(f+=1,!r.plainObjects&&o.call(Object.prototype,s[1].slice(1,-1))&&!r.allowPrototypes)return;l.push(s[1])}return s&&l.push("["+i.slice(s.index)+"]"),function(e,t,r,n){for(var o=n?t:u(t,r),i=e.length-1;i>=0;--i){var a,s=e[i];if("[]"===s&&r.parseArrays)a=[].concat(o);else{a=r.plainObjects?Object.create(null):{};var c="["===s.charAt(0)&&"]"===s.charAt(s.length-1)?s.slice(1,-1):s,l=parseInt(c,10);r.parseArrays||""!==c?!isNaN(l)&&s!==c&&String(l)===c&&l>=0&&r.parseArrays&&l<=r.arrayLimit?(a=[])[l]=o:"__proto__"!==c&&(a[c]=o):a={0:o}}o=a}return o}(l,t,r,n)}};e.exports=function(e,t){var r=function(e){if(!e)return a;if(null!==e.decoder&&void 0!==e.decoder&&"function"!=typeof e.decoder)throw new TypeError("Decoder has to be a function.");if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var t=void 0===e.charset?a.charset:e.charset;return{allowDots:void 0===e.allowDots?a.allowDots:!!e.allowDots,allowPrototypes:"boolean"==typeof e.allowPrototypes?e.allowPrototypes:a.allowPrototypes,allowSparse:"boolean"==typeof e.allowSparse?e.allowSparse:a.allowSparse,arrayLimit:"number"==typeof e.arrayLimit?e.arrayLimit:a.arrayLimit,charset:t,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:a.charsetSentinel,comma:"boolean"==typeof e.comma?e.comma:a.comma,decoder:"function"==typeof e.decoder?e.decoder:a.decoder,delimiter:"string"==typeof e.delimiter||n.isRegExp(e.delimiter)?e.delimiter:a.delimiter,depth:"number"==typeof e.depth||!1===e.depth?+e.depth:a.depth,ignoreQueryPrefix:!0===e.ignoreQueryPrefix,interpretNumericEntities:"boolean"==typeof e.interpretNumericEntities?e.interpretNumericEntities:a.interpretNumericEntities,parameterLimit:"number"==typeof e.parameterLimit?e.parameterLimit:a.parameterLimit,parseArrays:!1!==e.parseArrays,plainObjects:"boolean"==typeof e.plainObjects?e.plainObjects:a.plainObjects,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:a.strictNullHandling}}(t);if(""===e||null==e)return r.plainObjects?Object.create(null):{};for(var l="string"==typeof e?function(e,t){var r,c={},l=t.ignoreQueryPrefix?e.replace(/^\?/,""):e,f=t.parameterLimit===1/0?void 0:t.parameterLimit,p=l.split(t.delimiter,f),d=-1,y=t.charset;if(t.charsetSentinel)for(r=0;r<p.length;++r)0===p[r].indexOf("utf8=")&&("utf8=%E2%9C%93"===p[r]?y="utf-8":"utf8=%26%2310003%3B"===p[r]&&(y="iso-8859-1"),d=r,r=p.length);for(r=0;r<p.length;++r)if(r!==d){var g,v,h=p[r],E=h.indexOf("]="),_=-1===E?h.indexOf("="):E+1;-1===_?(g=t.decoder(h,a.decoder,y,"key"),v=t.strictNullHandling?null:""):(g=t.decoder(h.slice(0,_),a.decoder,y,"key"),v=n.maybeMap(u(h.slice(_+1),t),(function(e){return t.decoder(e,a.decoder,y,"value")}))),v&&t.interpretNumericEntities&&"iso-8859-1"===y&&(v=s(v)),h.indexOf("[]=")>-1&&(v=i(v)?[v]:v),o.call(c,g)?c[g]=n.combine(c[g],v):c[g]=v}return c}(e,r):e,f=r.plainObjects?Object.create(null):{},p=Object.keys(l),d=0;d<p.length;++d){var y=p[d],g=c(y,l[y],r,"string"==typeof e);f=n.merge(f,g,r)}return!0===r.allowSparse?f:n.compact(f)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.COOKIE_NAME=void 0;t.COOKIE_NAME="anonymousId"},function(e,t,r){"use strict";r.r(t);var n=r(11),o=r(104),i=r.n(o),a="https://cdn.optimizely.com/public/6194110778/s/9011010262_dev.json",s="https://www.nike.com/assets/vendor/optimizely/prod/5aUCtZvFuDLjvdqdf2w53M.json",u=r(33),c=r.n(u),l=r(34),f=r.n(l),p=r(35),d=r.n(p),y=r(36),g=r.n(y),v=r(15),h=r.n(v);var E=function(e){function t(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];e.apply(this,r)}return t.prototype=Object.create(e.prototype),Object.setPrototypeOf(t,e),t};function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h()(e);if(t){var o=h()(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return g()(this,r)}}var m=function(e){d()(r,e);var t=_(r);function r(e,n,o){var i;return c()(this,r),(i=t.call(this,e)).message=e,i.experiment=n,i.experimentManager=o,i}return f()(r,[{key:"name",get:function(){return this.constructor.name}}]),r}(E(Error));var I=r(16),O=r.n(I),b=r(105),R=r.n(b);function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h()(e);if(t){var o=h()(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return g()(this,r)}}var A=function(e){d()(r,e);var t=T(r);function r(e,n){var o;return c()(this,r),(o=t.call(this,e)).message=e,o.experiment=n,o}return f()(r,[{key:"name",get:function(){return this.constructor.name}}]),r}(E(Error));r(64);var N=r(37),S=r.n(N),x=r(38),P=r.n(x),L=[].concat(O()(Object.keys(S.a)),O()(Object.keys(P.a)));var U=function(e){function t(t){return function(r,n){var o=n||r;return"prod"!==e&&L.some((function(e){return o.includes(e)}))?console[t]("[dotcom-nav-experiments] ".concat(o)):null}}return{warn:t("warn"),info:t("info"),error:t("error"),log:t("log"),debug:t("debug")}};function j(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function w(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?j(Object(r),!0).forEach((function(t){R()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var D=function(e,t){var r=t.experiments,o=void 0===r?{}:r,i=t.features,a=void 0===i?{}:i,s=t.dotcomNav,u=t.sdk,c=[],l=[],f=U(s.env);function p(){try{return{country:s.locale.country.toLowerCase(),isDotcomNavTest:"prod"!==s.env?"true":"false"}}catch(e){return f.warn("Couldn't get attributes: ".concat(e.message))}}function d(e){if(e instanceof A)throw e;return e instanceof m?f.warn(e.message):(e&&f.error(e.message),null)}this.run=function(){var t=Object.keys(o),r=Object(n.getOptimizelyUserId)();if(!r)return Promise.reject(new m("No anonymousId value set"));var i=Object(n.getRollouts)(e,r);if((l=Object.keys(i)).forEach((function(e){try{return function(e){var t=a[e];if("function"!=typeof t)throw new m("feature '".concat(e,"' not found"));var r={name:e,dotcomNav:s,sdk:u};return t.call(this,r)}(e)}catch(e){return d(e)}})),!t.length)return f.warn("No experiments to run"),Promise.resolve();var y=Object(n.activateExperiments)(e,t,r,p());c=Object.keys(y).filter((function(e){return y[e]})).map((function(e){return{experimentKey:e,variationKey:y[e].toUpperCase()}}));var g=Object(n.getVariantVariables)(e,c.map((function(e){return e.experimentKey})),r,p()),v=c.map((function(e){var t=e.experimentKey,r=e.variationKey,n=g[t];try{return function(e,t,r){f.info("Running experiment ".concat(e,":").concat(t));var n=o[e];if(!n)throw new m("Experiment not found: ".concat(e,":").concat(t),n);return function(e){return"Z"===e.toUpperCase()}(t)?null:n.call(this,{experimentKey:e,variationKey:t,attributes:r,dotcomNav:s,sdk:u})}(t,r,n)}catch(e){return d(e)}}));return Promise.all(v)},this.getDataFile=function(){return e.configObj},this.getAudienceAttributes=p,this.getActiveExperiments=function(){return c},this.getActiveFeatures=function(){return l},this.getExperimentData=function(e){if(!c.length)return{};var t=c.map((function(e){return{experimentId:e.experimentKey,variationId:e.variationKey}})),r=e.abTest,n=void 0===r?{}:r,o=e.traits;return{abTest:w(w({},n),{},{optimizely:[].concat(O()(n.optimizely||[]),O()(t))}),traits:w(w({},o),p())}},this.getExperiments=function(){return o},this.getFeatures=function(){return a}};function C(e,t){var r=e.env,o=void 0===r?"prod":r;return function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.a,n=e?a:s;return r(n).then((function(e){if(200!==e.status)throw new m("Could not fetch ".concat(n,": Status code ").concat(e.status));return t?e.json():e.text()}))}("prod"!==o).then((function(r){var i=Object(n.getExperimentDriver)(r,{logger:U(o)});if(!i.__isOptimizelyConfigValid)throw new m("Optimizely client is not valid");var a=new D(i,{experiments:P.a,features:S.a,dotcomNav:e,sdk:t});return Object.defineProperty(e,"experimentManager",{value:a}),a}))}var V=function(){return new Promise((function(e,t){var r,n;null!==(r=window)&&void 0!==r&&null!==(n=r.NikePrivacy)&&void 0!==n&&n.isEnabled?window.addEventListener("@nikePrivacyCoreCustomEvent/initialized",(function(){return function(e,t){var r,n,o,i,a,s;null!==(r=window.NikePrivacy)&&void 0!==r&&null!==(n=r.permissions)&&void 0!==n&&null!==(o=n.get("performance"))&&void 0!==o&&o.isEnabled&&null!==(i=window.NikePrivacy)&&void 0!==i&&null!==(a=i.permissions)&&void 0!==a&&null!==(s=a.get("adtargetingBehavioralevents"))&&void 0!==s&&s.isEnabled?e():t("User has denied performance and adtargetingBehavioralevents")}(e,t)}),{once:!0}):e()}))};window.NikeDotcomNavReady((function(e,t){V().then((function(){return C(e,t)})).then((function(e){return e.run()})).catch((function(e){console.error(e)}))}))},function(e,t,r){"use strict";r.r(t);var n=r(17);function o(e,t){void 0===t&&(t={});var r=function(e){if(e&&"j"===e[0]&&":"===e[1])return e.substr(2);return e}(e);if(function(e,t){return void 0===t&&(t=!e||"{"!==e[0]&&"["!==e[0]&&'"'!==e[0]),!t}(r,t.doNotParse))try{return JSON.parse(r)}catch(e){}return e}var i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},a=function(){function e(e,t){var r=this;this.changeListeners=[],this.HAS_DOCUMENT_COOKIE=!1,this.cookies=function(e,t){return"string"==typeof e?n.parse(e,t):"object"==typeof e&&null!==e?e:{}}(e,t),new Promise((function(){r.HAS_DOCUMENT_COOKIE="object"==typeof document&&"string"==typeof document.cookie})).catch((function(){}))}return e.prototype._updateBrowserValues=function(e){this.HAS_DOCUMENT_COOKIE&&(this.cookies=n.parse(document.cookie,e))},e.prototype._emitChange=function(e){for(var t=0;t<this.changeListeners.length;++t)this.changeListeners[t](e)},e.prototype.get=function(e,t,r){return void 0===t&&(t={}),this._updateBrowserValues(r),o(this.cookies[e],t)},e.prototype.getAll=function(e,t){void 0===e&&(e={}),this._updateBrowserValues(t);var r={};for(var n in this.cookies)r[n]=o(this.cookies[n],e);return r},e.prototype.set=function(e,t,r){var o;"object"==typeof t&&(t=JSON.stringify(t)),this.cookies=i(i({},this.cookies),((o={})[e]=t,o)),this.HAS_DOCUMENT_COOKIE&&(document.cookie=n.serialize(e,t,r)),this._emitChange({name:e,value:t,options:r})},e.prototype.remove=function(e,t){var r=t=i(i({},t),{expires:new Date(1970,1,1,0,0,1),maxAge:0});this.cookies=i({},this.cookies),delete this.cookies[e],this.HAS_DOCUMENT_COOKIE&&(document.cookie=n.serialize(e,"",r)),this._emitChange({name:e,value:void 0,options:t})},e.prototype.addChangeListener=function(e){this.changeListeners.push(e)},e.prototype.removeChangeListener=function(e){var t=this.changeListeners.indexOf(e);t>=0&&this.changeListeners.splice(t,1)},e}();t.default=a}]);