(window.webpackJsonp=window.webpackJsonp||[]).push([[57],{"../../.yarn/cache/@optimizely-optimizely-sdk-npm-3.5.0-03a2197329-2595552a44.zip/node_modules/@optimizely/optimizely-sdk/lib/index.browser.js":function(e,i,t){t("../../.yarn/cache/promise-polyfill-npm-8.1.0-996c570491-d8347851dc.zip/node_modules/promise-polyfill/dist/polyfill.js");var r=t("../../.yarn/cache/@optimizely-js-sdk-logging-npm-0.1.0-43f6c5e030-b1d2de26cf.zip/node_modules/@optimizely/js-sdk-logging/lib/index.js"),n=t("../../.yarn/cache/@optimizely-optimizely-sdk-npm-3.5.0-03a2197329-2595552a44.zip/node_modules/@optimizely/optimizely-sdk/lib/utils/fns/index.js"),o=t("../../.yarn/cache/@optimizely-optimizely-sdk-npm-3.5.0-03a2197329-2595552a44.zip/node_modules/@optimizely/optimizely-sdk/lib/utils/config_validator/index.js"),a=t("../../.yarn/cache/@optimizely-optimizely-sdk-npm-3.5.0-03a2197329-2595552a44.zip/node_modules/@optimizely/optimizely-sdk/lib/plugins/error_handler/index.js"),s=t("../../.yarn/cache/@optimizely-optimizely-sdk-npm-3.5.0-03a2197329-2595552a44.zip/node_modules/@optimizely/optimizely-sdk/lib/plugins/event_dispatcher/index.browser.js"),l=t("../../.yarn/cache/@optimizely-optimizely-sdk-npm-3.5.0-03a2197329-2595552a44.zip/node_modules/@optimizely/optimizely-sdk/lib/utils/enums/index.js"),p=t("../../.yarn/cache/@optimizely-js-sdk-event-processor-npm-0.4.0-a83376e778-6838febe08.zip/node_modules/@optimizely/js-sdk-event-processor/lib/index.js"),d=t("../../.yarn/cache/@optimizely-optimizely-sdk-npm-3.5.0-03a2197329-2595552a44.zip/node_modules/@optimizely/optimizely-sdk/lib/plugins/logger/index.js"),g=t("../../.yarn/cache/@optimizely-optimizely-sdk-npm-3.5.0-03a2197329-2595552a44.zip/node_modules/@optimizely/optimizely-sdk/lib/optimizely/index.js"),c=t("../../.yarn/cache/@optimizely-optimizely-sdk-npm-3.5.0-03a2197329-2595552a44.zip/node_modules/@optimizely/optimizely-sdk/lib/utils/event_processor_config_validator/index.js"),u=r.getLogger();r.setLogHandler(d.createLogger()),r.setLogLevel(r.LogLevel.INFO);var y=!1;e.exports={logging:d,errorHandler:a,eventDispatcher:s,enums:l,setLogger:r.setLogHandler,setLogLevel:r.setLogLevel,createInstance:function(e){try{(e=e||{}).errorHandler&&r.setErrorHandler(e.errorHandler),e.logger&&(r.setLogHandler(e.logger),r.setLogLevel(r.LogLevel.NOTSET)),void 0!==e.logLevel&&r.setLogLevel(e.logLevel);try{o.validate(e),e.isValidInstance=!0}catch(i){u.error(i),e.isValidInstance=!1}var i;null==e.skipJSONValidation&&(e.skipJSONValidation=!0),null==e.eventDispatcher?(i=new p.LocalStoragePendingEventsDispatcher({eventDispatcher:s}),y||(i.sendPendingEvents(),y=!0)):i=e.eventDispatcher,e=n.assignIn({clientEngine:l.JAVASCRIPT_CLIENT_ENGINE,eventBatchSize:10,eventFlushInterval:1e3},e,{eventDispatcher:i,logger:u,errorHandler:r.getErrorHandler()}),c.validateEventBatchSize(e.eventBatchSize)||(u.warn("Invalid eventBatchSize %s, defaulting to %s",e.eventBatchSize,10),e.eventBatchSize=10),c.validateEventFlushInterval(e.eventFlushInterval)||(u.warn("Invalid eventFlushInterval %s, defaulting to %s",e.eventFlushInterval,1e3),e.eventFlushInterval=1e3);var t=new g(e);try{if("function"==typeof window.addEventListener){var a="onpagehide"in window?"pagehide":"unload";window.addEventListener(a,(function(){t.close()}),!1)}}catch(e){u.error(l.LOG_MESSAGES.UNABLE_TO_ATTACH_UNLOAD,"INDEX_BROWSER",e.message)}return t}catch(e){return u.error(e),null}},__internalResetRetryState:function(){y=!1}}},"../../.yarn/cache/@optimizely-optimizely-sdk-npm-3.5.0-03a2197329-2595552a44.zip/node_modules/@optimizely/optimizely-sdk/lib/optimizely/index.js":function(e,i,t){var r=t("../../.yarn/cache/@optimizely-optimizely-sdk-npm-3.5.0-03a2197329-2595552a44.zip/node_modules/@optimizely/optimizely-sdk/lib/utils/fns/index.js"),n=t("../../.yarn/cache/@optimizely-optimizely-sdk-npm-3.5.0-03a2197329-2595552a44.zip/node_modules/@optimizely/optimizely-sdk/lib/utils/attributes_validator/index.js"),o=t("../../.yarn/cache/@optimizely-optimizely-sdk-npm-3.5.0-03a2197329-2595552a44.zip/node_modules/@optimizely/optimizely-sdk/lib/core/decision_service/index.js"),a=t("../../.yarn/cache/@optimizely-optimizely-sdk-npm-3.5.0-03a2197329-2595552a44.zip/node_modules/@optimizely/optimizely-sdk/lib/utils/enums/index.js"),s=t("../../.yarn/cache/@optimizely-optimizely-sdk-npm-3.5.0-03a2197329-2595552a44.zip/node_modules/@optimizely/optimizely-sdk/lib/core/event_builder/index.js"),l=t("../../.yarn/cache/@optimizely-optimizely-sdk-npm-3.5.0-03a2197329-2595552a44.zip/node_modules/@optimizely/optimizely-sdk/lib/core/event_builder/event_helpers.js"),p=t("../../.yarn/cache/@optimizely-js-sdk-event-processor-npm-0.4.0-a83376e778-6838febe08.zip/node_modules/@optimizely/js-sdk-event-processor/lib/index.js"),d=t("../../.yarn/cache/@optimizely-optimizely-sdk-npm-3.5.0-03a2197329-2595552a44.zip/node_modules/@optimizely/optimizely-sdk/lib/utils/event_tags_validator/index.js"),g=t("../../.yarn/cache/@optimizely-optimizely-sdk-npm-3.5.0-03a2197329-2595552a44.zip/node_modules/@optimizely/optimizely-sdk/lib/core/notification_center/index.js"),c=t("../../.yarn/cache/@optimizely-optimizely-sdk-npm-3.5.0-03a2197329-2595552a44.zip/node_modules/@optimizely/optimizely-sdk/lib/core/project_config/index.js"),u=t("../../.yarn/cache/@optimizely-js-sdk-utils-npm-0.2.0-6e592e4113-c935bbfbc7.zip/node_modules/@optimizely/js-sdk-utils/lib/index.js").sprintf,y=t("../../.yarn/cache/@optimizely-optimizely-sdk-npm-3.5.0-03a2197329-2595552a44.zip/node_modules/@optimizely/optimizely-sdk/lib/utils/user_profile_service_validator/index.js"),h=t("../../.yarn/cache/@optimizely-optimizely-sdk-npm-3.5.0-03a2197329-2595552a44.zip/node_modules/@optimizely/optimizely-sdk/lib/utils/string_value_validator/index.js"),m=t("../../.yarn/cache/@optimizely-optimizely-sdk-npm-3.5.0-03a2197329-2595552a44.zip/node_modules/@optimizely/optimizely-sdk/lib/core/project_config/project_config_manager.js"),_=a.ERROR_MESSAGES,E=a.LOG_LEVEL,I=a.LOG_MESSAGES,v=a.DECISION_SOURCES,f=a.FEATURE_VARIABLE_TYPES,z=a.DECISION_NOTIFICATION_TYPES,O=a.NOTIFICATION_TYPES;function Optimizely(e){var i=e.clientEngine;-1===a.VALID_CLIENT_ENGINES.indexOf(i)&&(e.logger.log(E.INFO,u(I.INVALID_CLIENT_ENGINE,"OPTIMIZELY",i)),i=a.NODE_CLIENT_ENGINE),this.clientEngine=i,this.clientVersion=e.clientVersion||a.NODE_CLIENT_VERSION,this.errorHandler=e.errorHandler,this.eventDispatcher=e.eventDispatcher,this.__isOptimizelyConfigValid=e.isValidInstance,this.logger=e.logger,this.projectConfigManager=new m.ProjectConfigManager({datafile:e.datafile,datafileOptions:e.datafileOptions,jsonSchemaValidator:e.jsonSchemaValidator,sdkKey:e.sdkKey,skipJSONValidation:e.skipJSONValidation}),this.__disposeOnUpdate=this.projectConfigManager.onUpdate(function(e){this.logger.log(E.INFO,u(I.UPDATED_OPTIMIZELY_CONFIG,"OPTIMIZELY",e.revision,e.projectId)),this.notificationCenter.sendNotifications(O.OPTIMIZELY_CONFIG_UPDATE)}.bind(this)),this.__readyPromise=this.projectConfigManager.onReady();var t=null;if(e.userProfileService)try{y.validate(e.userProfileService)&&(t=e.userProfileService,this.logger.log(E.INFO,u(I.VALID_USER_PROFILE_SERVICE,"OPTIMIZELY")))}catch(e){this.logger.log(E.WARNING,e.message)}this.decisionService=o.createDecisionService({userProfileService:t,logger:this.logger,UNSTABLE_conditionEvaluators:e.UNSTABLE_conditionEvaluators}),this.notificationCenter=g.createNotificationCenter({logger:this.logger,errorHandler:this.errorHandler}),this.eventProcessor=new p.LogTierV1EventProcessor({dispatcher:this.eventDispatcher,flushInterval:e.eventFlushInterval,maxQueueSize:e.eventBatchSize,notificationCenter:this.notificationCenter}),this.eventProcessor.start(),this.__readyTimeouts={},this.__nextReadyTimeoutId=0}Optimizely.prototype.__isValidInstance=function(){return this.__isOptimizelyConfigValid&&this.projectConfigManager.getConfig()},Optimizely.prototype.activate=function(e,i,t){try{if(!this.__isValidInstance())return this.logger.log(E.ERROR,u(I.INVALID_OBJECT,"OPTIMIZELY","activate")),null;if(!this.__validateInputs({experiment_key:e,user_id:i},t))return this.__notActivatingExperiment(e,i);var r=this.projectConfigManager.getConfig();if(!r)return null;try{var n=this.getVariation(e,i,t);if(null===n)return this.__notActivatingExperiment(e,i);if(!c.isRunning(r,e)){var o=u(I.SHOULD_NOT_DISPATCH_ACTIVATE,"OPTIMIZELY",e);return this.logger.log(E.DEBUG,o),n}return this._sendImpressionEvent(e,n,i,t),n}catch(t){this.logger.log(E.ERROR,t.message);var a=u(I.NOT_ACTIVATING_USER,"OPTIMIZELY",i,e);return this.logger.log(E.INFO,a),this.errorHandler.handleError(t),null}}catch(e){return this.logger.log(E.ERROR,e.message),this.errorHandler.handleError(e),null}},Optimizely.prototype._sendImpressionEvent=function(e,i,t,r){var n=this.projectConfigManager.getConfig();if(n){var o=l.buildImpressionEvent({experimentKey:e,variationKey:i,userId:t,userAttributes:r,clientEngine:this.clientEngine,clientVersion:this.clientVersion,configObj:n});this.eventProcessor.process(o),this.__emitNotificationCenterActivate(e,i,t,r)}},Optimizely.prototype.__emitNotificationCenterActivate=function(e,i,t,r){var n=this.projectConfigManager.getConfig();if(n){var o,a=c.getVariationIdFromExperimentAndVariationKey(n,e,i),l=c.getExperimentId(n,e),p={attributes:r,clientEngine:this.clientEngine,clientVersion:this.clientVersion,configObj:n,experimentId:l,userId:t,variationId:a,logger:this.logger},d=s.getImpressionEvent(p),g=n.experimentKeyMap[e];g&&g.variationKeyMap&&(o=g.variationKeyMap[i]),this.notificationCenter.sendNotifications(O.ACTIVATE,{experiment:g,userId:t,attributes:r,variation:o,logEvent:d})}},Optimizely.prototype.track=function(e,i,t,r){try{if(!this.__isValidInstance())return void this.logger.log(E.ERROR,u(I.INVALID_OBJECT,"OPTIMIZELY","track"));if(!this.__validateInputs({user_id:i,event_key:e},t,r))return;var n=this.projectConfigManager.getConfig();if(!n)return;if(!c.eventWithKeyExists(n,e))throw new Error(u(_.INVALID_EVENT_KEY,"OPTIMIZELY",e));r=this.__filterEmptyValues(r);var o=l.buildConversionEvent({eventKey:e,eventTags:r,userId:i,userAttributes:t,clientEngine:this.clientEngine,clientVersion:this.clientVersion,configObj:n});this.logger.log(E.INFO,u(a.LOG_MESSAGES.TRACK_EVENT,"OPTIMIZELY",e,i)),this.eventProcessor.process(o),this.__emitNotificationCenterTrack(e,i,t,r)}catch(e){this.logger.log(E.ERROR,e.message),this.errorHandler.handleError(e);var s=u(I.NOT_TRACKING_USER,"OPTIMIZELY",i);this.logger.log(E.INFO,s)}},Optimizely.prototype.__emitNotificationCenterTrack=function(e,i,t,r){try{var n=this.projectConfigManager.getConfig();if(!n)return;var o={attributes:t,clientEngine:this.clientEngine,clientVersion:this.clientVersion,configObj:n,eventKey:e,eventTags:r,logger:this.logger,userId:i},a=s.getConversionEvent(o);this.notificationCenter.sendNotifications(O.TRACK,{eventKey:e,userId:i,attributes:t,eventTags:r,logEvent:a})}catch(e){this.logger.log(E.ERROR,e.message),this.errorHandler.handleError(e)}},Optimizely.prototype.getVariation=function(e,i,t){try{if(!this.__isValidInstance())return this.logger.log(E.ERROR,u(I.INVALID_OBJECT,"OPTIMIZELY","getVariation")),null;try{if(!this.__validateInputs({experiment_key:e,user_id:i},t))return null;var n=this.projectConfigManager.getConfig();if(!n)return null;var o=n.experimentKeyMap[e];if(r.isEmpty(o))return this.logger.log(E.DEBUG,u(_.INVALID_EXPERIMENT_KEY,"OPTIMIZELY",e)),null;var a=this.decisionService.getVariation(n,e,i,t),s=c.isFeatureExperiment(n,o.id)?z.FEATURE_TEST:z.AB_TEST;return this.notificationCenter.sendNotifications(O.DECISION,{type:s,userId:i,attributes:t||{},decisionInfo:{experimentKey:e,variationKey:a}}),a}catch(e){return this.logger.log(E.ERROR,e.message),this.errorHandler.handleError(e),null}}catch(e){return this.logger.log(E.ERROR,e.message),this.errorHandler.handleError(e),null}},Optimizely.prototype.setForcedVariation=function(e,i,t){if(!this.__validateInputs({experiment_key:e,user_id:i}))return!1;var r=this.projectConfigManager.getConfig();if(!r)return!1;try{return this.decisionService.setForcedVariation(r,e,i,t)}catch(e){return this.logger.log(E.ERROR,e.message),this.errorHandler.handleError(e),!1}},Optimizely.prototype.getForcedVariation=function(e,i){if(!this.__validateInputs({experiment_key:e,user_id:i}))return null;var t=this.projectConfigManager.getConfig();if(!t)return null;try{return this.decisionService.getForcedVariation(t,e,i)}catch(e){return this.logger.log(E.ERROR,e.message),this.errorHandler.handleError(e),null}},Optimizely.prototype.__validateInputs=function(e,i,t){try{if(e.hasOwnProperty("user_id")){var r=e.user_id;if("string"!=typeof r||null===r||"undefined"===r)throw new Error(u(_.INVALID_INPUT_FORMAT,"OPTIMIZELY","user_id"));delete e.user_id}for(var o=Object.keys(e),a=0;a<o.length;a++){var s=o[a];if(!h.validate(e[s]))throw new Error(u(_.INVALID_INPUT_FORMAT,"OPTIMIZELY",s))}return i&&n.validate(i),t&&d.validate(t),!0}catch(e){return this.logger.log(E.ERROR,e.message),this.errorHandler.handleError(e),!1}},Optimizely.prototype.__notActivatingExperiment=function(e,i){var t=u(I.NOT_ACTIVATING_USER,"OPTIMIZELY",i,e);return this.logger.log(E.INFO,t),null},Optimizely.prototype.__filterEmptyValues=function(e){for(var i in e)!e.hasOwnProperty(i)||null!==e[i]&&void 0!==e[i]||delete e[i];return e},Optimizely.prototype.isFeatureEnabled=function(e,i,t){try{if(!this.__isValidInstance())return this.logger.log(E.ERROR,u(I.INVALID_OBJECT,"OPTIMIZELY","isFeatureEnabled")),!1;if(!this.__validateInputs({feature_key:e,user_id:i},t))return!1;var r=this.projectConfigManager.getConfig();if(!r)return!1;var n=c.getFeatureFromKey(r,e,this.logger);if(!n)return!1;var o=!1,a=this.decisionService.getVariationForFeature(r,n,i,t),s=a.variation,l={};s&&(o=s.featureEnabled,a.decisionSource===v.FEATURE_TEST&&(l={experimentKey:a.experiment.key,variationKey:a.variation.key},this._sendImpressionEvent(a.experiment.key,a.variation.key,i,t))),!0===o?this.logger.log(E.INFO,u(I.FEATURE_ENABLED_FOR_USER,"OPTIMIZELY",e,i)):(this.logger.log(E.INFO,u(I.FEATURE_NOT_ENABLED_FOR_USER,"OPTIMIZELY",e,i)),o=!1);var p={featureKey:e,featureEnabled:o,source:a.decisionSource,sourceInfo:l};return this.notificationCenter.sendNotifications(O.DECISION,{type:z.FEATURE,userId:i,attributes:t||{},decisionInfo:p}),o}catch(e){return this.logger.log(E.ERROR,e.message),this.errorHandler.handleError(e),!1}},Optimizely.prototype.getEnabledFeatures=function(e,i){try{var t=[];if(!this.__isValidInstance())return this.logger.log(E.ERROR,u(I.INVALID_OBJECT,"OPTIMIZELY","getEnabledFeatures")),t;if(!this.__validateInputs({user_id:e}))return t;var n=this.projectConfigManager.getConfig();return n?(r.forOwn(n.featureKeyMap,function(r){this.isFeatureEnabled(r.key,e,i)&&t.push(r.key)}.bind(this)),t):t}catch(e){return this.logger.log(E.ERROR,e.message),this.errorHandler.handleError(e),[]}},Optimizely.prototype.getFeatureVariable=function(e,i,t,r){try{return this._getFeatureVariableForType(e,i,null,t,r)}catch(e){return this.logger.log(E.ERROR,e.message),this.errorHandler.handleError(e),null}},Optimizely.prototype._getFeatureVariableForType=function(e,i,t,r,n){if(!this.__isValidInstance()){var o=t?"getFeatureVariable"+t.charAt(0).toUpperCase()+t.slice(1):"getFeatureVariable";return this.logger.log(E.ERROR,u(I.INVALID_OBJECT,"OPTIMIZELY",o)),null}if(!this.__validateInputs({feature_key:e,variable_key:i,user_id:r},n))return null;var a=this.projectConfigManager.getConfig();if(!a)return null;var s=c.getFeatureFromKey(a,e,this.logger);if(!s)return null;var l=c.getVariableForFeature(a,e,i,this.logger);if(!l)return null;if(t){if(l.type!==t)return this.logger.log(E.WARNING,u(I.VARIABLE_REQUESTED_WITH_WRONG_TYPE,"OPTIMIZELY",t,l.type)),null}else t=l.type;var p=!1,d=l.defaultValue,g=this.decisionService.getVariationForFeature(a,s,r,n);if(null!==g.variation){p=g.variation.featureEnabled;var y=c.getVariableValueForVariation(a,l,g.variation,this.logger);null!==y?!0===p?(d=y,this.logger.log(E.INFO,u(I.USER_RECEIVED_VARIABLE_VALUE,"OPTIMIZELY",i,s.key,d,r))):this.logger.log(E.INFO,u(I.FEATURE_NOT_ENABLED_RETURN_DEFAULT_VARIABLE_VALUE,"OPTIMIZELY",s.key,r,i)):this.logger.log(E.INFO,u(I.VARIABLE_NOT_USED_RETURN_DEFAULT_VARIABLE_VALUE,"OPTIMIZELY",i,g.variation.key))}else this.logger.log(E.INFO,u(I.USER_RECEIVED_DEFAULT_VARIABLE_VALUE,"OPTIMIZELY",r,i,s.key));var h={};g.decisionSource===v.FEATURE_TEST&&(h={experimentKey:g.experiment.key,variationKey:g.variation.key});var m=c.getTypeCastValue(d,t,this.logger);return this.notificationCenter.sendNotifications(O.DECISION,{type:z.FEATURE_VARIABLE,userId:r,attributes:n||{},decisionInfo:{featureKey:e,featureEnabled:p,source:g.decisionSource,variableKey:i,variableValue:m,variableType:t,sourceInfo:h}}),m},Optimizely.prototype.getFeatureVariableBoolean=function(e,i,t,r){try{return this._getFeatureVariableForType(e,i,f.BOOLEAN,t,r)}catch(e){return this.logger.log(E.ERROR,e.message),this.errorHandler.handleError(e),null}},Optimizely.prototype.getFeatureVariableDouble=function(e,i,t,r){try{return this._getFeatureVariableForType(e,i,f.DOUBLE,t,r)}catch(e){return this.logger.log(E.ERROR,e.message),this.errorHandler.handleError(e),null}},Optimizely.prototype.getFeatureVariableInteger=function(e,i,t,r){try{return this._getFeatureVariableForType(e,i,f.INTEGER,t,r)}catch(e){return this.logger.log(E.ERROR,e.message),this.errorHandler.handleError(e),null}},Optimizely.prototype.getFeatureVariableString=function(e,i,t,r){try{return this._getFeatureVariableForType(e,i,f.STRING,t,r)}catch(e){return this.logger.log(E.ERROR,e.message),this.errorHandler.handleError(e),null}},Optimizely.prototype.getOptimizelyConfig=function(){try{return this.projectConfigManager.getConfig()?this.projectConfigManager.getOptimizelyConfig():null}catch(e){return this.logger.log(E.ERROR,e.message),this.errorHandler.handleError(e),null}},Optimizely.prototype.close=function(){try{var e=this.eventProcessor.stop();return this.__disposeOnUpdate&&(this.__disposeOnUpdate(),this.__disposeOnUpdate=null),this.projectConfigManager&&this.projectConfigManager.stop(),Object.keys(this.__readyTimeouts).forEach(function(e){var i=this.__readyTimeouts[e];clearTimeout(i.readyTimeout),i.onClose()}.bind(this)),this.__readyTimeouts={},e.then((function(){return{success:!0}}),(function(e){return{success:!1,reason:String(e)}}))}catch(e){return this.logger.log(E.ERROR,e.message),this.errorHandler.handleError(e),Promise.resolve({success:!1,reason:String(e)})}},Optimizely.prototype.onReady=function(e){var i,t;"object"==typeof e&&null!==e&&(i=e.timeout),r.isFinite(i)||(i=3e4);var n=new Promise((function(e){t=e})),o=this.__nextReadyTimeoutId;this.__nextReadyTimeoutId++;var a=function(){delete this.__readyTimeouts[o],t({success:!1,reason:u("onReady timeout expired after %s ms",i)})}.bind(this),s=setTimeout(a,i);return this.__readyTimeouts[o]={readyTimeout:s,onClose:function(){t({success:!1,reason:"Instance closed"})}},this.__readyPromise.then(function(){clearTimeout(s),delete this.__readyTimeouts[o],t({success:!0})}.bind(this)),Promise.race([this.__readyPromise,n])},e.exports=Optimizely}}]);
//# sourceMappingURL=npm.optimizely~d9f739de.chunk.b284e7.js.map