(window.webpackJsonp=window.webpackJsonp||[]).push([[59],{"../../.yarn/cache/@optimizely-js-sdk-event-processor-npm-0.4.0-a83376e778-6838febe08.zip/node_modules/@optimizely/js-sdk-event-processor/lib/pendingEventsDispatcher.js":function(e,t,o){"use strict";var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function __(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)});Object.defineProperty(t,"__esModule",{value:!0});var i=o("../../.yarn/cache/@optimizely-js-sdk-logging-npm-0.1.0-43f6c5e030-b1d2de26cf.zip/node_modules/@optimizely/js-sdk-logging/lib/index.js"),s=o("../../.yarn/cache/@optimizely-js-sdk-event-processor-npm-0.4.0-a83376e778-6838febe08.zip/node_modules/@optimizely/js-sdk-event-processor/lib/pendingEventsStore.js"),a=o("../../.yarn/cache/@optimizely-js-sdk-utils-npm-0.2.0-6e592e4113-c935bbfbc7.zip/node_modules/@optimizely/js-sdk-utils/lib/index.js"),c=i.getLogger("EventProcessor"),l=function(){function PendingEventsDispatcher(e){var t=e.eventDispatcher,o=e.store;this.dispatcher=t,this.store=o}return PendingEventsDispatcher.prototype.dispatchEvent=function(e,t){this.send({uuid:a.generateUUID(),timestamp:a.getTimestamp(),request:e},t)},PendingEventsDispatcher.prototype.sendPendingEvents=function(){var e=this,t=this.store.values();c.debug("Sending %s pending events from previous page",t.length),t.forEach((function(t){try{e.send(t,(function(){}))}catch(e){}}))},PendingEventsDispatcher.prototype.send=function(e,t){var o=this;this.store.set(e.uuid,e),this.dispatcher.dispatchEvent(e.request,(function(n){o.store.remove(e.uuid),t(n)}))},PendingEventsDispatcher}();t.PendingEventsDispatcher=l;var u=function(e){function LocalStoragePendingEventsDispatcher(t){var o=t.eventDispatcher;return e.call(this,{eventDispatcher:o,store:new s.LocalStorageStore({maxValues:100,key:"fs_optly_pending_events"})})||this}return r(LocalStoragePendingEventsDispatcher,e),LocalStoragePendingEventsDispatcher}(l);t.LocalStoragePendingEventsDispatcher=u},"../../.yarn/cache/@optimizely-js-sdk-event-processor-npm-0.4.0-a83376e778-6838febe08.zip/node_modules/@optimizely/js-sdk-event-processor/lib/pendingEventsStore.js":function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o("../../.yarn/cache/@optimizely-js-sdk-utils-npm-0.2.0-6e592e4113-c935bbfbc7.zip/node_modules/@optimizely/js-sdk-utils/lib/index.js"),r=o("../../.yarn/cache/@optimizely-js-sdk-logging-npm-0.1.0-43f6c5e030-b1d2de26cf.zip/node_modules/@optimizely/js-sdk-logging/lib/index.js").getLogger("EventProcessor"),i=function(){function LocalStorageStore(e){var t=e.key,o=e.maxValues,n=void 0===o?1e3:o;this.LS_KEY=t,this.maxValues=n}return LocalStorageStore.prototype.get=function(e){return this.getMap()[e]||null},LocalStorageStore.prototype.set=function(e,t){var o=this.getMap();o[e]=t,this.replace(o)},LocalStorageStore.prototype.remove=function(e){var t=this.getMap();delete t[e],this.replace(t)},LocalStorageStore.prototype.values=function(){return n.objectValues(this.getMap())},LocalStorageStore.prototype.clear=function(){this.replace({})},LocalStorageStore.prototype.replace=function(e){try{window.localStorage&&localStorage.setItem(this.LS_KEY,JSON.stringify(e)),this.clean()}catch(e){r.error(e)}},LocalStorageStore.prototype.clean=function(){var e=this.getMap(),t=Object.keys(e),o=t.length-this.maxValues;if(!(o<1)){var n=t.map((function(t){return{key:t,value:e[t]}}));n.sort((function(e,t){return e.value.timestamp-t.value.timestamp}));for(var r=0;r<o;r++)delete e[n[r].key];this.replace(e)}},LocalStorageStore.prototype.getMap=function(){try{var e=window.localStorage&&localStorage.getItem(this.LS_KEY);if(e)return JSON.parse(e)||{}}catch(e){r.error(e)}return{}},LocalStorageStore}();t.LocalStorageStore=i},"../../.yarn/cache/@optimizely-js-sdk-event-processor-npm-0.4.0-a83376e778-6838febe08.zip/node_modules/@optimizely/js-sdk-event-processor/lib/requestTracker.js":function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function RequestTracker(){this.reqsInFlightCount=0,this.reqsCompleteResolvers=[]}return RequestTracker.prototype.trackRequest=function(e){var t=this;this.reqsInFlightCount++;var onReqComplete=function(){t.reqsInFlightCount--,0===t.reqsInFlightCount&&(t.reqsCompleteResolvers.forEach((function(e){return e()})),t.reqsCompleteResolvers=[])};e.then(onReqComplete,onReqComplete)},RequestTracker.prototype.onRequestsComplete=function(){var e=this;return new Promise((function(t){0===e.reqsInFlightCount?t():e.reqsCompleteResolvers.push(t)}))},RequestTracker}();t.default=n},"../../.yarn/cache/@optimizely-js-sdk-event-processor-npm-0.4.0-a83376e778-6838febe08.zip/node_modules/@optimizely/js-sdk-event-processor/lib/v1/buildEventV1.js":function(e,t,o){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});function makeConversionSnapshot(e){var t=n({},e.tags);delete t.revenue,delete t.value;var o={entity_id:e.event.id,key:e.event.key,timestamp:e.timestamp,uuid:e.uuid};return e.tags&&(o.tags=e.tags),null!=e.value&&(o.value=e.value),null!=e.revenue&&(o.revenue=e.revenue),{events:[o]}}function makeDecisionSnapshot(e){var t=e.layer,o=e.experiment,n=e.variation,r=t?t.id:null;return{decisions:[{campaign_id:r,experiment_id:o?o.id:null,variation_id:n?n.id:null}],events:[{entity_id:r,timestamp:e.timestamp,key:"campaign_activated",uuid:e.uuid}]}}function makeVisitor(e){var t={snapshots:[],visitor_id:e.user.id,attributes:[]};return e.user.attributes.forEach((function(e){t.attributes.push({entity_id:e.entityId,key:e.key,type:"custom",value:e.value})})),"boolean"==typeof e.context.botFiltering&&t.attributes.push({entity_id:"$opt_bot_filtering",key:"$opt_bot_filtering",type:"custom",value:e.context.botFiltering}),t}t.makeBatchedEventV1=function makeBatchedEventV1(e){var t=[],o=e[0];return e.forEach((function(e){if("conversion"===e.type||"impression"===e.type){var o=makeVisitor(e);"impression"===e.type?o.snapshots.push(makeDecisionSnapshot(e)):"conversion"===e.type&&o.snapshots.push(makeConversionSnapshot(e)),t.push(o)}})),{client_name:o.context.clientName,client_version:o.context.clientVersion,account_id:o.context.accountId,project_id:o.context.projectId,revision:o.context.revision,anonymize_ip:o.context.anonymizeIP,enrich_decisions:!0,visitors:t}},t.buildImpressionEventV1=function buildImpressionEventV1(e){var t=makeVisitor(e);return t.snapshots.push(makeDecisionSnapshot(e)),{client_name:e.context.clientName,client_version:e.context.clientVersion,account_id:e.context.accountId,project_id:e.context.projectId,revision:e.context.revision,anonymize_ip:e.context.anonymizeIP,enrich_decisions:!0,visitors:[t]}},t.buildConversionEventV1=function buildConversionEventV1(e){var t=makeVisitor(e);return t.snapshots.push(makeConversionSnapshot(e)),{client_name:e.context.clientName,client_version:e.context.clientVersion,account_id:e.context.accountId,project_id:e.context.projectId,revision:e.context.revision,anonymize_ip:e.context.anonymizeIP,enrich_decisions:!0,visitors:[t]}}},"../../.yarn/cache/@optimizely-js-sdk-event-processor-npm-0.4.0-a83376e778-6838febe08.zip/node_modules/@optimizely/js-sdk-event-processor/lib/v1/v1EventProcessor.js":function(e,t,o){"use strict";var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function __(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)});Object.defineProperty(t,"__esModule",{value:!0});var i=o("../../.yarn/cache/@optimizely-js-sdk-event-processor-npm-0.4.0-a83376e778-6838febe08.zip/node_modules/@optimizely/js-sdk-event-processor/lib/eventProcessor.js"),s=o("../../.yarn/cache/@optimizely-js-sdk-event-processor-npm-0.4.0-a83376e778-6838febe08.zip/node_modules/@optimizely/js-sdk-event-processor/lib/v1/buildEventV1.js"),a=function(e){function LogTierV1EventProcessor(){return null!==e&&e.apply(this,arguments)||this}return r(LogTierV1EventProcessor,e),LogTierV1EventProcessor.prototype.formatEvents=function(e){return{url:"https://logx.optimizely.com/v1/events",httpVerb:"POST",params:s.makeBatchedEventV1(e)}},LogTierV1EventProcessor}(i.AbstractEventProcessor);t.LogTierV1EventProcessor=a},"../../.yarn/cache/@optimizely-js-sdk-logging-npm-0.1.0-43f6c5e030-b1d2de26cf.zip/node_modules/@optimizely/js-sdk-logging/lib/errorHandler.js":function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function NoopErrorHandler(){}return NoopErrorHandler.prototype.handleError=function(e){},NoopErrorHandler}();t.NoopErrorHandler=n;var r=new n;t.setErrorHandler=function setErrorHandler(e){r=e},t.getErrorHandler=function getErrorHandler(){return r},t.resetErrorHandler=function resetErrorHandler(){r=new n}},"../../.yarn/cache/@optimizely-js-sdk-logging-npm-0.1.0-43f6c5e030-b1d2de26cf.zip/node_modules/@optimizely/js-sdk-logging/lib/index.js":function(e,t,o){"use strict";function __export(e){for(var o in e)t.hasOwnProperty(o)||(t[o]=e[o])}Object.defineProperty(t,"__esModule",{value:!0}),__export(o("../../.yarn/cache/@optimizely-js-sdk-logging-npm-0.1.0-43f6c5e030-b1d2de26cf.zip/node_modules/@optimizely/js-sdk-logging/lib/errorHandler.js")),__export(o("../../.yarn/cache/@optimizely-js-sdk-logging-npm-0.1.0-43f6c5e030-b1d2de26cf.zip/node_modules/@optimizely/js-sdk-logging/lib/models.js")),__export(o("../../.yarn/cache/@optimizely-js-sdk-logging-npm-0.1.0-43f6c5e030-b1d2de26cf.zip/node_modules/@optimizely/js-sdk-logging/lib/logger.js"))},"../../.yarn/cache/@optimizely-js-sdk-logging-npm-0.1.0-43f6c5e030-b1d2de26cf.zip/node_modules/@optimizely/js-sdk-logging/lib/logger.js":function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o("../../.yarn/cache/@optimizely-js-sdk-logging-npm-0.1.0-43f6c5e030-b1d2de26cf.zip/node_modules/@optimizely/js-sdk-logging/lib/errorHandler.js"),r=o("../../.yarn/cache/@optimizely-js-sdk-utils-npm-0.1.0-afdef27f46-f4ecb89ef0.zip/node_modules/@optimizely/js-sdk-utils/lib/index.js"),i=o("../../.yarn/cache/@optimizely-js-sdk-logging-npm-0.1.0-43f6c5e030-b1d2de26cf.zip/node_modules/@optimizely/js-sdk-logging/lib/models.js"),s={NOTSET:0,DEBUG:1,INFO:2,WARNING:3,ERROR:4};function coerceLogLevel(e){return"string"!=typeof e?e:("WARN"===(e=e.toUpperCase())&&(e="WARNING"),s[e]?s[e]:e)}var a=function(){function DefaultLogManager(){this.defaultLoggerFacade=new p,this.loggers={}}return DefaultLogManager.prototype.getLogger=function(e){return e?(this.loggers[e]||(this.loggers[e]=new p({messagePrefix:e})),this.loggers[e]):this.defaultLoggerFacade},DefaultLogManager}(),c=function(){function ConsoleLogHandler(e){void 0===e&&(e={}),this.logLevel=i.LogLevel.NOTSET,void 0!==e.logLevel&&r.isValidEnum(i.LogLevel,e.logLevel)&&this.setLogLevel(e.logLevel),this.logToConsole=void 0===e.logToConsole||!!e.logToConsole,this.prefix=void 0!==e.prefix?e.prefix:"[OPTIMIZELY]"}return ConsoleLogHandler.prototype.log=function(e,t){if(this.shouldLog(e)&&this.logToConsole){var o=this.prefix+" - "+this.getLogLevelName(e)+" "+this.getTime()+" "+t;this.consoleLog(e,[o])}},ConsoleLogHandler.prototype.setLogLevel=function(e){e=coerceLogLevel(e),r.isValidEnum(i.LogLevel,e)&&void 0!==e?this.logLevel=e:this.logLevel=i.LogLevel.ERROR},ConsoleLogHandler.prototype.getTime=function(){return(new Date).toISOString()},ConsoleLogHandler.prototype.shouldLog=function(e){return e>=this.logLevel},ConsoleLogHandler.prototype.getLogLevelName=function(e){switch(e){case i.LogLevel.DEBUG:return"DEBUG";case i.LogLevel.INFO:return"INFO ";case i.LogLevel.WARNING:return"WARN ";case i.LogLevel.ERROR:return"ERROR";default:return"NOTSET"}},ConsoleLogHandler.prototype.consoleLog=function(e,t){switch(e){case i.LogLevel.DEBUG:console.log.apply(console,t);break;case i.LogLevel.INFO:console.info.apply(console,t);break;case i.LogLevel.WARNING:console.warn.apply(console,t);break;case i.LogLevel.ERROR:console.error.apply(console,t);break;default:console.log.apply(console,t)}},ConsoleLogHandler}();t.ConsoleLogHandler=c;var l=i.LogLevel.NOTSET,u=null,p=function(){function OptimizelyLogger(e){void 0===e&&(e={}),this.messagePrefix="",e.messagePrefix&&(this.messagePrefix=e.messagePrefix)}return OptimizelyLogger.prototype.log=function(e,t){this.internalLog(coerceLogLevel(e),{message:t,splat:[]})},OptimizelyLogger.prototype.info=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];this.namedLog(i.LogLevel.INFO,e,t)},OptimizelyLogger.prototype.debug=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];this.namedLog(i.LogLevel.DEBUG,e,t)},OptimizelyLogger.prototype.warn=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];this.namedLog(i.LogLevel.WARNING,e,t)},OptimizelyLogger.prototype.error=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];this.namedLog(i.LogLevel.ERROR,e,t)},OptimizelyLogger.prototype.format=function(e){return(this.messagePrefix?this.messagePrefix+": ":"")+r.sprintf.apply(void 0,[e.message].concat(e.splat))},OptimizelyLogger.prototype.internalLog=function(e,t){u&&(e<l||(u.log(e,this.format(t)),t.error&&t.error instanceof Error&&n.getErrorHandler().handleError(t.error)))},OptimizelyLogger.prototype.namedLog=function(e,t,o){var n;if(t instanceof Error)return t=(n=t).message,void this.internalLog(e,{error:n,message:t,splat:o});if(0!==o.length){var r=o[o.length-1];r instanceof Error&&(n=r,o.splice(-1)),this.internalLog(e,{message:t,error:n,splat:o})}else this.internalLog(e,{message:t,splat:o})},OptimizelyLogger}(),g=new a;t.getLogger=function getLogger(e){return g.getLogger(e)},t.setLogHandler=function setLogHandler(e){u=e},t.setLogLevel=function setLogLevel(e){e=coerceLogLevel(e),l=r.isValidEnum(i.LogLevel,e)&&void 0!==e?e:i.LogLevel.ERROR},t.getLogLevel=function getLogLevel(){return l},t.resetLogger=function resetLogger(){g=new a,l=i.LogLevel.NOTSET}},"../../.yarn/cache/@optimizely-js-sdk-logging-npm-0.1.0-43f6c5e030-b1d2de26cf.zip/node_modules/@optimizely/js-sdk-logging/lib/models.js":function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.NOTSET=0]="NOTSET",e[e.DEBUG=1]="DEBUG",e[e.INFO=2]="INFO",e[e.WARNING=3]="WARNING",e[e.ERROR=4]="ERROR"}(t.LogLevel||(t.LogLevel={}))},"../../.yarn/cache/@optimizely-js-sdk-utils-npm-0.1.0-afdef27f46-f4ecb89ef0.zip/node_modules/@optimizely/js-sdk-utils/lib/index.js":function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o("../../.yarn/cache/uuid-npm-3.4.0-4fd8ef88ad-58de2feed6.zip/node_modules/uuid/index.js");function objectValues(e){return Object.keys(e).map((function(t){return e[t]}))}t.getTimestamp=function getTimestamp(){return(new Date).getTime()},t.generateUUID=function generateUUID(){return n.v4()},t.isValidEnum=function isValidEnum(e,t){for(var o=!1,n=Object.keys(e),r=0;r<n.length;r++)if(t===e[n[r]]){o=!0;break}return o},t.groupBy=function groupBy(e,t){var o={};return e.forEach((function(e){var n=t(e);o[n]=o[n]||[],o[n].push(e)})),objectValues(o)},t.objectValues=objectValues,t.find=function find(e,t){for(var o,n=0,r=e;n<r.length;n++){var i=r[n];if(t(i)){o=i;break}}return o},t.keyBy=function keyBy(e,t){var o={};return e.forEach((function(e){var n=t(e);o[n]=e})),o},t.sprintf=function sprintf(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];var n=0;return e.replace(/%s/g,(function(){var e=t[n++],o=typeof e;return"function"===o?e():"string"===o?e:String(e)}))}},"../../.yarn/cache/@optimizely-js-sdk-utils-npm-0.2.0-6e592e4113-c935bbfbc7.zip/node_modules/@optimizely/js-sdk-utils/lib/index.js":function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o("../../.yarn/cache/uuid-npm-3.4.0-4fd8ef88ad-58de2feed6.zip/node_modules/uuid/index.js");function objectValues(e){return Object.keys(e).map((function(t){return e[t]}))}t.getTimestamp=function getTimestamp(){return(new Date).getTime()},t.generateUUID=function generateUUID(){return n.v4()},t.isValidEnum=function isValidEnum(e,t){for(var o=!1,n=Object.keys(e),r=0;r<n.length;r++)if(t===e[n[r]]){o=!0;break}return o},t.groupBy=function groupBy(e,t){var o={};return e.forEach((function(e){var n=t(e);o[n]=o[n]||[],o[n].push(e)})),objectValues(o)},t.objectValues=objectValues,t.objectEntries=function objectEntries(e){return Object.keys(e).map((function(t){return[t,e[t]]}))},t.find=function find(e,t){for(var o,n=0,r=e;n<r.length;n++){var i=r[n];if(t(i)){o=i;break}}return o},t.keyBy=function keyBy(e,t){var o={};return e.forEach((function(e){var n=t(e);o[n]=e})),o},t.sprintf=function sprintf(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];var n=0;return e.replace(/%s/g,(function(){var e=t[n++],o=typeof e;return"function"===o?e():"string"===o?e:String(e)}))},function(e){e.ACTIVATE="ACTIVATE:experiment, user_id,attributes, variation, event",e.DECISION="DECISION:type, userId, attributes, decisionInfo",e.LOG_EVENT="LOG_EVENT:logEvent",e.OPTIMIZELY_CONFIG_UPDATE="OPTIMIZELY_CONFIG_UPDATE",e.TRACK="TRACK:event_key, user_id, attributes, event_tags, event"}(t.NOTIFICATION_TYPES||(t.NOTIFICATION_TYPES={}))}}]);
//# sourceMappingURL=npm.optimizely~fddc558b.chunk.ab28ac.js.map